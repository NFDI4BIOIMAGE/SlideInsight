WhatIsOMERO_slide1.png: 'I3D:bio OMERO user training slides

  HOW TO USE THE SLIDE TEMPLATES

  • To use your institution‘s slide design and logo, adjust the slides of this presentation

  using the „slide master“

  Note that these slides are optimized for 16:9 screen presentation layout

  • Check the slides for yellow-marked text and insert the information according to
  your

  own institute‘s infrastructure.

  • Feel free to use this material for videos, teaching, guidelines, etc., at your
  institute

  • Please cite us (e.g., on page 1) when re-using this material or derivatives of
  it:

  Adaptedfrom: Schmidt C., Bortolomeazzi M., Boissonnet T., Fortmann-Grote C. et al.
  (2023). I3D:bio‘s OMERO training material: Re-usable, adjustable, multi-purpose
  slides for

  local user training. Zenodo.DOI: 10.5281/zenodo.8323588. Ifnot statedotherwise,
  thecontentof thismaterial (exceptforlogosand theslidedesign) ispublishedunderCreative

  Commons Attribution 4.0 license.

  • If not stated otherwise, the content of this material (except for logos) is published

  under a Creative Commons Attribution 4.0 license.

  • This work is funded by the Deutsche Forschungsgemeinschaft (DFG, German

  Research Foundation) – 462231789 (Information Infrastructure for BioImage Data,

  I3D:bio)'
WhatIsOMERO_slide2.png: 'Disclaimer

  • The following slides are intended for reuse after

  substituting yellow-marked text with the relevant Information Infrastructure

  forBioImageData

  information at your institute. https://www.i3dbio.de

  • Some content may not apply to the specific setup

  of the OMERO installation at your institute.

  The content reflects solely the authors’ opinions and

  does not speak on behalf of the original software, its

  FundedbytheDeutsche

  developers, or other cited community resources. Forschungsgemeinschaft

  (DFG, German Research

  Foundation), projectI3D:bio,

  grantnumber462231789

  Adaptedfrom: Schmidt C., Bortolomeazzi M., Boissonnet T., Fortmann-Grote C. et al.
  (2023). I3D:bio‘s OMERO training

  material: Re-usable, adjustable, multi-purpose slides for local user training. Zenodo.DOI:
  10.5281/zenodo.8323588

  Ifnot statedotherwise, thecontentof thismaterial (exceptforlogosand theslidedesign)
  ispublishedunderCreative

  Commons Attribution 4.0 license.'
WhatIsOMERO_slide3.png: 'Research Data Management for Bioimage Data

  at the ADD INSTITUTE HERE

  What is the image data

  management platform OMERO?

  ADD AUTHOR / RESPONSIBLE PERSON FROM YOUR INSTITUE

  Information Infrastructure

  forBioImageData

  Adaptedfrom: Schmidt C., Bortolomeazzi M., Boissonnet T., Fortmann-Grote C. et al.
  (2023). I3D:bio‘s OMERO training ADD LOGO

  material: Re-usable, adjustable, multi-purpose slides for local user training. Zenodo.DOI:
  10.5281/zenodo.8323588

  Ifnot statedotherwise, thecontentof thismaterial (exceptforlogosand theslidedesign)
  ispublishedundera Creative BIG

  Commons Attribution 4.0 license.'
WhatIsOMERO_slide4.png: 'OMERO: An open-source software for image data management

  OMERO = „OME Remote Objects“

  Created by the Open Microscopy Environment Consortium (OME)

  • User computer

  • Microscope computer

  • Processing / analysis server

  • Installed on an institute or central IT server

  • Storage and handling of imaging data

  • Accessible from outside via „clients“

  p 4 ADD LOGO SMALL

  Adaptedfromhttps://docs.openmicroscopy.org/omero/5.6.3/users/index.html'
WhatIsOMERO_slide5.png: 'From isolated data silos…

  p 5 ADD LOGO SMALL'
WhatIsOMERO_slide6.png: '… to centralized, structured data management

  p 6 ADD LOGO SMALL'
WhatIsOMERO_slide7.png: 'OMERO at the ADD INSTITUTE HERE

  Service provided for researchers centrally by the IT DEPARTMENT / CORE FACILITY

  Get your account & log in with your user credentials (USER CREDENTIAL TYPE)

  web access: WEB-ADDRESS OF OMERO

  WEB

  Use OMERO

  Enter your user name

  & password

  • for yourself

  • with your group

  • with collaboration partners

  • from the intranet or via a

  virtual private network (VPN)

  p 7 ADD LOGO SMALL'
WhatIsOMERO_slide8.png: 'Advantages of using OMERO

  • Organize your original image files in a central storage location

  • Unique IDs for images; data can be linked via IDs

  • View your images, add annotations, tags, and comments to your images

  • View & explore images, and adjust, save and share visualization settings

  • Create publication-ready figures connected to original image files

  • Export image data to different formats

  • Analyze image data

  • Built-in analysis functions

  • Connect to popular image analysis software like Fiji or QuPath

  • Share your data with colleagues

  • and more…

  p 8 ADD LOGO SMALL'
WhatIsOMERO_slide9.png: 'Contact

  Please review the additional information material available on the website:

  ADD YOUR WEBSITE HERE

  Contact:

  • PERSON@YOURINSTITUTE.de (OMERO administrator)

  • PERSON@YOURINSTITUTE.de (Light Microscopy Core Facility)

  p 9 ADD LOGO SMALL'
downloads/12623730_02_Introduction_RDM_2024_slide1.png: 'CENTER FOR SCALABLE DATA
  ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Research Data Management

  Robert Haase

  Robert Haase

  @haesleinhuepf

  1

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide2.png: 'Recap quiz

  • We write good documentation to enabling others to

  do an experiment. This is good for …

  Repeatability Reproducibility Replicability Reliability

  Robert Haase

  @haesleinhuepf

  2

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide3.png: 'Recap quiz

  • “Resolution” in microscopy imaging describes

  Size of

  Camera Screen Objective

  differentiable

  pixel size pixel size magnification

  objects

  Robert Haase

  @haesleinhuepf

  3

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide4.png: 'Research Data Management
  (RDM)

  • All activities, processes, terms,

  persons which have relationships

  with data

  • Processing

  • Storage

  • Organisation

  • Publication

  • …

  • In routine: working with data

  Robert Haase

  @haesleinhuepf

  4

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide5.png: 'RDM Life Cycle

  Plan

  • Processes are

  ideally cyclic

  Reuse Acquire

  Process /

  Archive

  analyse

  Publish

  Robert Haase Adaptiert von:

  @haesleinhuepf

  https://forschungsdaten.info/themen/informieren-und- 5

  BIDS Lecture2/14

  April 9th 2024 planen/datenlebenszyklus/'
downloads/12623730_02_Introduction_RDM_2024_slide6.png: 'RDM Life Cycle

  Plan

  • Cost

  • Benefit

  Reuse Acquire

  • Quality

  • Strategic

  Process /

  decisions Archive

  analyse

  Publish

  Robert Haase Adaptiert von:

  @haesleinhuepf

  https://forschungsdaten.info/themen/informieren-und- 6

  BIDS Lecture2/14

  April 9th 2024 planen/datenlebenszyklus/'
downloads/12623730_02_Introduction_RDM_2024_slide7.png: 'RDM Life Cycle

  Plan

  • Types of data

  • Terms and conditions

  Reuse Acquire

  • Usage rights

  • Copyright

  • IT infrastructure

  Process /

  Archive

  analyse

  • Backup

  Publish

  Robert Haase Adaptiert von:

  @haesleinhuepf

  https://forschungsdaten.info/themen/informieren-und- 7

  BIDS Lecture2/14

  April 9th 2024 planen/datenlebenszyklus/'
downloads/12623730_02_Introduction_RDM_2024_slide8.png: 'Types of data

  • Structured data

  • Tables, databases

  • Unstructured data

  • Texte, emails, videos, pictures

  • Semi-structured data

  • Frageboegen

  • Scientific images

  Robert Haase

  @haesleinhuepf

  8

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide9.png: 'Types of data

  • Openly accessible data

  • „open data“

  • „open source“ software

  • Business data

  • Research data

  • Hot / cold

  • Personal data

  • Secret data

  In need of

  protection

  (schutzbedürftig)

  Robert Haase

  @haesleinhuepf

  9

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide10.png: 'RDM Life Cycle

  Plan

  • Right to publish

  • Regulatory aspects

  Reuse Acquire

  • Research data: archive

  15 years

  • Authorship

  • Registration (-> Findable)

  Process /

  Archive

  analyse

  Publish Delete

  Robert Haase Adaptiert von:

  @haesleinhuepf

  https://forschungsdaten.info/themen/informieren-und- 10

  BIDS Lecture2/14

  April 9th 2024 planen/datenlebenszyklus/'
downloads/12623730_02_Introduction_RDM_2024_slide11.png: 'RDM Life Cycle

  Plan

  • Potential future benefit

  • Sustainability

  Reuse Acquire

  • Important: Licensing

  • Has impact on next

  cycle / acquisition

  Process /

  Archive

  analyse

  Publish

  Robert Haase Adaptiert von:

  @haesleinhuepf

  https://forschungsdaten.info/themen/informieren-und- 11

  BIDS Lecture2/14

  April 9th 2024 planen/datenlebenszyklus/'
downloads/12623730_02_Introduction_RDM_2024_slide12.png: 'What is good RDM?

  • Clearly defined responsibilities and

  processes (Governance)

  • Data Management Plan (DMP)

  • Communication of goals, metrics,

  Institution

  responsibilities, processes

  • Dedicated personnel

  • “Data maintainers” Data maintainers Data Stewards

  • IT infrastructure maintainers Department A

  • Expert consultants Data maintainers

  • “Data stewards” Department B

  Robert Haase

  @haesleinhuepf

  12

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide13.png: 'Roles != Job profiles

  Domain specialist Data analyst IT specialist

  • Focuses on scientific • Focuses on methods for • Focuses on IT

  question, often related data processing / infrastructure

  to the physical world visualization

  • Hardware

  • Requires sound insights • Gains sound insights • Software

  and sustainable

  • Examples: • Builds sustainable

  solutions

  solutions

  • Statistician

  • Examples:

  • Bioinformatician • Examples:

  • Biologist

  • Data Scientist • Computer scientist

  • Geologist

  • IT specialist

  • City planner

  Robert Haase

  @haesleinhuepf

  13

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide14.png: 'Data Management Plans (DMPs)

  • Describes the IS-state of a data environment

  • Which data is acquired / processed?

  (content, format, amount)

  • What meta-data is collected?

  • Which quality standards are targeted?

  • How is data saved, archived, backed-up, shared, published…?

  • Who is responsible for what?

  • Roles, job-profiles

  • What does this all cost?

  (IT infrastructure + human resources)

  Robert Haase

  @haesleinhuepf

  14

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide15.png: 'Data Management Plans (DMPs)

  • Define responsibilities and procedures early!

  Imaging / data

  Open Science Experiment design Data Analysis Paper writing

  acquisiton

  “Data / materials •Only if procedures are defined early, Are we going to

  we produce will publish data /

  everyone can follow them.

  be published •Licenses are important when assembling materials / code?

  under CC-BY 4.0”

  materials (-> Copyright)

  What license can we

  •Meta-data might have higher quality if the

  “Robert will do this

  use?

  person responsible for publishing the data is

  by end of 2025!”

  aware of their duties.

  Deciding by the end of

  the project is too late!

  DMP

  Robert Haase

  @haesleinhuepf

  15

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide16.png: 'Quiz

  • Regularly copying files to a remote place is …

  Archiving Backup

  Robert Haase

  @haesleinhuepf

  16

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide17.png: 'Quiz

  • Data Scientists is a …

  Role Job profile

  Robert Haase

  @haesleinhuepf

  17

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide18.png: 'Quiz

  • Data Steward is a …

  Role Job profile

  Robert Haase

  @haesleinhuepf

  18

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide19.png: 'CENTER FOR SCALABLE DATA
  ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Slides

  Code

  Text

  Sharing & licensing

  Robert Haase

  …

  Data

  Robert Haase

  @haesleinhuepf

  19

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide20.png: '20

  Sustainability of my contribution to science

  • What happens to research software once the PhD student leaves

  the institute / field?

  (n=1)

  PhD student

  finishes and

  leaves the

  institute

  Robert Haase

  @haesleinhuepf

  20

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide21.png: '21

  Developing software in the open

  2019 2020 2021

  Nov. 2017: I took over

  microscopy control

  software from Loic and

  “found” some GPU-

  accelerated image

  processing in there

  Today: 134 citations

  (Google scholar, 2024-03-18)

  Loic A. Royer

  (CZ Biohub)

  @loicaroyer

  https://github.com/clij/clij/graphs/contributorshttps://forum.image.sc/t/opencl-

  Robert Haase

  @haesleinhuepf gpu-based-image-processing-in-imagej-macro/21286

  21

  BIDS Lecture2/14 https://www.biorxiv.org/content/10.1101/660704v1?versioned=true

  April 9th 2024

  https://www.nature.com/articles/s41592-019-0650-1'
downloads/12623730_02_Introduction_RDM_2024_slide22.png: 'Scientific culture

  Public access to research results -> Reusability

  “Kodex”

  Robert Haase

  https://www.dfg.de/resource/blob/174052/1a235cb1

  @haesleinhuepf

  22

  BIDS Lecture2/14 38c77e353789263b8730b1df/kodex-gwp-en-data.pdf

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide23.png: 'Am I allowed to publish
  my stuff?

  • … it depends… on who is responsible

  Do the

  work!

  The work /

  World

  product

  Copyright holder, Author Publisher Licensee

  e.g. employer Creator of the work The person who made The person who uses

  of the author the work available / reuses the material

  Robert Haase

  @haesleinhuepf

  24

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide24.png: 'Am I allowed to publish
  my stuff?

  • … it depends… on what materials served as basis

  ?

  Publish

  Document with

  unclear copyright

  Author of related

  material

  Licensee / author of

  derived material

  Robert Haase

  @haesleinhuepf

  25

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide25.png: 'Am I allowed to publish
  my stuff?

  • … it depends… on what materials served as basis

  Publish

  Document with

  World

  defined copyright

  Author of related

  material

  Licensee / author of

  derived material

  Licensee / author

  of derived material

  Robert Haase

  @haesleinhuepf

  26

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide26.png: '27

  Openness of software / projects

  Benevolent

  Closed source Open source Community driven Openly extensible

  dictatorship

  8

  x=1/y

  x=1/y

  z=y+1

  x=1/y

  z=y+1

  x=1/y

  z=y+1 z=y+1

  • Open to collaborations • Code available to read • Open to contributions • Open
  to contributions • Openly extensible;

  • “Black box” • Not necessarily executable • Single maintainer, often • Partially
  democratic without maintainers

  • Compiled code (e.g. C/C++) code overwhelmed • Board of maintainers (core involved

  • Good for protecting • No maintenance / support • Efficient decision making developers)
  • Partially community

  intellectual properties ($$$) efforts • Bus factor ≈1 • Long-winded decision making
  driven

  Custom image analysis TrackMate, SNT, ImageJ, Python,

  Hardware device drivers scikit-image, scipy, OpenCL

  scripts MorpholibJ, CLIJ numpy

  Robert Haase

  @haesleinhuepf

  Read more: https://coiled.io/blog/stages-of-openness/ 27

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide27.png: 'Quiz

  • What is the role of Github in the context of

  publishing open-source code?

  Copyright holder Author Publisher Licensee

  Robert Haase

  @haesleinhuepf

  28

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide28.png: 'Standard for sharing: The
  FAIR-principles

  • Findable

  • Accessible

  • Interoperable

  • Reusable

  Robert Haase

  @haesleinhuepf

  29

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide29.png: 'The FAIR-principles

  • Findable

  • F1. (Meta)data are assigned a globally unique

  and persistent identifier

  • Universal Resource Identifier (URI)

  • Digital Object Identifier (DOI)

  • F2. Data are described with rich metadata

  (defined by R1 below)

  • F3. Metadata clearly and explicitly include the

  identifier of the data they describe

  • F4. (Meta)data are registered or indexed in a

  searchable resource

  Robert Haase

  Screenshot source: https://www.doi.org/the-identifier/what-is-a-doi/ licensed CC-BY
  4.0

  @haesleinhuepf

  https://www.go-fair.org/fair-principles/ 30

  BIDS Lecture2/14

  https://biii.eu/introduction-3d-analysis-3d-imagej-suite

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide30.png: 'Meta data

  • Generic • Field-specific (microscopy)

  • Author • Exposure time

  • Usage license • Wavelength (colour)

  • Creation date • Microscope type/vendor

  Goals:

  FAIR+

  Reproducibility

  Robert Haase

  @haesleinhuepf

  31

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide31.png: 'REMBI: Recommended Metadata
  for Biological

  Images—enabling reuse of microscopy data in biology

  • Read more:

  Robert Haase

  @haesleinhuepf https://www.nature.com/articles/s41592-021-01166-8

  32

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide32.png: 'Digital Object Identifiers
  (DOI)

  • DOIs / URIs always

  point at the same

  data

  • DOIs are centrally

  registers, URIs not

  • Unified Resource

  Locators (URLs)

  may point at

  different things

  This no DOI, no

  URI, it’s a URL

  Robert Haase

  @haesleinhuepf https://opendata.leipzig.de/dataset/strassennetz-stadt-leipzig

  33

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide33.png: 'Indexing

  • Make sure your materials

  are listed in public search

  indices

  • Do not trust google to make

  your stuff findable

  Robert Haase https://biii.eu/ https://bio.tools/

  @haesleinhuepf

  https://microscopydb.io/#get-involved 36

  BIDS Lecture2/14

  April 9th 2024 https://nfdi4bioimage.github.io/training'
downloads/12623730_02_Introduction_RDM_2024_slide34.png: 'Incentives: Findability

  • Your future-self will thank you, because they will find your work

  You remember

  that talk you gave

  in 2021?

  Where are the

  slides?

  Online,

  open access!

  Robert Haase

  @haesleinhuepf

  https://f1000research.com/slides/10-519 37

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide35.png: 'Incentives: Findability
  -> Visibility

  • YouTube

  • Github

  Open & FAIR sharing

  … leading to

  is a PR instrument

  • more software users

  • new collaborations

  Robert Haase

  https://www.youtube.com/@scads-ai

  @haesleinhuepf

  38

  BIDS Lecture2/14 https://scads.github.io/prompt-engineering-tutorial-2023

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide36.png: 'The FAIR-principles

  • Accessible

  • A1. (Meta)data are retrievable by their

  identifier using a standardised

  communications protocol

  • A1.1 The protocol is open, free, and

  universally implementable

  • A1.2 The protocol allows for an

  authentication and authorisation

  procedure, where necessary

  • A2. Metadata are accessible, even when

  the data are no longer available

  https://www.go-fair.org/fair-principles/

  Robert Haase

  @haesleinhuepf

  Comic taken from https://xkcd.com/927/ licensed under 39

  BIDS Lecture2/14

  April 9th 2024 a Creative Commons Attribution-NonCommercial 2.5 License.'
downloads/12623730_02_Introduction_RDM_2024_slide37.png: 'Accessibility

  • The ability to download

  data, for humans and

  computers

  Essential for AI

  developers =-)

  Robert Haase

  https://www.ebi.ac.uk/bioimage-

  @haesleinhuepf

  40

  BIDS Lecture2/14

  archive/galleries/galleries.html

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide38.png: 'Accessibility

  • The ability to download

  data, for humans and

  computers

  Robert Haase

  https://www.ebi.ac.uk/bioimage-

  @haesleinhuepf

  41

  BIDS Lecture2/14 archive/galleries/S-BIAD634-ai.html

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide39.png: 'Restricted Access

  • The A in FAIR does not necessarily stand for Open Access

  Robert Haase

  @haesleinhuepf https://zenodo.org/records/10829230

  42

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide40.png: 'The FAIR-principles

  • Interoperable

  • I1. (Meta)data use a formal,

  accessible, shared, and broadly

  applicable language for

  knowledge representation.

  • I2. (Meta)data use vocabularies

  that follow FAIR principles

  • I3. (Meta)data include qualified

  references to other (meta)data

  Robert Haase

  @haesleinhuepf https://www.go-fair.org/fair-principles

  43

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide41.png: 'The FAIR-principles

  • Reusable

  • R1. (Meta)data are richly described

  with a plurality of accurate and

  relevant attributes

  • R1.1. (Meta)data are released with a

  clear and accessible data usage

  license

  • R1.2. (Meta)data are associated with

  detailed provenance

  • R1.3. (Meta)data meet domain-

  relevant community standards

  Robert Haase https://www.go-fair.org/fair-principles/

  @haesleinhuepf

  Drawing made by Henning Falk, ©2022 NumFOCUS, 44

  BIDS Lecture2/14

  April 9th 2024 reused under a CC BY 4.0 license'
downloads/12623730_02_Introduction_RDM_2024_slide42.png: '45

  Incentives: Reusability

  • Open Access -> Others teach how to use your tools & methods

  Robert Haase

  https://f1000research.com/slides/10-201

  @haesleinhuepf

  45

  BIDS Lecture2/14

  https://f1000research.com/slides/11-1175

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide43.png: 'Where to share?

  • Open science related content

  • bioRxiv (manuscripts, no reviews)

  • Figshare

  • F1000

  • Bioimage Archive (data)

  • Github (code)

  • Zenodo

  • Focalplane

  • Institutional servers

  (if there is no alternative)

  Robert Haase https://www.biorxiv.org/content/10.1101/236463v5.article-info

  @haesleinhuepf https://github.com/HenriquesLab/ZeroCostDL4Mic https://focalplane.biologists.com/2020/07/01/lessons-

  46

  BIDS Lecture2/14 learned-from-an-open-hardware-project-in-microscopy-the-mesospim-initiative-2/

  April 9th 2024 https://zenodo.org/records/5978940'
downloads/12623730_02_Introduction_RDM_2024_slide44.png: 'Quiz

  • Where might open source code be most visible?

  Git server of the Group / institute /

  Zenodo.org Github.com

  university personal website

  Robert Haase

  @haesleinhuepf

  47

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide45.png: 'A short excursion…

  • Published 2 weeks ago:

  Claim to

  outperform current

  state of the art.

  “The T1 algorithms achieved a median F1 score of 89.7% (IQR

  36.7–82.4%), surpassing the KIT-GE, Cellpose-pretrain, Cellpose-

  scratch, Omnipose-pretrain and Omnipose-scratch by 49.9%,

  24.4%, 35.4%, 58.9% and 48.7%, respectively.”

  Ma, J., Xie, R., Ayyadhury, S. et al. The multimodality cell

  Robert Haase

  @haesleinhuepf

  segmentation challenge: toward universal solutions. Nat 48

  BIDS Lecture2/14

  April 9th 2024 Methods (2024). https://doi.org/10.1038/s41592-024-02233-6'
downloads/12623730_02_Introduction_RDM_2024_slide46.png: 'A short excursion…

  • “However my initial testing of the winning entry mediar 8 reveals

  errors (which are typical without tuning) when applied to recent data

  posted here 6 for which cellpose produced a (subjectively) good

  result.”

  Robert Haase Brian Northan et al.

  @haesleinhuepf

  https://forum.image.sc/t/thoughts-on-the-latest-sota- 49

  BIDS Lecture2/14

  April 9th 2024 segmentation-algorithms/94106'
downloads/12623730_02_Introduction_RDM_2024_slide47.png: 'A short excursion…

  • Published on Sunday:

  (by the CellPose authors)

  • “In fact, Mediar directly

  copied our codebase for

  implementing the

  Cellpose framework

  without modification”

  Stringer & Pachitariu, bioRxiv, 2024

  Robert Haase

  @haesleinhuepf

  https://www.biorxiv.org/content/10.11 50

  BIDS Lecture2/14

  April 9th 2024 01/2024.04.06.587952v1'
downloads/12623730_02_Introduction_RDM_2024_slide48.png: 'A short excursion…

  • Professional discussion about Copyright:

  Robert Haase

  @haesleinhuepf

  https://github.com/Lee-Gihun/MEDIAR/issues/17 51

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide49.png: '52

  Licensing: Creative Commons (CC)

  • Public domain (CC0)

  • Attribution International (CC-BY)

  • Attribution ShareAlike Int. (CC-BY-SA)

  • Attribution Non-Commercial Int. (CC-BY-NC)

  • Attribution NoDerivatives Int. (CC-BY-ND)

  + Combinations, e.g. CC-BY-NC-ND

  Content on this site is licensed under aCreative Commons Attribution 4.0 International
  license.Iconsby The Noun Project.

  Robert Haase

  @haesleinhuhettppsf://creativecommons.org/share-your-work/

  52

  https://creativecommons.org/about/cclicenses/

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide50.png: '53

  Licensing: Creative Commons (CC)

  • Public domain (CC0)

  • Everyone can reuse without mentioning the Employers don’t like this

  one because you give

  source or author of the shared resource.

  away the rights to exploit

  • Public domain licenses cannot be revoked.

  you work.

  • The author must own the right to copy

  (copyright) the resource.

  • If you authored work as part of your job,

  you may not be the copyright holder. (check

  your employers'' guidelines)

  Content on this slide was adapted from https://creativecommons.org/about/cclicenses/
  which is licensed under aCreative Commons Attribution 4.0 International license.Iconsby
  The Noun Project.

  Robert Haase

  @haesleinhuhettppsf://creativecommons.org/share-your-work/

  53

  https://creativecommons.org/about/cclicenses/

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide51.png: '54

  Licensing: Creative Commons (CC)

  “By attribution”

  Content on this slide was adated from https://creativecommons.org/about/cclicenses/
  which is licensed under aCreative Commons Attribution 4.0 International license.Iconsby
  The Noun Project.

  Robert Haase

  @haesleinhuhettppsf://creativecommons.org/share-your-work/

  54

  https://creativecommons.org/about/cclicenses/

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide52.png: '55

  Licensing: Creative Commons (CC)

  Example

  You must put such a Figure adapted from https://www.openmicroscopy.org/ licensed
  by University of Dundee &

  Open Microscopy Environment under Creative Commons Attribution 4.0 International
  License

  sentence and keep the

  link to CC-BY

  Robert Haase

  @haesleinhuepf

  55

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide53.png: '56

  Licensing: Creative Commons (CC)

  “Share alike”

  “Restrictive”

  licensing

  Content on this slide was adapted from https://creativecommons.org/about/cclicenses/
  which is licensed under aCreative Commons Attribution 4.0 International license.Iconsby
  The Noun Project.

  Robert Haase

  @haesleinhuhettppsf://creativecommons.org/share-your-work/

  56

  https://creativecommons.org/about/cclicenses/

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide54.png: '57

  Licensing: Creative Commons (CC)

  “Restrictive”

  licensing

  Content on this slide was adapted from https://creativecommons.org/about/cclicenses/
  which is licensed under aCreative Commons Attribution 4.0 International license.Iconsby
  The Noun Project.

  Robert Haase

  @haesleinhuhettppsf://creativecommons.org/share-your-work/

  57

  https://creativecommons.org/about/cclicenses/

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide55.png: '58

  Licensing: Creative Commons (CC)

  “Restrictive”

  licensing

  Content on this slide was adapted from https://creativecommons.org/about/cclicenses/
  which is licensed under aCreative Commons Attribution 4.0 International license.Iconsby
  The Noun Project.

  Robert Haase

  @haesleinhuhettppsf://creativecommons.org/share-your-work/

  58

  https://creativecommons.org/about/cclicenses/

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide56.png: '59

  Licensing: Creative Commons (CC)

  “Restrictive”

  licensing

  Content on this slide was adapted from https://creativecommons.org/about/cclicenses/
  which is licensed under aCreative Commons Attribution 4.0 International license.Iconsby
  The Noun Project.

  Robert Haase

  @haesleinhuhettppsf://creativecommons.org/share-your-work/

  59

  https://creativecommons.org/about/cclicenses/

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide57.png: 'Quiz

  • May I use one of the

  Yes No

  Figures from this

  preprint?

  • May I download and Yes No

  redistribute this preprint

  to students of a course

  for free?

  Robert Haase

  @haesleinhuepf

  60

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide58.png: '61

  Licensing Software

  In the software world, other licenses

  are more popular, historically grown.

  BBSSDD

  GPGLPL

  Berkley

  Apache Software

  GNU General

  Distribution

  Public

  License

  LGPL

  MIT

  Robert Haase

  @haesleinhuepf

  https://choosealicense.com/ 61

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide59.png: '62

  Licensing Software: GPL

  GPL-derivatives must also

  be GPL-licensed

  “Restrictive”

  licensing

  Robert Haase

  @haehstltepsin:/h/wuwewp.fgnu.org/licenses/gpl-3.0.en.html

  62

  https://en.wikipedia.org/wiki/GNU_General_Public_License#Copyleft

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide60.png: 'Quiz

  Can I build a commercial

  Yes No

  product on the basis of GPL-

  licensed code?

  Do I have to release the code Yes No

  openly for this commercial

  product?

  Robert Haase

  @haesleinhuepf

  63

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide61.png: '64

  Licensing Software: BSD0

  Copyright (C) [year] by [copyright holder] <[email]>

  Similar to CC0

  Permission to use, copy, modify, and/or distribute this software for any purpose
  with

  or without fee is hereby granted. (public domain)

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL

  WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED

  WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE

  AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR

  CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING

  FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF

  CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF

  OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE

  Robert Haase

  @haesleinhuepf

  64

  https://en.wikipedia.org/wiki/BSD_licenses

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide62.png: '65

  Licensing Software: BSD0

  Copyright (C) [year] by [copyright holder] <[email]>

  Permission to use, copy, modify, and/or distribute this software for any purpose
  with

  or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL

  WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED

  Disclaimer

  WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE

  AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR

  CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING Whatever you do with

  FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF it, we [the authors]

  CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF

  are not liable

  OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE

  Robert Haase

  @haesleinhuepf

  65

  https://en.wikipedia.org/wiki/BSD_licenses

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide63.png: '66

  Licensing Software: BSD2

  Copyright (c) <year>, <copyright holder>

  Redistribution and use in source and binary forms, with or without modification,
  are permitted

  provided that the following conditions are met:

  1. Redistributions of source code must retain the above copyright notice, this list
  of conditions

  and the following disclaimer. Similar to

  2. Redistributions in binary form must reproduce the above copyright notice, this
  list of conditions

  CC-BY

  and the following disclaimer in the documentation and/or other materials provided
  with the

  distribution.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS

  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,

  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR

  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR

  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,

  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,

  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR

  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF

  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING

  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS

  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE

  Robert Haase

  @haesleinhuepf

  66

  https://en.wikipedia.org/wiki/BSD_licenses

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide64.png: '67

  Licensing Software: BSD3

  Copyright <year> <copyright holder>

  Redistribution and use in source and binary forms, with or without modification,
  are permitted provided

  that the following conditions are met:

  1. Redistributions of source code must retain the above copyright notice, this list
  of conditions and the

  following disclaimer. Similar to

  2. Redistributions in binary form must reproduce the above copyright notice, this
  list of conditions and

  CC-BY

  the following disclaimer in the documentation and/or other materials provided with
  the distribution.

  3. Neither the name of the copyright holder nor the names of its contributors may
  be used to endorse

  or promote products derived from this software without specific prior written permission.

  You must not use the

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"

  copyright holder’s name

  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE

  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE to endorse
  your

  ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE derivative
  of the work.

  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR

  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF

  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS

  INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN

  CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING

  IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY

  OF SUCH DAMAGE

  Robert Haase

  @haesleinhuepf

  67

  https://en.wikipedia.org/wiki/BSD_licenses

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide65.png: 'Licensing: Permissive versus

  restrictive

  • Restrictive

  • You can reuse our stuff, but only if you …

  • License your work with the same license we do

  • Make your stuff openly available

  I conclude,

  • Make no money with derivatives of our work

  these are

  • Examples: GPL, CC-BY-SA, CC-BY-NC, CC-BY-ND less open in

  a sense

  • Permissive licensing:

  • Do whatever you like with our stuff,

  just make sure to mention / cite us …

  • Examples: BSD, MIT, Apache, CC-BY

  Robert Haase

  @haesleinhuepf

  69

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide66.png: 'Quiz

  May I reuse code

  from this repository

  in my own BSD-

  licensed work?

  Yes No

  Robert Haase

  @haesleinhuepf

  70

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide67.png: 'Quiz

  May I reuse code

  from this repository

  in my own GPL-

  licensed work?

  Yes No

  Robert Haase

  @haesleinhuepf

  71

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide68.png: 'CENTER FOR SCALABLE DATA
  ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Software environments

  Robert Haase

  Robert Haase

  @haesleinhuepf

  72

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide69.png: 'git

  • Version control is key element of

  data scientist’s toolbox

  • Distributed file system with

  sophisticated logging

  mechanisms

  • Control about what becomes

  part of a repository and what

  not

  Robert Haase

  https://github.com/clEsperanto/pyclesperanto/

  @haesleinhuepf

  73

  BIDS Lecture2/14 graphs/contributors

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide70.png: 'git

  • Git makes file modifications a more active / involved process

  (making people think about)

  Download remote changes

  (first time: clone)

  fetch / pull

  Github

  My Folder

  repository

  push commit

  Stage

  Upload to the internet Enter changes in the history,

  add commit message

  Robert Haase

  @haesleinhuepf

  74

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide71.png: 'git

  • Who wrote

  this code

  • when and

  • why?

  Robert Haase

  https://github.com/haesleinhuepf/example_imag

  @haesleinhuepf

  75

  BIDS Lecture2/14 e_analysis_script/commits/main/

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide72.png: 'github – creating repositories

  • Add a new, empty repository

  Robert Haase

  https://focalplane.biologists.com/2021/09/04/colla

  @haesleinhuepf

  76

  BIDS Lecture2/14 borative-bio-image-analysis-script-editing-with-git/

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide73.png: 'github – clone repositories

  • git clone https://github.com/organization/repository

  • Or: Use the Github Desktop app

  Robert Haase

  https://desktop.github.com/

  @haesleinhuepf

  77

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide74.png: 'github - uploading

  • git [add], commit, push

  Robert Haase

  @haesleinhuepf

  78

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide75.png: 'github

  • Ease of reading

  notebooks online

  • No need to

  download and

  execute code

  Robert Haase

  @haesleinhuepf

  79

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide76.png: 'git - forking

  • Making a copy where we have edit rights

  Pull-request /

  merge

  repository repository

  fork fork

  repository

  fork fork fork

  (Robert’s)

  (Oliver’s) (Peter’s)

  Pull-request /

  merge

  Robert Haase

  @haesleinhuepf

  80

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide77.png: 'github - forking

  • Making a copy where we have edit rights

  Robert Haase

  @haesleinhuepf

  81

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide78.png: 'github – uploading (again)

  • After fixing a bug, we upload the changes to our fork

  Robert Haase

  @haesleinhuepf

  82

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide79.png: 'Github – pull requests

  • Contribute to open-source projects

  Robert Haase

  @haesleinhuepf

  83

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide80.png: 'Github – pull requests

  • Reviewer perspective

  Robert Haase

  @haesleinhuepf

  84

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide81.png: 'Github – pull requests

  • Reviewer perspective

  Problem

  solved :-)

  Robert Haase

  @haesleinhuepf

  85

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide82.png: 'Github

  • If this was too fast…

  Robert Haase

  https://focalplane.biologists.com/2021/09/04/colla

  @haesleinhuepf

  86

  BIDS Lecture2/14

  borative-bio-image-analysis-script-editing-with-git/

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide83.png: '87

  Quiz

  It’s ok to reuse this

  code if …

  Copy the

  Mention Ask the Link to the

  copyright

  author authors license

  statement

  Robert Haase

  @haesleinhuepf

  87

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide84.png: 'CENTER FOR SCALABLE DATA
  ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Exercises

  Robert Haase

  Robert Haase

  @haesleinhuepf

  88

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide85.png: 'Exercises

  Robert Haase

  @haesleinhuepfhttps://github.com/ScaDS/BIDS-lecture-2024

  89

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide86.png: 'Exercise (recap)

  • Make sure mamba is installed on your computer

  (see instructions from last week)

  Robert Haase

  @haesleinhuepf

  90

  BIDS Lecture2/14

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide87.png: 'Exercise (BioImage Archive)

  • Download a dataset from the BioImage Archive

  Robert Haase https://github.com/haesleinhuepf/BIDS-lecture-

  @haesleinhuepf

  91

  BIDS Lecture2/14 2024/tree/main/02a_remote_files

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide88.png: 'Exercise (nextcloud)

  • Register at Speicherwolke @ Uni Leipzig,

  • Upload the images from the BioImage Archive to a

  folder in the Speicherwolke.

  Robert Haase https://www.urz.uni-leipzig.de/unsere-services/servicedetail/service/eigener-

  @haesleinhuepf cloud-speicher-speicherwolkehttps://www.ebi.ac.uk/bioimage-

  92

  BIDS Lecture2/14 archive/galleries/S-BIAD634-ai.htmlhttps://speicherwolke.uni-leipzig.de/

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide89.png: 'Exercise (Zendo and DOI)

  • Explore the DOI and Zenodo APIs to find out the

  author of online records

  Robert Haase

  https://github.com/haesleinhuepf/BIDS-lecture-

  @haesleinhuepf

  93

  BIDS Lecture2/14 2024/tree/main/02b_meta_data

  April 9th 2024'
downloads/12623730_02_Introduction_RDM_2024_slide90.png: 'Exercise

  • Clone the training materials repository

  • Fix the typo on this page, send a pull-request

  Robert Haase

  https://github.com/haesleinhuepf/BIDS-lecture-

  @haesleinhuepf

  94

  BIDS Lecture2/14

  2024/blob/main/02c_pull_requests/readme.md

  April 9th 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide1.png: 'CENTER FOR SCALABLE DATA
  ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Bio-Image Data Science

  Robert Haase

  Robert Haase

  @haesleinhuepf

  1

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide2.png: 'Hello my name is…

  • Robert Haase

  • Applied image data scientist, research software engineer

  • Trained computer scientist (2010 Dipl-Inf(FH))

  with a medical PhD (2016 Dr. rer. medic.)

  • Worked 15 years on the biomedical research campus in

  Dresden-Johannstadt (Hospital, MPI-CBG, TU-Dresden)

  • Teaching bio-image analysis to life scientists 2019-2023

  @ TU Dresden

  • I maintain about 50 Python and Java packages other people

  Large parts of this

  use to analyze microscopy image data (GPU-acceleration,

  online lecture are

  machine learning, large language models)

  outdated!

  • New at Leipzig University

  Robert Haase

  https://www.youtube.com/watch?v=e-

  @haesleinhuepf

  2

  BIDS Lecture1/14 2DbkUwKk4&list=PL5ESQNfM5lc7SAMstEu082ivW4BDMvd0U

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide3.png: 'Survey

  Think about the FAIR principles for

  data sharing, which one is wrong?

  Findable Accessible

  Interoperable Reproducible

  Robert Haase

  @haesleinhuepf

  3

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide4.png: 'Survey

  Which open-source license might be

  the least popular in companies?

  GPL BSD

  MIT Apache

  Robert Haase

  @haesleinhuepf

  4

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide5.png: 'Survey

  Which topic is typically not covered in a

  Research Data Management Plan?

  Career

  Backup Publishing Acquisition

  development

  Robert Haase

  @haesleinhuepf

  6

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide6.png: 'Survey

  Which git command does not exist?

  fetch pull add submit

  Robert Haase

  @haesleinhuepf

  7

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide7.png: 'Survey

  You typically install Python packages using…

  (other /

  pip conda mamba

  not)

  Robert Haase

  @haesleinhuepf

  8

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide8.png: 'Survey

  Your favorite Python IDE is…

  (other /

  VS Code Jupyter Pycharm

  none)

  Robert Haase

  @haesleinhuepf

  9

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide9.png: 'Survey

  What does this Python code spit out?

  test = "ScaDS.AI"

  print(test[-3:])

  (Error

  .AI AI ScaDS

  message)

  Robert Haase

  @haesleinhuepf

  10

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide10.png: 'Survey

  Which is a background-removal filter?

  Laplace Gaussian Top-hat Sobel

  Robert Haase

  @haesleinhuepf

  15

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide11.png: 'Exercise: Survey

  How is this neural network

  architecture called?

  Auto- (Don’t

  U-Net Alex-Net

  encoder know)

  Robert Haase Source: Ronneberger et al.

  @haesleinhuepf

  16

  BIDS Lecture1/14 https://arxiv.org/pdf/1505.04597.pdf

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide12.png: 'Survey

  Which of the following is no language model?

  chatGPT claude mistral llama

  Robert Haase

  @haesleinhuepf

  17

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide13.png: 'Lecture overview

  • Every week will follow the same rough scheme

  • 15:15 : 90 min lecture

  • 17:15 : 90 min exercises (programming intense)

  • when you’re done, enjoy the sun!

  • Exam will cover the semester content accordingly

  • Bio-image Analysis / Microscopy

  • Machine/Deep Learning

  • Generative Artificial Intelligence

  • “closed book exam”

  Robert Haase https://dbs.uni-leipzig.de/files/2024-

  @haesleinhuepf

  02/Modulbeschreibung_BIDS_draft.pdf 18

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide14.png: 'Lecture materials

  Slides

  commonly

  available in

  advance

  Robert Haase

  @haesleinhuepf https://github.com/ScaDS/BIDS-lecture-2024

  19

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide15.png: 'Preliminary schedule

  • April 2nd 2024 – Introduction Microscopy & Bioimage Analysis

  • April 9th 2024 – Research Data Management

  • April 15th 2024 - Microscopy Image Processing

  • April 23rd 2024 – Segmentation of cells and nuclei

  • April 30th 2024 - Quality Assurance for image segmentation Handout exam pre-requisite

  complex exercise

  • May 7th 2024 – Feature extraction, data visualization

  • May 14th 2024 – Big data, parallel processing & distributed computing

  • May 21st 2024 – Introduction to Machine Learning for bio-image analysis

  s

  k

  • May 28th 2024 – Unsupervised Machine Learning Flexible; I would like e

  e

  w

  • June 4th 2024 – Deep Learning for image denoising + segmentation to focus as much
  as

  8

  possible on LLMs

  • June 11th 2024 – Generative Artificial Intelligence (LLMs)

  • June 18th 2024 – Image generation + vision models

  • June 25th 2024 – Quality assurance Submission deadline

  • July 2nd 2024 – Summary, exam preparation complex exercise

  Robert Haase

  @haesleinhuepf

  20

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide16.png: 'Lecture overview: Research
  Data Management

  • FAIR Principles

  Plan

  • Sharing / licensing

  • Open Source code Reuse Acquire

  • Data Management Plans

  • Big-Data Process /

  Archive

  analyse

  • Distributed computing

  Publish

  Robert Haase Source:

  @haesleinhuepf

  https://www.biorxiv.org/content/10.1101/2020.11.19.386565v1 21

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide17.png: 'Lecture overview: Bio-image
  Analysis

  • Image Data Analysis workflows

  • Goal: Quantify observations, substantiate conclusions with

  numbers Machine learning: Pixel Machine learning: Machine learning:

  classification, Instance Dimensionality Object

  segmentation reduction classification

  Plotting

  Image filtering Image segmentation Feature extraction Object classification

  Robert Haase

  @haesleinhuepf

  22

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide18.png: 'Lecture overview: Machine
  learning

  • Machine learning

  • in the context of bioimage analysis

  • Computers can learn from data, potentially revealing

  relationships that are not obvious to a human

  • Goal: Give you an insight into state-of-the-art methods

  Random forest classifiers

  Neural networks

  Robert Haase

  @haesleinhuepf

  23

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide19.png: 'Lecture Overview: Generative
  AI

  Multi-modal / Large Language Models

  Prompt:

  “Please segment

  the nuclei in the

  blue channel of

  the image”

  Robert Haase

  @haesleinhuepf

  24

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide20.png: 'Lecture Overview: Generative
  AI

  Multi-modal / Large Language Models

  After we learned how analyze images, we will teach an

  LLM to do it.

  How many There are 4 cells.

  cells are I just marked

  there? their nuclei.

  Robert Haase

  @haesleinhuepf

  25

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide21.png: 'CENTER FOR SCALABLE DATA
  ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Basics of Microscopy

  Robert Haase

  Robert Haase

  @haesleinhuepf

  26

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide22.png: 'Microscopy

  • Common tool to answer biological questions

  Transmitted light microscope Fluorescence microscope Electron microscope

  Robert Haase Sources: https://commons.wikimedia.org/wiki/File:Nikon_Optiphot_Phase_Contrast_Trinocular_Laboratory_Microscope_2_(15981516061).jpg,

  @haesleinhuepf By Kitmondo Marketplace, licensed CC-BY 2.0

  Adapted from https://commons.wikimedia.org/wiki/File:ZEISS_LSM_800_with_Airyscan-
  27

  BIDS Lecture1/14 _Your_Compact_Confocal_Power_Pack_(15664982003).jpg by Zeiss Microscopy,
  licensed CC-BY-SA 2.0

  April 2nd 2024 https://commons.wikimedia.org/wiki/File:202203_Cryogenic_Transmission_Electron_Microscope.svg
  , by DataBase Center for Life Science,

  licensed CC-BY 4.0'
downloads/12623730_01_Introduction_BIDS_2024_slide23.png: 'Microscopy

  • Common tool to answer biological questions

  Transmitted light microscope Fluorescence microscope Electron microscope

  Sources:

  Robert Haase

  https://commons.wikimedia.org/wiki/File:Histo_Lungenpest.jpg, by PHIL, license public
  domain

  @haesleinhuepf

  Example image of ImageJ, by Tony Collins, license: public domain 28

  BIDS Lecture1/14

  https://commons.wikimedia.org/wiki/File:Electron_microscopy_of_cells_with_cytoplasmic_glycogen_

  April 2nd 2024

  granules.jpg , by Mike Kayser, licensed CC-BY 4.0'
downloads/12623730_01_Introduction_BIDS_2024_slide24.png: 'Transmitted light microscopy

  Robert Haase

  Adapted from Benedict Diederich, https://github.com/openUC2/UC2-

  @haesleinhuepf

  29

  BIDS Lecture1/14 GIT/blob/master/IMAGES/UC2_simplemicroscope.png license CC-BY 4.0

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide25.png: 'Fluorescence Microscopy

  Robert Haase Source:

  @haesleinhuepf

  https://commons.wikimedia.org/wiki/File:FluorescenceFilters. 30

  BIDS Lecture1/14

  April 2nd 2024 jpg by Jennifer Waters, license: public domain'
downloads/12623730_01_Introduction_BIDS_2024_slide26.png: 'Fluorescence Microscope

  • NOT Fluorescent microscope

  Fluorescence microscope Fluorescent microscope

  Adapted from

  Robert Haase

  https://commons.wikimedia.org/wiki/File:ZEISS_LSM_800_with_Airyscan-

  @haesleinhuepf

  31

  BIDS Lecture1/14 _Your_Compact_Confocal_Power_Pack_(15664982003).jpg by Zeiss Microscopy,

  April 2nd 2024 licensed CC-BY-SA 2.0'
downloads/12623730_01_Introduction_BIDS_2024_slide27.png: 'Color maps / lookup tables

  • Just because you see something in red, doesn’t mean it was imaged

  emitting red light.

  Robert Haase

  Source: Example image of ImageJ, by

  @haesleinhuepf

  32

  BIDS Lecture1/14 Tony Collins, license: public domain

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide28.png: 'Color maps / lookup tables

  • The lookup table decides how the image is displayed on screen.

  • Applying a different lookup table doesn’t change the image. All pixel values stay
  the same, they just

  appear differently

  Pixel value Display color Pixel value Display color Pixel value Display color

  0 0 0

  1 1 1

  2 2 2

  … … …

  255 255 255

  Robert Haase

  @haesleinhuepf

  33

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide29.png: 'Color maps / lookup tables

  • Choose visualization of your color tables wisely!

  • Think of people with red/green blindness!

  Default view Red/green blind people see it like this

  Replace red with

  magenta!

  Robert Haase

  @haesleinhuepf

  34

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide30.png: 'Pixel size versus resolution

  • Pixel size is a property of a digital image.

  • You configure it during the imaging session at the microscope.

  Pixel size: 3.3 µm Pixel size: 0.8 µm Pixel size: 0.05 µm

  • We are not talking about resolution!

  Robert Haase

  @haesleinhuepf

  35

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide31.png: 'Pixel size versus resolution

  • Resolution is a property of your imaging system.

  • How small can objects be, to be still differentiable?

  Robert Haase

  @haesleinhuepf

  36

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide32.png: 'Quiz

  • How can I change the pixel size at a microscope

  practically?

  Move Enter in Change Change

  sample software camera objective

  Robert Haase

  @haesleinhuepf

  37

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide33.png: 'Bit-depth

  • A bits is the smallest memory unit in computers, atomic data.

  • The bit-depth n enumerates how many different intensity values are present in
  an image:

  • 2n grey values

  • In microscopy, images are usually stored as 8, 12 or 16-bit images.

  • In computer vision, 8-bit integer and 32-bit float (range 0…1) is more common

  1 2 3 4 5 6 7 8 1 2 16

  Robert Haase

  @haesleinhuepf

  38

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide34.png: 'Light-sheet fluorescence
  microscopy

  • Popular tool for large-volume imaging

  Robert Haase

  @haesleinhuepf Drosophila melanogaster, histone-GFP marked

  39

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide35.png: 'Light-sheet fluorescence
  microscopy

  • Single-plane illumination

  microscopy (SPIM)

  Robert Haase

  Figure left, source: Wikimedia Commons

  @haesleinhuepf

  40

  BIDS Lecture1/14 by Jan Krieger, licensed CC BY-SA 3.0

  April 2nd 2024

  Sample mounting Laser beam scanning'
downloads/12623730_01_Introduction_BIDS_2024_slide36.png: 'Light-sheet fluorescence
  microscopy

  • Single-plane illumination

  microscopy (SPIM)

  Robert Haase Figure left, source: Wikimedia Commons

  @haesleinhuepf

  41

  BIDS Lecture1/14by Jan Krieger, licensed CC BY-SA 3.0

  April 2nd 2024

  Sample mounting Plane scanning'
downloads/12623730_01_Introduction_BIDS_2024_slide37.png: 'Light-sheet fluorescence
  microscopy

  • The beam interacts with the

  tissue while passing matter

  • Refraction

  • [Reflection]

  • Scattering

  • Challenge for quantitative

  analysis: image quality varies

  within the image

  Robert Haase

  Zebrafish [eye] sample kindly provided by Mauricio

  @haesleinhuepf

  42

  BIDS Lecture1/14

  Rocha Martins (Myers/Norden lab, MPI-CBG Dresden)

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide38.png: 'Light-sheet fluorescence
  microscopy

  • These effects depend on the sample

  • Big challenge in practice: Image deep inside

  24h (fish 1) 48h (fish 2) 48+? h (fish2)

  Robert Haase

  Zebrafish [eye] sample kindly provided by Mauricio

  @haesleinhuepf

  43

  BIDS Lecture1/14

  Rocha Martins (Myers/Norden lab, MPI-CBG Dresden)

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide39.png: 'Light-sheet fluorescence
  microscopy

  • These effects depend on the sample

  • Big challenge in practice: Image deep inside

  Approx. 30-50 µm deep Approx. 100 µm deep

  Robert Haase

  @haesleinhuepf

  44

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide40.png: 'High-throughput imaging

  • Challenge: Online decision making while acquisition

  -> AI

  Robert Haase

  @haesleinhuepf

  45

  BIDS Lecture1/14

  2018-05-09-15-51-17-81-Manila_multisample

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide41.png: 'High-throughput imaging

  • Quality variation between samples, in space and

  time [and algorithms which process the data]

  Robert Haase

  @haesleinhuepf Tribolium castaneum, nuclei-GFP

  46

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide42.png: 'High-throughput imaging

  • “Big data”

  Postdoc 2 years imaging

  • 35 TB imaging data

  Assuming

  • one frame is about 200 MB

  • counting nuclei takes 30 sec

  per frame

  Just counting nuclei in all the

  data would take 2 months.

  Robert Haase

  @haesleinhuepf

  47

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide43.png: 'CENTER FOR SCALABLE DATA
  ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Introduction to

  Bioimage Analysis

  Robert Haase

  Robert Haase

  @haesleinhuepf

  48

  BIDS Lecture1/14

  April 2023

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide44.png: 'Bioimage Analysis

  • Kota Miura & Sebastien Tosi 2015:

  Robert Haase

  Source: Bioimage Data Analysis, First Edition. Edited by Kota Miura. 2016 Wiley-VCH
  Verlag

  @haesleinhuepf

  GmbH & Co. KGaA. Published 2016 by Wiley-VCH Verlag GmbH & Co. KGaA 49

  BIDS Lecture1/14

  https://analyticalscience.wiley.com/do/10.1002/was.00050003/full/bioimagedataanalysis.pdf

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide45.png: 'Quantitative bio-image
  analysis

  • Deriving quantitative information from images of biological samples taken

  with microscopes

  cat height = 1.5 x microscope height

  Robert Haase

  @haesleinhuepf

  50

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide46.png: 'Quantitative bio-image
  analysis

  • Deriving quantitative information from images of biological samples taken

  with microscopes + visualization

  Robert Haase

  @haesleinhuepf

  51

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide47.png: 'Objective bio-image analysis

  • Measurements should be objective, not influenced by human interpretation

  Nuclei in this

  image are … _

  … more dense

  than in this image.

  Use automation for

  less subjective

  analysis.

  Robert Haase

  Image data source: Pascual-Reguant, Anna. (2021). Immunofluorescence

  @haesleinhuepf

  staining of a human kidney (#2, peri-tumor area) obtained by MELC [Data 52

  BIDS Lecture1/14

  April 2nd 2024 set]. Zenodo. http://doi.org/10.5281/zenodo.4434462 licensed CC-BY
  4.0'
downloads/12623730_01_Introduction_BIDS_2024_slide48.png: 'Reliable bio-image analysis

  • Algorithms must be reliable (trustworthy).

  • Visualization helps gaining trust in automated methods.

  Original image Label image Overlay

  There are 65 objects

  Robert Haase

  in this image. Source: M. Zoccoler & R. Haase licensed CC-BY

  @haesleinhuepf

  53

  BIDS Lecture1/14 https://haesleinhuepf.github.io/BioImageAnalysisNotebo

  April 2nd 2024 oks/60_data_visualization/overlay_text_on_image.html'
downloads/12623730_01_Introduction_BIDS_2024_slide49.png: 'Reliable bio-image analysis

  • Algorithms must be reliable (validated methods).

  • Publicly available benchmark data sets allow to compare algorithms on

  common data.

  Original image “Ground truth”

  data label images

  Robert Haase

  @haesleinhuepf https://bbbc.broadinstitute.org/BBBC006

  54

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide50.png: 'Reproducible data analysis

  • Allowing others to do your

  experiment again.

  • “The image data was analyzed

  with Python.”

  Can you reproduce

  what they did?

  Robert Haase

  @haesleinhuepf

  55

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide51.png: 'Reproducible bio-image
  analysis

  • Allowing others to do your

  experiment again.

  • “The image data was analyzed

  with Python.”

  Can you reproduce

  what they did? Can you reproduce

  what they did?

  Robert Haase

  @haesleinhuepf

  https://haesleinhuepf.github.io/BioImageAnalysisNotebooks/01_introduction/trailer.html
  56

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide52.png: 'Replicable bio-image analysis

  • Others run the same analysis on their data and have consistent results / same

  conclusions.

  • Can only be achieved if data analysis protocol was documented reproducibly.

  • See also: Replication crisis

  • In Psychology (surveys)

  • In Medicine (clinical trials)

  • In Computer Science

  (executable code)

  • …

  https://journals.plos.org/plosmedicine/article?id=10.1371/jo

  Robert Haase

  @haesleinhuepf

  urnal.pmed.0020124 57

  BIDS Lecture1/14

  April 2nd 2024 https://en.wikipedia.org/wiki/Replication_crisis'
downloads/12623730_01_Introduction_BIDS_2024_slide53.png: 'Repeatable data analysis

  • In wet-lab experiments, samples may get destroyed while executing the

  experiment.

  • Repeatability is a property of the experiment / algorithm. You cannot

  improve repeatability by better documentation.

  Robert Haase https://haesleinhuepf.github.io/BioImageAnalysisNotebooks/47

  @haesleinhuepf

  _clustering/umap.html?highlight=umap#a-note-on-repeatability 58

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide54.png: 'Bio-image Analysis: good
  scientific practice

  Robert Haase

  @haesleinhuepf

  https://bioimagebook.github.io/chapters/0-preamble/preface/preface.html 59

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide55.png: 'Bio-image analysis is supposed
  to be

  • Quantitative

  • We derive numbers from images which describe physical properties of the observed
  sample.

  • Objective

  • The derived measurement does not depend on who did the measurement. The measurement
  is free of

  interpretation.

  • Reliable (trustworthy / validated)

  • We are confident that the measurement is describing what it is supposed to describe.

  • Reproducible

  • Enabling others to re-do the experiment. For this, documentation is crucial!

  • Replicability

  • Others do execute the same analysis, potentially on other data, and see consistent
  results.

  • Repeatable

  • We can do the same experiment twice under the same conditions and get the same
  measurements.

  Robert Haase

  @haesleinhuepf

  60

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide56.png: 'Common topics

  • Typical questions bio-image analysts deal with

  muscle, normal tissue

  • Is signal intensity different under varying conditions?

  • How many cells are in my image?

  • How high is cell density?

  ➢Bio-statistics / medicine / disease staging

  squamous-cell carcinoma

  • How are different tissues characterized?

  • Typical questions bio-image analysts struggle with

  • What force drives the observed processes?

  • What is the lineage tree of one particular cell?

  • Are observation A and observation B related?

  • Are structures observed in different color channels

  colocalized?

  Robert Haase

  @haesleinhuepf

  61

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide57.png: 'Hypothesis-driven quantitative
  biology

  • Hypothesis: Cell shape can be influenced by modifying X.

  • Null-Hypothesis: Circularity of modified cells is similar to cells in the control
  group.

  • Sample preparation

  Shall we use a

  different

  • Imaging

  microscope?

  Should we use a different

  • Cell segmentation

  segmentation algorithm?

  Is circularity the right

  • Circularity measurement

  parameter to

  measure?

  • Statistics

  Robert Haase

  @haesleinhuepf

  62

  BIDS Lecture1/14 6

  April 2nd 2024

  2'
downloads/12623730_01_Introduction_BIDS_2024_slide58.png: 'Hypothesis generating quantitative
  biology

  • Hypothesis: Cell shape can be influenced by modifying X.

  • Question: Which image-derived parameter is influenced when modifying X?

  • Sample preparation

  Which segmentation algorithms

  allow measurements that show a

  • Imaging

  relationship with X?

  • Cell segmentation algorithm A, algorithm B, algorithm C

  Why?

  • Measurement of circularity, solidity, elongation, extend, texture, intensity,
  topology …

  Which parameter shows any

  • Statistics

  relationship with X?

  Robert Haase

  @haesleinhuepf

  63

  BIDS Lecture1/14 6

  April 2nd 2024

  3'
downloads/12623730_01_Introduction_BIDS_2024_slide59.png: 'More resources

  Stéfan van der Walt, Juan Nunez-Iglesias, SciPy 2019

  Guillaume Witz, NEUBIAS Academy 2020

  Watch more:

  • https://www.youtube.com/watch?v=2KF8vBrp3Zw

  • https://www.youtube.com/watch?v=d1CIV9irQAY

  • https://www.youtube.com/watch?v=X_pCiVQ4c4E

  Sreenivas Bhattiprolu, Python for Microscopists @Youtube 2019-…

  Robert Haase

  @haesleinhuepf

  64

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide60.png: 'The Image Science Community

  • Ask your question online and an expert will likely reply the same day ☺

  Robert Haase

  @haesleinhuepf https://image.sc

  65

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide61.png: 'Quiz

  • Enabling others to do your experiment is about …

  Repeatability Replicability Reliability

  Reproducibility

  Robert Haase

  @haesleinhuepf

  66

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide62.png: 'Quiz

  • Reproducibility can be achieved by

  Providing Recording

  Writing

  Writing

  example Video

  documentation code

  data tutorials

  Robert Haase

  @haesleinhuepf

  67

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide63.png: 'Quiz

  • Resolution in imaging describes…

  Minimum size

  Maximum size

  Size of pixels of objects that

  Size of pixels

  of objects in

  on a camera can be

  on a screen relation to the

  chip differentiated

  image

  in an image

  Robert Haase

  @haesleinhuepf

  68

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide64.png: 'Summary

  Coming up next

  Today, you learned

  • Exercises: Setting up your

  • Microscopy

  environment

  • Fluorescence microscopy

  Next week(s):

  • Light-sheet microscopy

  • Research Data Management

  • Bio-image analysis

  • Image processing for microscopy

  • Quantitative

  • Objective

  • Reproducible

  • Repeatable

  • Reliable

  Robert Haase

  @haesleinhuepf

  69

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide65.png: 'CENTER FOR SCALABLE DATA
  ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Exercises

  Robert Haase

  Robert Haase

  @haesleinhuepf

  70

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide66.png: 'Exercises

  Robert Haase

  @haesleinhuepfhttps://github.com/ScaDS/BIDS-lecture-2024

  71

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide67.png: 'Installation

  • You can skip the first local installation steps if you

  already use mamba

  Robert Haase

  @haesleinhuepf

  72

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide68.png: 'Installation

  • Install mini-forge

  Robert Haase

  @haesleinhuepf

  https://github.com/conda-forge/miniforge?tab=readme-ov-file#miniforge3 73

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide69.png: 'Setting up an environment

  • Create a conda/mamba environment

  mamba create --name my_fist_env

  python=3.9 devbio-napari pyqt -c

  conda-forge

  Robert Haase

  @haesleinhuepf

  74

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide70.png: 'Jupyter lab

  • Start Jupyter lab from the folder you want to work in

  • Create a new notebook

  Robert Haase

  @haesleinhuepf

  75

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide71.png: 'Setting up the JupyterHub
  @ Scientific Computing ULEI

  • Alternatively: Register @ Scientific Computing / Uni Leipzig

  Robert Haase https://www.urz.uni-leipzig.de/servicedesk-und-hilfe/hilfe-zu-unseren-

  @haesleinhuepf

  services/forschung/hilfe-webbasiertes-data-science-und-machine-76

  BIDS Lecture1/14

  April 2nd 2024 learning-mit-jupyter'
downloads/12623730_01_Introduction_BIDS_2024_slide72.png: 'Setting up the JupyterHub
  @ Scientific Computing ULEI

  Robert Haase

  @haesleinhuepf

  77

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide73.png: 'Setting up the JupyterHub
  @ Scientific Computing ULEI

  • Detailed instructions

  Robert Haase

  https://github.com/ScaDS/BIDS-lecture-

  @haesleinhuepf

  78

  BIDS Lecture1/14 2024/tree/main/01b_setting_up_sc_ulei_environment

  April 2nd 2024'
downloads/12623730_01_Introduction_BIDS_2024_slide74.png: 'Exercise: Test the environment

  • Download and test the trailer notebook

  Robert Haase

  @haesleinhuepf

  83

  BIDS Lecture1/14

  April 2nd 2024'
downloads/12623730_03_RSM_Image_Processing_slide1.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Research Software Management

  Robert Haase

  Robert Haase

  @haesleinhuepf

  1

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide2.png: 'Quiz (recap)

  • Which of these four is no FAIR principle

  Findable Accessible Inoperable Reusable

  Robert Haase

  @haesleinhuepf

  2

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide3.png: 'Quiz (recap)

  • If I combine two works licensed CC-BY and CC-

  BY-SA, what license do I have to use?

  CC-BY CC-BY-SA CC-BY-ND (not possible)

  Robert Haase

  @haesleinhuepf

  3

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide4.png: 'Quiz (recap)

  • If I combine two works licensed CC-BY-SA and

  CC-BY-ND, what license do I have to use?

  CC-BY-ND-SA CC-BY-SA CC-BY-ND (not possible)

  Robert Haase

  @haesleinhuepf

  4

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide5.png: 'Research Software Management

  • Counterpart to Research Data Management

  • Relatively new term.

  • Special:

  • Version control: git

  • Software environments

  conda/python

  Robert Haase

  @haesleinhuepf

  https://www.nature.com/articles/s41597-022-01710-x 5

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide6.png: 'git

  • Version control is key element of

  data scientist’s toolbox

  • Distributed file system with

  sophisticated logging

  mechanisms

  • Control about what becomes

  part of a repository and what

  not

  Robert Haase

  https://github.com/clEsperanto/pyclesperanto/

  @haesleinhuepf

  6

  BIDS Lecture3/14 graphs/contributors

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide7.png: 'git

  • Git makes file modifications a more active / involved process

  (making people think about)

  Download remote changes

  (first time: clone)

  fetch / pull

  Github

  My Folder

  repository

  push commit

  Stage

  Upload to the internet Enter changes in the history,

  add commit message

  Robert Haase

  @haesleinhuepf

  7

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide8.png: 'git

  • Who wrote

  this code

  • when and

  • why?

  Robert Haase

  https://github.com/haesleinhuepf/example_imag

  @haesleinhuepf

  8

  BIDS Lecture3/14 e_analysis_script/commits/main/

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide9.png: 'git

  • History

  • Track recent

  changes

  Robert Haase

  https://github.com/ScaDS/BIDS-lecture-

  @haesleinhuepf

  9

  BIDS Lecture3/14 2024/commits/main/

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide10.png: 'github – creating repositories

  • Add a new, empty repository

  Robert Haase

  https://focalplane.biologists.com/2021/09/04/colla

  @haesleinhuepf

  10

  BIDS Lecture3/14 borative-bio-image-analysis-script-editing-with-git/

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide11.png: 'github – clone repositories

  • git clone https://github.com/organization/repository

  • Or: Use the Github Desktop app

  Robert Haase

  https://desktop.github.com/

  @haesleinhuepf

  11

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide12.png: 'github - uploading

  • git [add], commit, push

  Robert Haase

  @haesleinhuepf

  12

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide13.png: 'github

  • Ease of reading

  notebooks online

  • No need to

  download and

  execute code

  Robert Haase

  @haesleinhuepf

  13

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide14.png: 'git - forking

  • Making a copy where we have edit rights

  Pull-request /

  merge

  repository repository

  fork fork

  repository

  fork fork fork

  (Robert’s)

  (Oliver’s) (Peter’s)

  Pull-request /

  merge

  Robert Haase

  @haesleinhuepf

  14

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide15.png: 'github - forking

  • Making a copy where we have edit rights

  Robert Haase

  @haesleinhuepf

  15

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide16.png: 'github – uploading (again)

  • After fixing a bug, we upload the changes to our fork

  Robert Haase

  @haesleinhuepf

  16

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide17.png: 'Github – pull requests

  • Contribute to open-source projects

  Robert Haase

  @haesleinhuepf

  17

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide18.png: 'Github – pull requests

  • Reviewer perspective

  Robert Haase

  @haesleinhuepf

  18

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide19.png: 'Github – pull requests

  • Reviewer perspective

  Problem

  solved :-)

  Robert Haase

  @haesleinhuepf

  19

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide20.png: 'Quiz (recap)

  • Sending my modifications to a git-server is done

  using the command git …

  submit push pull commit

  Robert Haase

  @haesleinhuepf

  20

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide21.png: 'Github

  • If this was too fast…

  Robert Haase

  https://focalplane.biologists.com/2021/09/04/colla

  @haesleinhuepf

  21

  BIDS Lecture3/14

  borative-bio-image-analysis-script-editing-with-git/

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide22.png: 'CENTER FOR SCALABLE DATA
  ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Conda environments

  Robert Haase

  Robert Haase

  @haesleinhuepf

  22

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide23.png: 'Conda environments

  • Conda is a package manager

  • Allows to install Python packages

  • Allows to install other stuff (git, JDK)

  • Conda is an environment manager

  • Virtual environments

  • Import/export/distribute environments

  • Pip can only install Python packages (also into conda

  environments)

  Robert Haase

  @haesleinhuepf

  23

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide24.png: 'Conda environments

  • A conda environment is just a folder

  conda env list

  Robert Haase

  @haesleinhuepf

  24

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide25.png: 'Conda environments

  • Packages

  Different

  Different

  within the

  virtual

  environments

  folders are environments

  just linked

  • If you change

  a file in env1,

  the same file

  in env2 is Same

  Do not

  Same physical

  physical

  changed.

  file edit files

  file

  here!

  Robert Haase

  @haesleinhuepf

  25

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide26.png: 'Multiple Python installations

  • On some computers you find this

  If you enter conda

  activate …, which

  of those is executed?

  Robert Haase

  @haesleinhuepf

  26

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide27.png: 'Conda environments

  • Conda environments can be activated from anywhere

  May help dealing

  with multiple

  installations

  Robert Haase

  @haesleinhuepf

  27

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide28.png: 'Broken [conda] environments

  • Common case of confusion in the Python ecosystem

  • Happens to everyone – it’s just a matter of time.

  • Early symptom: You install a package and afterwards, it’s not

  installed.

  Robert Haase

  @haesleinhuepf

  28

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide29.png: 'Background

  • The base-environment is special.

  • You install packages into the base environment, if you do not run conda

  activate my_env

  • You can run base-software from within

  other environments

  Base

  my_env

  Installed packages:

  Installed packages:

  Jupyter lab

  stackview

  Robert Haase

  @haesleinhuepf

  29

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide30.png: 'Broken [conda] environments

  • The only cure: Uninstall and reinstall [Ana]conda.

  Huge effort.

  Little effort.

  • Alternatively:

  • Create a new environment for every project.

  • conda activate my_env

  • Do not install project-specific stuff in the base-environment.

  Robert Haase

  @haesleinhuepf

  30

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide31.png: 'Broken [conda] environments

  Do not install anything in the base environment

  Always call conda activate … before doing anything

  Robert Haase

  @haesleinhuepf

  31

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide32.png: 'Documenting dependencies

  • Maintain a document with the dependencies (and versions) you need in your project!

  • The conda way • The pip way

  In case your

  environment is screwed

  up, you can rebuild it

  any time.

  conda env create -f environment.yml pip install -r requirements.txt

  Robert Haase

  https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-

  @haesleinhuepf

  environments.html#creating-an-environment-from-an-environment-yml-file 32

  BIDS Lecture3/14 3

  April 16th 2024 https://pip.pypa.io/en/stable/cli/pip_install/#examples

  2'
downloads/12623730_03_RSM_Image_Processing_slide33.png: 'Documenting dependencies

  • … the complete way.

  conda env export > environment.yml

  Excellent way to

  document which

  dependencies were

  actually used…

  It is questionable if re-

  creating an environment

  from this yml file works.

  Robert Haase

  @haesleinhuepf

  33

  BIDS Lecture3/14 3

  April 16th 2024

  3'
downloads/12623730_03_RSM_Image_Processing_slide34.png: 'Installing dependencies

  • A difference between pip and conda:

  pip install package_a conda install package_a Depends on:

  numpy<=1.22.0

  Dependency

  conflict

  pip install package_b conda install package_b Depends on:

  numpy>=1.22.0

  passes fails

  Because the environment

  Robert Haase

  cannot be solved

  @haesleinhuepf

  34

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide35.png: 'Installing dependencies

  • A difference between pip and conda:

  pip install git conda install git

  fails passes

  Because git is not a

  python package

  Robert Haase

  @haesleinhuepf

  35

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide36.png: 'Conda versus mamba

  • mamba is a “drop in” replacement that accepts the same

  commands as conda.

  • mamba is much

  faster though.

  Robert Haase Read more:

  @haesleinhuepf https://focalplane.biologists.com/2022/12/08/managing-scientific-
  36

  BIDS Lecture3/14

  python-environments-using-conda-mamba-and-friends/

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide37.png: 'Quiz

  conda install package_a Depends on:

  numpy<=1.22.0

  Dependency

  conflict

  Depends on:

  pip install package_b

  numpy>=1.22.0

  fails works works but…

  Robert Haase

  @haesleinhuepf

  37

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide38.png: 'Software quality indicators

  • Visit the project’s github or gitlab page and review indicators.

  • Stars: People like software, similarly to tweets on Twitter

  • Watching: People receive updates for new releases

  • Forks: People made a copy of the code, e.g. to contribute

  to the project

  • Contributors: People who contributed to the code

  • Commits: Changes to the code

  Robert Haase

  @haesleinhuepf

  https://github.com/napari/napari 38

  BIDS Lecture3/14 3

  April 16th 2024

  8'
downloads/12623730_03_RSM_Image_Processing_slide39.png: 'Software quality indicators

  • Visit the project’s github or gitlab page and review

  indicators.

  Note, github badges

  cannot be deserved.

  Developers put

  them there

  Robert Haase

  Image source: Adapted from https://www.pexels.com/photo/shallow-

  @haesleinhuepf

  39

  BIDS Lecture3/14 focus-photo-of-two-persons-wearing-military-uniform-2859046/ 3

  April 16th 2024

  9'
downloads/12623730_03_RSM_Image_Processing_slide40.png: 'Software quality indicators

  • Download statistics: pypi

  Robert Haase

  @haesleinhuepf

  https://pypistats.org/packages/devbio-napari 40

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide41.png: 'Software quality indicators

  • Download statistics: conda

  Robert Haase

  @haesleinhuepf

  41

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide42.png: 'Software quality indicators

  • Scientific publications

  Robert Haase

  https://github.com/MouseLand/cellpose

  @haesleinhuepf

  42

  BIDS Lecture3/14 https://www.nature.com/articles/s41592-022-01663-4

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide43.png: 'CENTER FOR SCALABLE DATA
  ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Image Processing

  Robert Haase

  Reusing materials from Mauricio Rocha Martins

  (Norden lab, MPI CBG); Dominic Waithe (Oxford

  University); Alex Bird, Dan White (MPI CBG)

  Robert Haase

  @haesleinhuepf

  44

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide44.png: 'Lecture overview: Bio-image
  Analysis

  • Image Data Analysis workflows

  • Goal: Quantify observations, substantiate

  conclusions with numbers

  Plotting

  IImmaaggee ffiilltteerriinngg Image segmentation Feature extraction Object classification

  Robert Haase

  @haesleinhuepf

  45

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide45.png: 'Images and pixels

  • An image is just a matrix of numbers: pixels: “picture element”

  • The edges between pixels are an artefact of the imaging /

  digitization. They are not real!

  0 255

  Robert Haase

  @haesleinhuepf

  46

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide46.png: 'Image stacks and voxels

  • 3-dimensional images

  consisting of voxels

  • “Image stack”

  • Often anisotropic (not equally

  large in all directions)

  𝑙

  𝑧

  𝑙

  𝑦

  𝑙

  𝑥

  𝑙 = 𝑙 ≠R𝑙obert Haase

  𝑥 𝑦 𝑧

  @haesleinhuepf

  47

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide47.png: 'Anisotropy

  • Voxel size has immediate impact on image quality

  and thus, on processing / analysis results.

  1:1 1:2 1:5 1:10

  250 x 250 px 250 x 125 px 250 x 50 px 250 x 25 px

  Robert Haase

  Image source: cropped from

  @haesleinhuepf

  48

  BIDS Lecture3/14 https://de.m.wikipedia.org/wiki/Datei:Histo_Lungenpest.jpg

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide48.png: 'Image stacks and voxels

  Interactive tools available

  Robert Haase

  https://napari.org/

  @haesleinhuepf

  49

  BIDS Lecture3/14 https://github.com/haesleinhuepf/stackview

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide49.png: 'Filters

  • An image processing filter is an operation on an image.

  • It takes an image and produces a new image out of it.

  • There is no “best” filter. Which filter fits your needs, depends on the context.

  • Filters do not do magic. They can not make things visible which are not in the
  image.

  • Application examples

  • Noise-reduction

  • Artefact-removal

  Filter

  • Contrast enhancement

  • Correct uneven illumination

  Robert Haase

  @haesleinhuepf

  Image source: Alex Bird / Dan White MPI CBG 50

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide50.png: 'Effects harming image quality

  “nuclei” “background” “noise”

  • Aberrations, defocus • Light from objects • Shot noise (arriving photons)

  • Motion blur behind and in front of • Dark noise (electrons made

  the scene (out-of-focus from photons)

  light) • Read-out-noise (electronics)

  • Dirt on the object slide

  • Camera offset

  Robert Haase

  @haesleinhuepf

  51

  BIDS Lecture3/14

  April 16th 2024

  https://github.com/BiAPoL/Bio-image_Analysis_with_Python/blob/49a787514a367829c3e0e1832f6cc533e96d549f/03_image_processing/simulated_dataset.ipynb'
downloads/12623730_03_RSM_Image_Processing_slide51.png: 'Effects harming image quality

  “nuclei” “background” “noise”

  Segmentation

  Robert Haase

  @haesleinhuepf

  52

  BIDS Lecture3/14

  April 16th 2024

  https://github.com/BiAPoL/Bio-image_Analysis_with_Python/blob/49a787514a367829c3e0e1832f6cc533e96d549f/03_image_processing/simulated_dataset.ipynb'
downloads/12623730_03_RSM_Image_Processing_slide52.png: 'Image filtering

  • We need to remove the noise to help the computer interpreting the image

  Oh no! I see thousands

  of tiny white objects!

  Segmentation

  Filtering

  Ok, it’s just 9 objects.

  Segmentation

  Robert Haase

  @haesleinhuepf

  53

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide53.png: 'Image filtering

  • Attempt to invert / “undo” processes disturbing image

  quality

  ?

  Robert Haase

  @haesleinhuepf

  54

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide54.png: 'Image filtering

  • Attempt to invert / “undo” processes disturbing image

  quality

  Low-pass filter:

  Allows low

  frequencies pass

  Denoise

  ͌

  Denoise

  Remove

  Band-pass filter:

  background High-pass filter:

  Allows a specific range

  Allows high

  of frequencies pass

  frequencies pass

  Robert Haase

  @haesleinhuepf

  55

  BIDS Lecture3/14

  April 16th 2024

  https://github.com/BiAPoL/Bio-image_Analysis_with_Python/blob/49a787514a367829c3e0e1832f6cc533e96d549f/03_image_processing/simulated_dataset.ipynb'
downloads/12623730_03_RSM_Image_Processing_slide55.png: 'Linear Filters

  Linear filters replace each pixel value with

  •

  a weighted linear combination of

  surrounding pixels

  Filter kernels are matrices describing a

  •

  linear filter

  This multiplication of surrounding pixels

  •

  according to a matrix is called convolution

  1/9 1/9 1/9

  Mean filter, 3x3 kernel

  1/9 1/9 1/9

  1/9 1/9 1/9

  Robert Haase

  @haesleinhuepf Animation source: Dominic Waithe, Oxford University

  56

  BIDS Lecture3/14

  https://github.com/dwaithe/generalMacros/tree/master/convolution_ani

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide56.png: 'Linear filters

  • Terminology:

  • “We convolve an image with a kernel.”

  • Convolution operator: *

  =

  1 1 1

  *

  1 8 1

  Examples

  – 1 1 1

  Mean

  –

  Gaussian blur 0 -1 0

  – =

  *

  Sobel-operator

  –

  -1 4 -1

  Laplace-filter

  –

  0 -1 0

  Robert Haase

  @haesleinhuepf

  57

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide57.png: 'Non-linear Filters

  Non-linear filters also replace pixel value inside as rolling window but using a
  non-linear

  •

  function.

  Examples: order statistics filters

  •

  – Min

  – Median

  – Max

  – Variance

  – Standard deviation

  75 85 60

  [ ]

  67 73 91 50 59 60 67 73 75 85 88 91

  50 88 59

  Min Median Max

  Robert Haase

  @haesleinhuepf

  58

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide58.png: 'Noise removal

  • Gaussian filter

  • Median filter (computationally expensive)

  Robert Haase

  @haesleinhuepf

  Image source: Mauricio Rocha Martins (Norden/Myers lab, MPI CBG) 59

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide59.png: 'Filtering for improving thresholding
  results

  • In case thresholding algorithms outline the wrong structure, blurring in advance
  may help.

  • However: Do not continue processing the blurred image, continue with the original!

  Blurring +

  Thresholding ☺

  Contour on

  original image

  Thresholding 

  Robert Haase

  @haesleinhuepf

  60

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide60.png: 'Difference-of-Gaussian (DoG)

  • Improve image in order to detect bright objects.

  • Band-pass filter

  Gaussian blur (sigma = 2)

  subtract

  Noise reduced image

  Original image DoG-Image

  Gaussian blur (sigma = 6)

  “dog-2-6”

  Background image

  Robert Haase

  @haesleinhuepf

  61

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide61.png: 'Difference-of-Gaussian (DoG)

  • Example DoG

  images

  Robert Haase

  @haesleinhuepf

  62

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide62.png: 'Top-hat filter

  • Background subtraction

  Minimum Maximum Subtract

  Robert Haase

  @haesleinhuepf

  65

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide63.png: 'Top-hat filter

  • Background subtraction

  Minimum Maximum Subtract

  Robert Haase

  @haesleinhuepf

  66

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide64.png: 'Quiz: Noise removal

  • The median filter is a …

  Linear filter

  Median

  Non-linear filter

  Robert Haase

  @haesleinhuepf

  67

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide65.png: 'Background removal

  • Removing background from an image is a … ?

  Low-pass

  filter

  Top-hat

  High-pass

  filter

  Robert Haase

  @haesleinhuepf

  68

  BIDS Lecture3/14

  April 16th 2024

  Image source: Mauricio Rocha Martins (Norden/Myers lab, MPI CBG)'
downloads/12623730_03_RSM_Image_Processing_slide66.png: 'CENTER FOR SCALABLE DATA
  ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Exercises

  Robert Haase

  Robert Haase

  @haesleinhuepf

  69

  BIDS Lecture3/14

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide67.png: 'Exercise: pull-request

  • Clone the training materials repository

  • Fix the typo on this page, send a pull-request

  Robert Haase

  https://github.com/haesleinhuepf/BIDS-lecture-

  @haesleinhuepf

  70

  BIDS Lecture3/14

  2024/blob/main/03a_pull_requests/readme.md

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide68.png: 'Exercise: image processing

  • Get started with loading, viewing, cropping and processing

  images

  Robert Haase

  https://github.com/ScaDS/BIDS-lecture-

  @haesleinhuepf

  71

  BIDS Lecture3/14 2024/tree/main/03b_image_processing

  April 16th 2024'
downloads/12623730_03_RSM_Image_Processing_slide69.png: 'Exercise: dependencies

  • There is a Jupyter Notebook which doesn’t work

  (anymore). Find out why.

  • Fix it in two ways:

  • A) by changing

  the code

  • B) by not changing

  the code

  https://github.com/ScaDS/BIDS-lecture-

  Robert Haase

  @haesleinhuepf

  2024/blob/main/03c_dependency_management/breaki 72

  BIDS Lecture3/14

  April 16th 2024 ng_backwards_compatibility.ipynb'
downloads/12623730_04_Image_segmentation_slide1.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Image segmentation

  Robert Haase

  Using materials from Marcelo Leomil Zoccoler and Johannes Soltwedel,

  PoL, TU Dresden

  Robert Haase

  @haesleinhuepf

  1

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide2.png: 'Recap

  How can one solve this problem?

  A) By modifying the code

  B) By not modifying the code

  Robert Haase

  @haesleinhuepf

  2

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide3.png: 'Quiz (recap)

  • Which of the following is a band-pass filter?

  Difference

  Gaussian Median Top-hat of Gaussian

  Robert Haase

  @haesleinhuepf

  3

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide4.png: 'Quiz (recap)

  • Which of the following is a denoising filter?

  Difference

  Gaussian Median Top-hat of Gaussian

  Robert Haase

  @haesleinhuepf

  4

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide5.png: 'Lecture overview: Bio-image
  Analysis

  • Image Data Analysis workflows

  • Goal: Quantify observations, substantiate conclusions with

  numbers

  Plotting

  Image filtering Image segmentation Feature extraction Object classification

  Robert Haase

  @haesleinhuepf

  5

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide6.png: 'Thresholding: Otsu’s method

  • Searching for a threshold where the variance in both classes (above/below threshold)

  becomes minimal.

  𝑔 𝑉𝑎𝑟(𝐼) … Variance in image I

  𝑖

  g … grey value of a pixel i

  𝑉𝑎𝑟(𝐼) = ෍ 𝑔 − 𝑔ҧ 𝑔ҧ = ෍ i

  𝑖 𝐼 𝐼 𝑔ത … mean grey value of the whole image I

  𝑛

  𝐼

  𝐼

  𝑛 … number of pixels in Image I

  𝑖 ∈𝐼 𝑖 ∈𝐼 𝐼

  Below threshold

  Above threshold

  Robert Haase

  @haesleinhuepf

  6

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide7.png: 'Thresholding: Otsu’s method

  • Searching for a threshold where the variance in both classes (above/below threshold)

  becomes minimal.

  𝑔 𝑉𝑎𝑟(𝐼) … Variance in image I

  𝑖

  g … grey value of a pixel i

  𝑉𝑎𝑟(𝐼) = ෍ 𝑔 − 𝑔ҧ 𝑔ҧ = ෍ i

  𝑖 𝐼 𝐼 𝑔ത … mean grey value of the whole image I

  𝑛

  𝐼

  𝐼

  𝑛 … number of pixels in Image I

  𝑖 ∈𝐼 𝑖 ∈𝐼 𝐼

  Below threshold

  Above threshold

  Robert Haase

  @haesleinhuepf

  7

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide8.png: 'Thresholding: Otsu’s method

  • Searching for a threshold where the variance in both classes (above/below threshold)

  becomes minimal.

  𝑔 𝑉𝑎𝑟(𝐼) … Variance in image I

  𝑖

  g … grey value of a pixel i

  𝑉𝑎𝑟(𝐼) = ෍ 𝑔 − 𝑔ҧ 𝑔ҧ = ෍ i

  𝑖 𝐼 𝐼 𝑔ത … mean grey value of the whole image I

  𝑛

  𝐼

  𝐼

  𝑛 … number of pixels in Image I

  𝑖 ∈𝐼 𝑖 ∈𝐼 𝐼

  Below threshold

  Above threshold

  Robert Haase

  @haesleinhuepf

  8

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide9.png: 'Thresholding: Otsu’s method

  • Searching for a threshold where the variance in both classes (above/below threshold)

  becomes minimal.

  𝑛 𝑛

  𝐴 𝐵

  𝑉𝑎𝑟′(𝐼) = 𝑉𝑎𝑟(𝐴) + 𝑉𝑎𝑟(𝐵) 𝐼 = 𝐴 ∪ 𝐵

  • Weighted (!)

  𝑛 𝑛

  sum variance 𝐼 𝐼

  Below threshold

  Above threshold

  Robert Haase

  @haesleinhuepf

  9

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide10.png: 'Thresholding: Otsu’s method

  • Searching for a threshold where the variance in both classes (above/below threshold)

  becomes minimal.

  𝑛 𝑛

  𝐴 𝐵

  𝑉𝑎𝑟′(𝐼) = 𝑉𝑎𝑟(𝐴) + 𝑉𝑎𝑟(𝐵) 𝐼 = 𝐴 ∪ 𝐵

  • Weighted (!)

  𝑛 𝑛

  sum variance 𝐼 𝐼

  Below threshold

  Above threshold

  Robert Haase

  @haesleinhuepf

  10

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide11.png: 'Thresholding: Otsu’s method

  • Searching for a threshold where the variance in both classes (above/below threshold)

  becomes minimal.

  𝑛 𝑛

  𝐴 𝐵

  𝑉𝑎𝑟′(𝐼) = 𝑉𝑎𝑟(𝐴) + 𝑉𝑎𝑟(𝐵) 𝐼 = 𝐴 ∪ 𝐵

  • Weighted (!)

  𝑛 𝑛

  sum variance 𝐼 𝐼

  Below threshold

  Above threshold

  Robert Haase

  @haesleinhuepf

  11

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide12.png: 'Thresholding: Citing

  • Cite the thresholding method of your choice properly

  “We segmented the cell nuclei in the images using

  Otsu’s thresholding method (Otsu et Al. 1979)

  implemented in scikit-image (van der Walt et al. 2014).”

  Robert Haase

  @haesleinhuepf

  12

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide13.png: 'Refining masks

  • Binary mask images may not be perfect immediately

  after thresholding.

  • There are ways of refining them

  Thresholding Closing Opening

  Robert Haase

  @haesleinhuepf

  13

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide14.png: 'Erosion

  • Erosion: Every pixel with at least one black neighbor

  becomes black.

  Erosion

  Robert Haase

  @haesleinhuepf

  14

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide15.png: 'Quiz

  • Binary erosion is identical with which filter?

  0 0 0 0 0 0 0 0 0 0

  0 1 1 1 0 0 0 0 0 0

  Erosion

  0 1 1 1 0 0 0 1 0 0

  0 1 1 1 0 0 0 0 0 0

  0 0 0 0 0 0 0 0 0 0

  Mean Median Minimum Maximum

  Robert Haase

  @haesleinhuepf

  15

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide16.png: 'Dilation

  • Dilation: Every pixel with at least one white neighbor

  becomes white.

  Dilation

  8-connected neighborhood

  Robert Haase

  @haesleinhuepf

  16

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide17.png: 'Dilation

  • Dilation: Every pixel with at least one white neighbor

  becomes white.

  DDiillaattiioonn

  84--ccoonnnneecctteedd nneeiigghhbboorrhhoooodd

  Robert Haase

  @haesleinhuepf

  17

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide18.png: 'Opening

  • Erosion and dilation combined allow correcting outlines.

  Opening

  Erosion Dilation

  Robert Haase

  @haesleinhuepf

  18

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide19.png: 'Closing

  • Erosion and dilation combined allow correcting outlines.

  Closing

  Dilation Erosion

  Robert Haase

  @haesleinhuepf

  19

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide20.png: 'Chaining erosion and dilation

  • Erosion: Set all pixels to black which have at least one black neighbor.

  Erosion Erosion Erosion

  • Dilation: Set all pixels to white which have at least one white neighbor.

  Dilation Dilation Dilation

  • Closing: Dilation + Erosion

  Dilation Erosion

  • Opening: Erosion + Dilation

  Robert Haase

  @haesleinhuepf

  20

  BIDS Lecture4/14

  April 23rd 2024

  Slide adapted from Haase, Lombardot, Scientific Computing Facility, MPI CBG, licensed
  CC BY-NC 4.0'
downloads/12623730_04_Image_segmentation_slide21.png: 'Terminology

  Intensity image Binary image Label image

  No matter how they are displayed

  Robert Haase

  @haesleinhuepf

  21

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide22.png: 'Terminology

  Instance segmentation Semantic segmentation

  Instances: Regions:

  • Cells, nuclei, cats, dogs, cars, • Anatomical, geographical

  trees • All pixels belonging to the same type of

  object have the same value

  Robert Haase

  @haesleinhuepf Source: Allen Mouse Brain Atlas [dataset]. Available frommouse.brain-map.org.

  22

  BIDS Lecture4/14 Allen Institute for Brain Science (2011).

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide23.png: 'Terminology

  • Annotations are typically drawn by humans (e.g. to train machine learning models)

  Instance Semantic

  segmentation segmentation

  Sparse semantic

  Sparse instance

  annotation

  annotation

  Robert Haase

  @haesleinhuepf

  23

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide24.png: 'Connected component labelling

  • In order to allow the computer differentiating objects, connected component analysis
  (CCA) is used to

  mark pixels belonging to different objects with different numbers

  • Background pixels are marked with 0.

  • The maximum intensity of a labelled map corresponds to the number of objects.

  1 0 0 0 0 0 0

  1 1 0 0 0 0 0

  1 1 1 0 0 0 0

  CCA 1 1 0 0 0 3 0

  0 0 0 0 3 3 3

  0 0 0 3 3 3 3

  2 2 0 3 3 3 3

  Robert Haase

  @haesleinhuepf

  24

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide25.png: 'Common image segmentation workflows

  • Presumably the most common segmentation algorithm used for fluorescent microscopy

  images:

  Limitation: Dense

  • Gaussian blur, Otsu’s Threshold, Connected Component Labeling

  objects

  Denoising Binarization Labeling

  Robert Haase

  @haesleinhuepf

  25

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide26.png: 'Voronoi-Tesselation

  • For separating objects using spatial constraints (not intensity-based)

  Dilate Dilate Edge

  labels labels detection

  Label-image Voronoi-label-image Label-edge-image

  Centroid

  mesh

  Touching neighbor mesh Voronoi-Tesselation

  Delauney-Triangulation

  Robert Haase

  @haesleinhuepf

  26

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide27.png: 'Common image segmentation workflows

  • Combination of Gaussian blur, Otsu’s Threshold and Voronoi-labeling

  Local

  Gaussian

  maxima

  blur

  detection

  Masked

  Voronoi

  labeling

  Otsu’s

  Gaussian

  Threshold

  blur

  Robert Haase

  https://haesleinhuepf.github.io/BioImageAnalysisNotebooks

  @haesleinhuepf

  27

  BIDS Lecture4/14 /20_image_segmentation/11_voronoi_otsu_labeling.html

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide28.png: 'Watershed

  • The watershed algorithm for binary images allows cutting one object into tow where
  it’s reasonable.

  Binary segmentation Distance map

  Robert Haase

  @haesleinhuepf

  28

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide29.png: 'Watershed

  • The watershed algorithm for binary images allows cutting one object into tow where
  it’s reasonable.

  Binary segmentation Distance map

  Robert Haase

  @haesleinhuepf

  29

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide30.png: 'Watershed

  • The watershed algorithm for binary images allows cutting one object into two where
  it’s reasonable.

  • The distance-maps are typicall made from binary images. It does not take the original
  image into account!

  Binary segmentation Distance map Binary watershed Labeled watershed

  Robert Haase

  @haesleinhuepf

  30

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide31.png: 'Watershed use-cases

  • Split dense objects

  Binarization

  Robert Haase

  @haesleinhuepf

  31

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide32.png: 'Watershed use-cases

  • Seeded watershed: Flood regions from pre-defined seeds

  • Example: Flood cells from nuclei positions

  “Seeded” watershed

  Robert Haase

  @haesleinhuepf

  32

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide33.png: 'Label post-processing / morphological
  operations

  • … similar to morphological operations on binary images

  Original Eroding labels Dilating Labels

  Robert Haase

  @haesleinhuepf

  33

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide34.png: 'Label post-processing / morphological
  operations

  • … similar to morphological operations on binary images

  Original Eroding labels Dilating Labels

  This

  combination

  Robert Haase Opening Closing

  @haesleinhuepf

  is called ...? 34

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide35.png: 'Epilepsy warning

  Robert Haase

  @haesleinhuepf

  35

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide36.png: 'Label post-processing / morphological
  operations

  • … similar to morphological operations on binary images

  Original Opening labels Smoothing Labels

  Robert Haase

  @haesleinhuepf

  36

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide37.png: 'Label post-processing / selections

  • Remove objects at the image border

  • Their measurements (shape, size) would be misleading anyway

  Robert Haase

  @haesleinhuepf

  37

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide38.png: 'Label post-processing / selections

  • Excluding small / large objects

  • Common correction-step in case segmentations contain noise-related

  small particles

  Exclude small objects

  Exclude large objects

  Robert Haase

  @haesleinhuepf

  38

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide39.png: 'Quiz

  • What’s a reasonable approach to process such an

  image?

  Machine-

  Thresholding Watershed Learning

  Robert Haase

  @haesleinhuepf

  39

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide40.png: 'CENTER FOR SCALABLE DATA ANALYTICS
  AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Napari

  Robert Haase

  Robert Haase These slides and the related training materials can be reused under
  the

  @haesleinhuepf terms of the CC-BY 4.0 license. https://doi.org/10.5281/zenodo.10207321

  40

  BIDS Lecture4/14 https://scads.github.io/napari-tutorial-2023

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide41.png: 'Napari

  • A viewer for n-dimensional image data written in Python

  Robert Haase

  @haesleinhuepf

  41

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide42.png: 'Napari – Graphical User Interface

  View configuration /

  Dock widgets

  tools

  (custom plugins)

  Layers

  Function widgets

  Viewer controls

  (custom plugins)

  Robert Haase

  @haesleinhuepf

  42

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide43.png: 'Napari – Graphical User Interface

  • Context / data type dependent tools

  Robert Haase

  @haesleinhuepf

  43

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide44.png: 'Napari – Python Scripting

  • Mixing interactivity and reproducibility

  Robert Haase

  @haesleinhuepf

  45

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide45.png: 'Napari – Python Scripting

  • Initialization

  import napari

  # Create an empty viewer

  viewer = napari.Viewer()

  • Adding images

  viewer.add_image(image)

  Robert Haase

  @haesleinhuepf

  46 46

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide46.png: 'Napari – Python Scripting

  • Make screenshots from napari and put them in your jupter notebook

  napari.utils.nbscreenshot(viewer)

  Place your viewer here

  Robert Haase

  @haesleinhuepf

  47 47

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide47.png: 'Napari – Python Scripting

  • Removing layers

  for l in viewer.layers:

  viewer.layers.remove(l)

  • Modify visualization while adding layers

  viewer.add_image(image,

  colormap=''green’)

  • Modify layers after adding

  layer = viewer.add_image(image)

  layer.colormap = ''green’

  layer.contrast_limits = (0, 128)

  Robert Haase

  @haesleinhuepf

  48 48

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide48.png: 'Napari – Python Scripting

  • Binary images and label images visualized as label layers

  from skimage.filters import threshold_otsu

  threshold = threshold_otsu(blurred_image)

  binary_image = blurred_image > threshold

  # Add a new labels layer containing an image

  viewer.add_labels(binary_image)

  Robert Haase

  @haesleinhuepf

  49 49

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide49.png: 'The Napari Assistant

  • Tools > Utilities > Assistant (na)

  Viewer Image

  controls Processing

  Robert Haase

  @haesleinhuepf

  https://www.napari-hub.org/plugins/napari-assistant 50

  BIDS Lecture4/14 5

  April 23rd 2024

  0'
downloads/12623730_04_Image_segmentation_slide50.png: 'The Napari Assistant

  • A pocket-calculator-like

  interface to build image

  analysis workflows

  Robert Haase

  @haesleinhuepf

  https://www.napari-hub.org/plugins/napari-assistant 51

  BIDS Lecture4/14 5

  April 23rd 2024

  1'
downloads/12623730_04_Image_segmentation_slide51.png: 'The Napari Assistant

  • Classical image processing

  operations + advanced tools

  • Saving&loading supported

  • Undo [redo]

  • Hints for next steps

  • …

  Big thanks to:

  Ryan Savill

  @RyanSavill4

  Robert Haase

  @haesleinhuepf

  https://www.napari-hub.org/plugins/napari-assistant 52

  BIDS Lecture4/14 5

  April 23rd 2024

  2'
downloads/12623730_04_Image_segmentation_slide52.png: 'Workflow building

  • Try different

  algorithms,

  e.g. for

  removing

  noise

  • Find them in

  the pulldown

  Robert Haase

  @haesleinhuepf

  53

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide53.png: 'Workflow building

  • Try different

  binarization

  algorithms

  Robert Haase

  @haesleinhuepf

  54

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide54.png: 'Workflow building

  • Try different

  labeling

  algorithms

  Robert Haase

  @haesleinhuepf

  55

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide55.png: 'The Tools menu

  • Organized in categories

  Robert Haase

  @haesleinhuepf

  56

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide56.png: 'Workflow building

  Also check out the Tools > Segmentation / labeling menu

  Robert Haase

  @haesleinhuepf

  57

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide57.png: 'Short-cuts: Voronoi-Otsu-Labeling

  Also check out the Tools > Segmentation / labeling menu

  Voronoi-Otsu-Labeling

  Gauss-Otsu-Labeling

  Robert Haase

  @haesleinhuepf

  58

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide58.png: 'Watershed

  Also check out the Tools > Segmentation / labeling menu

  Robert Haase

  @haesleinhuepf

  59

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide59.png: 'Watershed

  • From binary images

  Tools > Segmentation / labeling >

  Label touching objects

  Tools > Segmentation post-

  processing >

  Split touching objects

  (Similar to ImageJ’s Watershed)

  Robert Haase

  @haesleinhuepf

  60

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide60.png: 'Label erosion, dilation, opening,
  closing, …

  • In Napari Assistant: Process labels

  Robert Haase

  @haesleinhuepf

  61

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide61.png: 'Browse operations

  • Use the search… This only works if

  developers documents

  their plugins well ;-)

  Enter the library name Enter the structure you

  Search the internet

  you want to use would like to segment

  Robert Haase

  @haesleinhuepf

  https://www.napari-hub.org/plugins/napari-assistant 62

  BIDS Lecture4/14 6

  April 23rd 2024

  2'
downloads/12623730_04_Image_segmentation_slide62.png: 'Export code to Jupyter Notebooks

  Robert Haase

  @haesleinhuepf https://github.com/haesleinhuepf/napari-assistant

  63

  BIDS Lecture4/14 6

  Image data source: Mauricio Rocha Martins, Norden lab, MPI CBG (now at IGC Oeiras)

  April 23rd 2024

  3'
downloads/12623730_04_Image_segmentation_slide63.png: 'Export code to Jupyter Notebooks

  Robert Haase

  https://github.com/haesleinhuepf/napari-assistant

  @haesleinhuepf

  64

  BIDS Lecture4/14

  #code-generation

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide64.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Image segmentation in Python

  Robert Haase

  Robert Haase

  @haesleinhuepf

  65

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide65.png: 'Voronoi-Otsu-Labeling

  • Gaussian-Blur

  • Otsu-Thresholding … in a single line of code:

  • Spot-detection

  • Watershed on the binary image

  Robert Haase

  @haesleinhuepf

  66

  BIDS Lecture4/14

  https://haesleinhuepf.github.io/BioImageAnalysisNotebooks/20_image_segmentation/11_voronoi_otsu_labeling.html

  April 23rd 2024

  https://www.youtube.com/watch?v=evgRgDfVuEc'
downloads/12623730_04_Image_segmentation_slide66.png: 'Anisotropy

  • Some [segmentation] algorithms have prerequisites…

  Robert Haase

  @haesleinhuepf

  67

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide67.png: 'Anisotropy

  • Reminder: Anisotropic images might be tricky to process properly

  Robert Haase

  @haesleinhuepf

  68

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide68.png: 'Reslicing / scaling / sampling

  • Resample image data to a specific voxel size

  Robert Haase

  @haesleinhuepf

  69

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide69.png: 'Watershed

  • … in Python practice

  Robert Haase

  @haesleinhuepf

  70

  BIDS Lecture4/14

  April 23rd 2024 https://www.napari-hub.org/plugins/napari-segment-blobs-and-things-with-membranes#seeded-watershed'
downloads/12623730_04_Image_segmentation_slide70.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Exercises

  Robert Haase

  Robert Haase

  @haesleinhuepf

  71

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide71.png: 'Image segmentation exercises

  • Try out segmentation algorithms and apply them to

  _ other datasets

  Robert Haase

  https://github.com/ScaDS/BIDS-lecture-

  @haesleinhuepf

  72

  BIDS Lecture4/14 2024/tree/main/04a_image_segmentation

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide72.png: 'Image segmentation exercises

  • 3D image processing may require GPU-acceleration

  • In case there are errors:

  https://github.com/clEsperanto/pyclesperanto_prototype/?tab=readme-ov-file#troubleshooting-graphics-cards-drivers

  Robert Haase

  https://github.com/ScaDS/BIDS-lecture-

  @haesleinhuepf

  73

  BIDS Lecture4/14 2024/tree/main/04a_image_segmentation

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide73.png: 'Napari - Exercises

  • Start using napari from Python

  Robert Haase

  https://github.com/ScaDS/BIDS-lecture-

  @haesleinhuepf

  74

  BIDS Lecture4/14 2024/blob/main/04b_napari_notebooks/napari_intro.ipynb

  April 23rd 2024'
downloads/12623730_04_Image_segmentation_slide74.png: 'Napari - Exercises

  • Start napari from the terminal!

  • Follow the instructions to set up a workflow and export a Jupyter notebook

  https://github.com/ScaDS/BIDS-lecture- https://github.com/ScaDS/BIDS-lecture-

  2024/blob/main/04b_napari_notebooks/napari-assistant.md 2024/blob/main/04b_napari_notebooks/notebook_export.md

  Robert Haase

  @haesleinhuepf

  75

  BIDS Lecture4/14

  April 23rd 2024'
downloads/12623730_05_Surface_Recon_QA_slide1.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Surface reconstruction

  Robert Haase

  Using materials from Alba Villaronga Luque and Jesse Veenvliet (MPI CBG

  Dresden), Marcelo Leomil Zoccoler, Johannes Soltwedel and Mara

  Lampert, PoL, TU Dresden

  Robert Haase

  @haesleinhuepf

  1

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide2.png: 'Sparse Jaccard Index

  This is a …

  Sparse Sparse

  instance semantic

  segmentation segmentation

  Robert Haase

  @haesleinhuepf

  2

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide3.png: 'Quiz: Recap

  • How is this operation called?

  ?

  Dilation Erosion Opening Closing

  Robert Haase

  @haesleinhuepf

  3

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide4.png: 'Quiz: Recap

  • How is this operation called?

  ?

  Dilation Erosion Opening Closing

  Robert Haase

  @haesleinhuepf

  4

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide5.png: 'Quiz: Recap

  • How is this operation called?

  ?

  Dilation Erosion Opening Closing

  Robert Haase

  @haesleinhuepf

  5

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide6.png: 'Motivation: Surface reconstruction

  • Pixel and voxel arrays can be huge in memory

  • Processing 3D arrays is time-consuming

  1024 x1024 x 100 1024 x1024 x 100 1024 x1024 x 100 1024 x1024 x 100

  16-bit image 16-bit image 8-bit image 16-bit image

  How much memory does

  700 MB 400 MB 4 GB 7 GB

  this workflow cost?

  Robert Haase

  @haesleinhuepf

  6

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide7.png: 'Motivation: Surface reconstruction

  • Pixel and voxel borders introduce artifacts, potentially problematic for

  measurements, e.g. surface area

  Robert Haase

  @haesleinhuepf

  7

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide8.png: 'Surface meshes

  • Points on a surfaces

  connected by triangles

  forma a surface mesh

  “Vertices” / points “Faces” / Triangles

  Point x Point y Point z Point 1 Point 2 Point 3

  4

  x y z 1 2 3

  3

  1 1 1

  1

  +

  X Y Z 1 2 4

  2 2 2

  X Y Z 2 3 4

  3 3 3

  X Y Z 1 3 4

  2

  4 4 4

  … … …

  Robert Haase

  Data derived fromAV Luque and JV Veenvliet (2023)

  @haesleinhuepf

  8

  BIDS Lecture5/14 licensed CC-BY : https://zenodo.org/record/7603081

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide9.png: 'Surface reconstruction

  3D image of nuclei Gaussian filtered Binary 3D image

  (visualized as surface mesh)

  Robert Haase

  Data derived fromAV Luque and JV Veenvliet (2023)

  @haesleinhuepf

  9

  BIDS Lecture5/14 licensed CC-BY : https://zenodo.org/record/7603081

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide10.png: 'Marching cubes algorithm

  • Starting point: 3D binary image

  • Cuts the image in small cubes and iterates over them

  Split into cubes

  Robert Haase

  @haesleinhuepf

  10

  BIDS Lecture5/14 Lorensen, William E.; Cline, Harvey E. (1 August 1987). "Marching
  cubes: A high resolution 3D surface construction

  April 30th 2024 algorithm".ACM SIGGRAPH Computer Graphics.21(4): 163-169.CiteSeerX
  10.1.1.545.613.doi:10.1145/37402.37422.'
downloads/12623730_05_Surface_Recon_QA_slide11.png: 'Marching cubes algorithm

  • Starting point: 3D binary image

  • Cuts the image in small cubes and iterates over them

  Robert Haase

  @haesleinhuepf

  11

  BIDS Lecture5/14 Lorensen, William E.; Cline, Harvey E. (1 August 1987). "Marching
  cubes: A high resolution 3D surface construction

  April 30th 2024 algorithm".ACM SIGGRAPH Computer Graphics.21(4): 163-169.CiteSeerX
  10.1.1.545.613.doi:10.1145/37402.37422.'
downloads/12623730_05_Surface_Recon_QA_slide12.png: 'Marching cubes algorithm

  • Starting point: 3D binary image

  • Cuts the image in small cubes and iterates over them

  Split into cubes Build triangles Combine triangles

  Robert Haase Lorensen, William E.; Cline, Harvey E. (1 August 1987). "Marching cubes:
  A high

  @haesleinhuepf

  resolution 3D surface construction algorithm".ACM SIGGRAPH Computer 12

  BIDS Lecture5/14

  Graphics.21(4): 163-169.CiteSeerX 10.1.1.545.613.doi:10.1145/37402.37422.

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide13.png: 'Surface post-processing

  • Necessary to better match biological reality.

  To many points

  and triangles!

  Marching cubes result Simplified mesh Smoothed mesh

  (less points, locally averaged) (position locally planarized)

  Robert Haase

  Data derived fromAV Luque and JV Veenvliet (2023)

  @haesleinhuepf

  13

  BIDS Lecture5/14 licensed CC-BY : https://zenodo.org/record/7603081

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide14.png: 'Surface post-processing

  • Every processing step has consequences errors of later measurements

  • Depends on desired measurement Number of small

  Total length

  concave regions

  Surface mesh Simplified by factor 0.5 Simplified by factor 0.05 Simplified by factor
  0.01

  Robert Haase

  Data derived fromAV Luque and JV Veenvliet (2023)

  @haesleinhuepf

  14

  BIDS Lecture5/14 licensed CC-BY : https://zenodo.org/record/7603081

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide15.png: 'Surface reconstruction / Processing

  • Tools > Surfaces > Create surface …

  You need to install an

  extra napari-plugin:

  https://github.com/haesle

  inhuepf/napari-process-

  points-and-surfaces

  Robert Haase

  @haesleinhuepf

  15

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide16.png: 'Surface reconstruction

  • Turn binary and/or label images into surface meshes

  Robert Haase

  @haesleinhuepf

  16

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide17.png: 'Surface mesh processing

  • Surface mesh simplification

  • To prevent the computer freezing

  Robert Haase

  @haesleinhuepf

  17

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide18.png: 'Surface mesh processing

  • Surface mesh smoothing

  Robert Haase

  @haesleinhuepf

  18

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide19.png: 'View surface meshes in Napari

  In case your computer

  freezes, comment out

  this line

  Toggle 3D

  view and grid

  mode

  Robert Haase

  @haesleinhuepf

  19

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide20.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Segmentation quality

  estimation

  Robert Haase

  Reusing materials from Lena Maier-Hein, Annika Reinke (DKFZ) et al.

  and Martin Schätz (Charles Uni Prague)

  Robert Haase

  @haesleinhuepf

  20

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide21.png: 'Goal

  • Compare label images quantitatively, to know

  • how “good” a segmentation algorithms is and/or

  • how “variable” segmentations (from humans or computers are)

  How can we know if

  these results are the

  same?

  Human

  annotation Algorithm result

  (“ground truth”)

  Robert Haase

  @haesleinhuepf

  21

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide22.png: 'Why do results vary?

  Potential reasons of same workflows delivering different

  results:

  • Image data type (8/16/32-bit float/int)

  • Workflow implementation

  • How histograms are determined

  • How the threshold is determined from the histogram

  • Compute architecture (CPU, GPU, TPU, …)

  Lecture in 2

  • Hardware vendor

  weeks

  • Software / driver versions

  Robert Haase

  https://forum.image.sc/t/otsus-threshold-method-delivers-

  @haesleinhuepf

  22

  BIDS Lecture5/14 different-results-in-scikit-image-and-imagej/24655 2

  April 30th 2024

  2'
downloads/12623730_05_Surface_Recon_QA_slide23.png: 'Visual comparison

  • The order in label images may be different. To compare them visually, we need
  to turn them into

  binary images first.

  Robert Haase

  https://haesleinhuepf.github.io/BioImageAnalysisNoteb

  @haesleinhuepf

  23

  BIDS Lecture5/14 ooks/29_algorithm_validation/visual_comparison.html

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide24.png: 'Quiz

  • How many pixels n in these two images are different?

  n=0 0<n<100 100<n<1000 n>1000

  Robert Haase

  @haesleinhuepf

  24

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide25.png: 'Visual comparison

  • Binary image comparison: difference or XOR

  Number of different pixels:

  • Does not work well if labels

  are close-by

  Robert Haase

  @haesleinhuepf

  25

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide26.png: 'Quantitative comparison

  • Voxel-wise Youden-Index • Contour distance • Volume standard deviation

  • Volume error

  • Classification error

  • Dice Index • Hausdorff distance

  • Hamming distance

  • Jaccard Index

  • Simplified Hausdorff distance

  Robert Haase

  @haesleinhuepf

  26

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide27.png: 'Choosing the right metric is
  key

  • Systematic overview by Maier-Hein, Reinke at al.

  Robert Haase Maier-Hein, Reinke et al. Arxiv (2023)

  @haesleinhuepf

  licensed CC-BY 4.0 https://arxiv.org/pdf/2206.01653.pdf 27

  BIDS Lecture5/14 2

  April 30th 2024 https://www.nature.com/articles/s41592-023-02151-z

  7'
downloads/12623730_05_Surface_Recon_QA_slide28.png: 'Choosing the right metric is
  key

  Robert Haase

  Source: Cropped from Ext. Data Fig 1 in Maier-Hein, Reinke, et

  @haesleinhuepf

  28

  BIDS Lecture5/14 al. licensed CC-BY 4.0 https://arxiv.org/pdf/2206.01653.pdf

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide29.png: 'Choosing the right metric is
  key

  Robert Haase

  Source: Cropped from Ext. Data Fig 1 in Maier-Hein, Reinke, et

  @haesleinhuepf

  29

  BIDS Lecture5/14 al. licensed CC-BY 4.0 https://arxiv.org/pdf/2206.01653.pdf

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide30.png: 'Choosing the right metric is
  key

  • Define your question

  Robert Haase

  Source: Cropped from Fig 4 in Maier-Hein, Reinke, et al.

  @haesleinhuepf

  30

  BIDS Lecture5/14 licensed CC-BY 4.0 https://arxiv.org/pdf/2206.01653.pdf 3

  April 30th 2024

  0'
downloads/12623730_05_Surface_Recon_QA_slide31.png: 'Overlap metrics

  • Consider pitfalls and

  limitations

  (From Figure 56)

  Robert Haase

  Modified (cropped for space reasons)

  @haesleinhuepf

  31

  BIDS Lecture5/14 from Maier-Hein, Reinke et al. Arxiv (2023) 3

  April 30th 2024 licensed CC-BY 4.0 https://arxiv.org/pdf/2206.01653.pdf

  1'
downloads/12623730_05_Surface_Recon_QA_slide32.png: 'Segmentation quality estimation

  • In general

  • Define what’s positive

  and what’s negative.

  Negative Positive

  Robert Haase

  @haesleinhuepf

  32

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide33.png: 'Segmentation quality estimation

  • In general

  • Define what’s positive

  and what’s negative.

  Negative Positive

  Robert Haase

  @haesleinhuepf

  33

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide34.png: 'Segmentation quality estimation

  • In general

  • Define what’s positive

  and what’s negative.

  What an

  algorithm

  What an algorithm

  suggests

  suggests to be positive

  to be

  negative

  Robert Haase

  @haesleinhuepf

  34

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide35.png: 'Segmentation quality estimation

  • In general A Prediction A

  • Define what’s positive Reference B

  B

  and what’s negative. (ground truth)

  • Compare with a ROI Region of interest

  FP TP FN

  reference to figure out

  what was true and false TP True-positive

  FN False-negative

  • Welcome to the

  TN

  Theory of Sets FP False-positive

  TN True-negative

  Robert Haase

  @haesleinhuepf

  35

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide36.png: 'Dice versus Jaccard Index (IoU)

  Robert Haase

  @haesleinhuepf Source: Cropped from Ext. Data Fig SN 3.5 and 3.9 in Maier-Hein,
  Reinke,

  36

  BIDS Lecture5/14

  et al. licensed CC-BY 4.0 https://arxiv.org/pdf/2206.01653.pdf

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide37.png: 'Dice versus Jaccard Index (IoU)

  Robert Haase

  @haesleinhuepf Source: Cropped from Ext. Data Fig SN 2.18 in Maier-Hein, Reinke,
  et al.

  37

  BIDS Lecture5/14

  licensed CC-BY 4.0 https://arxiv.org/pdf/2206.01653.pdf

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide38.png: 'Sparse Jaccard Index

  • For every annotated object, we compute the maximum IoU with any

  segmented object.

  • We average this value over all annotated objects

  Sparse IoU = 0.35 IoU = 0.66 IoU = 0.69

  instance annotation

  Instance segmentation candidates

  Robert Haase

  Source: https://github.com/haesleinhuepf/napari-

  @haesleinhuepf

  38

  BIDS Lecture5/14 workflow-optimizer

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide39.png: 'Pixel-wise versus Object-wise
  evaluation

  • Pixel wise: Segmentation quality

  Prediction Ground truth

  FN FN FN

  FP TP TP FN

  FP TP FN

  FP TP TP FN

  True-positive: 4

  False-negative: 5 IoU = 4 / 11

  False-positive: 2

  Robert Haase

  @haesleinhuepf

  39

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide40.png: 'Accuracy versus Jaccard Index
  (IoU)

  • Side-effects of image size and number of nuclei

  Nuclei Reference Segmentation result

  Accuracy: 0.97

  Jaccard Index: 0.73

  Accuracy decreases because

  there are less correct black

  pixels (TN)

  Accuracy: 0.95

  Jaccard Index: 0.73

  Robert Haase

  https://haesleinhuepf.github.io/BioImageAnalysisNotebooks/29_algorithm

  @haesleinhuepf

  _validation/jaccard_index_versus_accuracy.html 40

  BIDS Lecture5/14 4

  April 30th 2024

  0'
downloads/12623730_05_Surface_Recon_QA_slide41.png: 'Choosing the right metric is
  key

  • Define your question

  Robert Haase

  Source: Cropped from Fig 4 in Maier-Hein, Reinke, et al.

  @haesleinhuepf

  41

  BIDS Lecture5/14 licensed CC-BY 4.0 https://arxiv.org/pdf/2206.01653.pdf 4

  April 30th 2024

  1'
downloads/12623730_05_Surface_Recon_QA_slide42.png: 'Pixel-wise versus Object-wise
  evaluation

  • Are these objects overlapping?

  FN FN FN FN FN FN FN FN FN

  FN FN FN FN FN FN FN FN FN

  FP TP FN FN FP TP FN FP TP TP FN

  FP FP TP FN FP TP FN FP TP TP FN

  IoU = 1 / 7 IoU = 1 / 3 IoU = 1 / 2

  Robert Haase

  @haesleinhuepf

  42

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide43.png: 'Pixel-wise versus Object-wise
  evaluation

  • Object wise: Detection quality

  Prediction Ground truth

  FP TP FN

  True-positive: 3

  False-negative: 1 IoU = 1 / 2

  False-positive: 2

  Robert Haase

  @haesleinhuepf

  43

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide44.png: 'Pixel-wise versus Object-wise
  evaluation

  • Play with metrics to gain understanding

  With Martin Schätz (Charles Uni,

  Prague)

  @schatzcz

  Robert Haase

  @haesleinhuepf https://github.com/haesleinhuepf/the-segmentation-game

  44

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide45.png: '• Special case: We elaborate
  segmentation quality of one / large

  object:

  Robert Haase

  Source: Cropped from Fig 5 in Maier-Hein, Reinke, et al.

  @haesleinhuepf

  45

  BIDS Lecture5/14 licensed CC-BY 4.0 https://arxiv.org/pdf/2206.01653.pdf

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide46.png: 'What metric to use when?

  • “Metrics reloaded: Pitfalls and recommendations for image analysis validation”

  Maier-Hein, Reinke et al. https://arxiv.org/abs/2206.01653

  Robert Haase

  @haesleinhuepf

  46

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide47.png: 'Further reading

  Robert Haase

  https://focalplane.biologists.com/2023/04/13/quality-

  @haesleinhuepf

  47

  BIDS Lecture5/14 assurance-of-segmentation-results/

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide48.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Feature extraction

  Robert Haase

  Using materials from Johannes Soltwedel, PoL, TU Dresden

  Robert Haase

  @haesleinhuepf

  48

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide49.png: 'Lecture overview: Bio-image Analysis

  • Image Data Analysis workflows

  • Goal: Quantify observations, substantiate conclusions with

  numbers

  Plotting

  Image filtering Image segmentation Feature extraction Object classification

  Robert Haase

  @haesleinhuepf

  49

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide50.png: 'Feature extraction

  • Feature extraction is a late processing step in image analysis.

  • It can be used for images or

  Feature

  Extraction

  • or segmented/labelled images

  Acquisition Denoising Background subtraction Segmentation Labeling Feature Extraction

  Robert Haase

  @haesleinhuepf

  Image data source: Daniela Vorkel, Myers lab, MPI CBG 50

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide51.png: 'Feature extraction

  • A feature is a countable or measurable property of an image or object.

  • Goal of feature extraction is finding a minimal set of features to describe an
  object well enough to

  differentiate it from other objects.

  • Intensity based • Shape based /spatial • Spatio-temporal • Topological

  • Mean intensity • Area / Volume • Displacement, • Number of neighbors

  • Standard deviation • Roundness • Speed,

  • Total intensity • Solidity • Acceleration

  • Textures • Circularity / Sphericity

  • Others

  • Elongation

  • Overlap

  • Centroid

  • Colocalization

  • Bounding box

  • Mixed features

  • Center of mass

  • Local minima / maxima

  • Distance to neighbors

  • Average intensity in neighborhood

  Robert Haase

  @haesleinhuepf

  51

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide52.png: 'Intensity based features

  • Min / max

  • Median

  • Mean

  • Mode

  • Variance

  • Standard deviation

  • Can be derived from pixel

  values

  • Don’t take spatial relationship

  of pixels into account

  • See also:

  • descriptive statistics

  • histogram

  Robert Haase

  @haesleinhuepf

  52

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide53.png: 'Bounding rectangle / bounding
  box

  • Position and size of the smallest rectangle containing all

  0 1 2 3 4 x

  pixels of an object

  • x , y … position of the bounding box

  b b

  0 0 0 0 0 0

  • w … width of the bounding box

  b

  • h … height of the bounding box

  b

  1 0 0 0 0 0

  2 1 1 1 0 0

  variable value

  x 0

  b 3 0 1 1 0 0

  y 2

  b

  w 3 4 0 0 0 0 0

  b

  h 2 y

  b

  Robert Haase

  @haesleinhuepf

  53

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide54.png: 'Center of mass

  • Relative position in an image weighted by pixel intensities

  0 1 2 3 4 x

  • x, y … pixel coordinates

  • w … image width 0 0 0 0 0 0

  • h … image height

  • µ … mean intensity

  • g … pixel grey value 1 0 0 0 0 0

  x,y

  • x , y … center of mass coordinates

  m m

  2 1 1 2 0 0

  ℎ−1𝑤−1

  1

  𝜇 = ෍ ෍ 𝑔

  𝑥,𝑦

  𝑤ℎ

  𝑦=0 𝑥=0 3 0 2 1 0 0

  ℎ−1𝑤−1

  1

  𝑥 = ෍ ෍ 𝑥 𝑔 4 0 0 0 0 0

  𝑚 𝑥,𝑦

  𝑤ℎ𝜇

  𝑦=0 𝑥=0

  y

  ℎ−1 𝑤−1

  1 x = 1/7 (1·0 + 1·1 + 2·2 + 2·1 + 1·2) = 1.3

  𝑦 = ෍ ෍ 𝑦 𝑔 m

  “sum intensity”

  𝑚 𝑥,𝑦

  𝑤ℎ𝜇

  “total intensity” 𝑦=0 𝑥=0 y = 1/7 (1·2 + 1·2 + 2·3 + 2·2 + 1·3) = 2.4

  m

  Robert Haase

  @haesleinhuepf

  54

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide55.png: 'Center of geometry / centroid

  • Relative position in an image weighted by pixel intensities

  0 1 2 3 4 x

  • Special case of center of mass for binary images

  • x, y … pixel coordinates

  • w … image width 0 0 0 0 0 0

  • h … image height

  • µ … mean intensity

  • g … pixel grey value, integer in range [0;1] 1 0 0 0 0 0

  x,y

  • x , y … center of mass coordinates

  m m

  2 1 1 1 0 0

  ℎ−1𝑤−1

  1

  𝜇 = ෍ ෍ 𝑔

  𝑥,𝑦

  𝑤ℎ

  𝑦=0 𝑥=0 3 0 1 1 0 0

  ℎ−1𝑤−1

  1

  𝑥 = ෍ ෍ 𝑥 𝑔 4 0 0 0 0 0

  𝑚 𝑥,𝑦

  𝑤ℎ𝜇

  𝑦=0 𝑥=0

  y

  ℎ−1 𝑤−1

  1 x = 1/5 (1·0 + 1·1 + 1·2 + 1·1 + 1·2) = 1.2

  𝑦 = ෍ ෍ 𝑦 𝑔 m

  𝑚 𝑥,𝑦

  𝑤ℎ𝜇

  Number of white pixels 𝑦=0 𝑥=0 y = 1/5 (1·2 + 1·2 + 1·3 + 1·2 + 1·3) = 2.4

  m

  Robert Haase

  @haesleinhuepf

  55

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide56.png: 'Perimeter

  • Length of the outline around an object

  • Depends on the actual implementation

  0 1 2 3 4 x 0 1 2 3 4 x

  0 0 0 0 0 0 0 0 0 0 0 0

  1 0 0 0 0 0 1 0 0 0 0 0

  2 1 1 1 0 0 2 1 1 1 0 0

  3 0 1 1 0 0 3 0 1 1 0 0

  4 0 0 0 0 0 4 0 0 0 0 0

  y y

  Robert Haase

  @haesleinhuepf

  56

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide57.png: 'Feret’s diameter

  Caliper

  • Feret’s diameter describes the

  maximum distance between any

  two points of an outline.

  • The minimum caliper (“Minimum

  Feret”) describes the shortest

  distance, the object would fit

  through.

  • Feret and Minimum Feret do not

  need to be perpendicular to each

  other!

  Robert Haase

  https://en.wikipedia.org/wiki/Feret_diameter#/media/

  @haesleinhuepf

  57

  BIDS Lecture5/14

  File:DigitalCaliperEuro.jpg Image license: Public domain

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide58.png: 'Feret’s diameter

  • Feret’s diameter (L.R. Feret, 1931) is often cited, but impossible to read

  online …

  • The term “Feret’s Diameter” was

  established in the 1970s

  Robert Haase https://search.worldcat.org/de/title/grosseur-des-

  @haesleinhuepf

  58

  BIDS Lecture5/14 grains-des-matieres-pulverulentes/oclc/254880803

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide59.png: 'Minor / major axis

  • For every object, find the optimal ellipse simplifying the object.

  • Major axis … long diameter

  • Minor axis … short diameter

  • Major and minor

  axis are perpendicular

  to each other

  Fit

  ellipse

  Robert Haase

  @haesleinhuepf

  59

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide60.png: 'Aspect ratio

  • The aspect ratio describes the elongation of an object.

  AR = major / minor

  3

  2

  1.5

  1

  1.5

  2

  3

  Robert Haase

  @haesleinhuepf

  60

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide61.png: 'Convex hull

  • By removing all concave corners of an object, we retrieve its convex hull.

  Robert Haase

  @haesleinhuepf

  61

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide62.png: 'Convex hull

  • By removing all concave corners of an object, we retrieve its convex hull.

  Robert Haase

  @haesleinhuepf

  62

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide63.png: 'Convex hull

  • By removing all concave corners of an object, we retrieve its convex hull.

  Robert Haase

  @haesleinhuepf

  63

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide64.png: 'Convex hull

  • By removing all concave corners of an object, we retrieve its convex hull.

  𝐴

  𝑠𝑜𝑙𝑖𝑑𝑖𝑡𝑦 =

  𝐴

  𝑐𝑜𝑛𝑣𝑒𝑥𝐻𝑢𝑙𝑙

  Robert Haase

  @haesleinhuepf

  64

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide65.png: 'Roundness and circularity

  Diameter 𝑑

  • The definition of a circle leads us to

  measurements of circularity and

  roundness. Circumference C = 𝜋𝑑

  • In case you use these measures,

  𝜋𝑑2

  define them correctly. They are not Area

  𝐴 =

  4

  standardized!

  4 ∗ 𝐴

  𝑟𝑜𝑢𝑛𝑑𝑛𝑒𝑠𝑠 =

  𝜋 𝑚𝑎𝑗𝑜𝑟2

  Roundness = 1 Roundness ≈ 1 Roundness < 1

  Circularity = 1 Circularity ≈ 1 Circularity < 1

  4𝜋 ∗ 𝐴

  𝑐𝑖𝑟𝑐𝑢𝑙𝑎𝑟𝑖𝑡𝑦 =

  𝑝𝑒𝑟𝑖𝑚𝑒𝑡𝑒𝑟2

  Robert Haase

  @haesleinhuepf

  65

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide66.png: 'Roundness and circularity

  𝑟𝑜𝑢𝑛𝑑𝑛𝑒𝑠𝑠 =

  4 ∗ 𝐴

  𝜋 𝑚𝑎𝑗𝑜𝑟2

  𝑐𝑖𝑟𝑐𝑢𝑙𝑎𝑟𝑖𝑡𝑦=

  4𝜋 ∗ 𝐴

  𝑝𝑒𝑟𝑖𝑚𝑒𝑡𝑒𝑟2

  𝑠𝑜𝑙𝑖𝑑𝑖𝑡𝑦=

  𝐴

  𝐴

  Robert Haase 𝑐𝑜𝑛𝑣𝑒𝑥𝐻𝑢𝑙𝑙

  @haesleinhuepf

  66

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide67.png: 'Feature extraction in Python

  • In Python:

  https://scikit-image.org/docs/stable/api/skimage.measure.html

  Robert Haase

  @haesleinhuepf

  67

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide68.png: 'Feature extraction in Python

  • The transition from image data to tabular data / pandas DataFrames

  Robert Haase

  @haesleinhuepf

  68

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide69.png: 'Parametric images

  • The way back: Visualizing quantitative measurements

  Label image Pixel count image Aspect ratio image

  Robert Haase

  @haesleinhuepf

  69

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide70.png: 'Exploring features in Napari

  • Double-click on

  table column to

  retrieve a

  parametric map

  image

  Robert Haase

  @haesleinhuephf ttps://www.napari-hub.org/plugins/napari-skimage-regionprops

  70

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide71.png: 'Exploring neighborhood relationships
  between cells

  • Study how many neighbours objects have.

  • How likely is it that an object with 3 neighbors is a cell?

  Robert Haase

  The example image maize_clsm.tif was shared by

  @haesleinhuepf

  71

  BIDS Lecture5/14 David Legland and is licensed under CC-BY 4.0 license.

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide72.png: 'Neighborhood-based label filters

  • Filter out objects which have an unreasonable number of neighbors

  neighbor count objects cells

  Robert Haase

  @haesleinhuepf

  72

  BIDS Lecture5/14

  April 30th 2024 The example imagemaize_clsm.tifwas shared by David Legland and is
  licensed underCC-BY 4.0 license.'
downloads/12623730_05_Surface_Recon_QA_slide73.png: 'Neighborhood-based label filters

  • Filter labeled objects using Measure Labels and Label Filters in Napari.

  Objects

  Number of

  Cells

  neighbors

  Robert Haase

  @haesleinhuepf

  73

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide74.png: 'SimpleITK

  • Recommended for 3D-measurements, based on the SimpleITK-project

  Robert Haase

  @haesleinhuepf https://simpleitk.readthedocs.io/en/master/

  75

  BIDS Lecture5/14 7

  https://github.com/haesleinhuepf/napari-simpleitk-image-processing

  April 30th 2024

  5'
downloads/12623730_05_Surface_Recon_QA_slide75.png: 'SimpleITK

  • Many Napari plugins for feature extraction can also be called from Python

  Robert Haase

  @haesleinhuepf

  76

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide76.png: 'Exploring features in Napari

  • Select table rows

  and view

  corresponding

  object in 2D/3D

  space

  Robert Haase

  @haesleinhuephf ttps://www.napari-hub.org/plugins/napari-skimage-regionprops

  77

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide77.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Complex exercise

  Robert Haase

  Robert Haase

  @haesleinhuepf

  78

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide78.png: 'Complex exercise

  • Scenario: Imagine a biologist sent you some data (images +

  corresponding label image). They ask you to write an image-

  analysis workflow for processing these images + more images of

  similar kind.

  • You will receive a link to data in-person

  • You can return the link and exchange it with another link 2 times.

  • Scientific tasks

  • Develop an image-segmentation workflow, which produces

  label images

  • Extract features from these images

  • Visualize relationships between these features

  • Find out which features are strongly correlated and which not.

  Robert Haase

  @haesleinhuepf

  79

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide79.png: 'Complex exercise

  • Engineering tasks

  • Setup a software environment

  • Setup an image processing workflow

  Act as if you would

  • Setup a data analysis / visualization workflow

  communicate with a

  • Setup a quality assurance procedure

  biologist, with limited

  • Documentation tasks image-analysis, conda

  • Installation instructions and programming

  skills.

  • User guide

  • Documentation of used data

  • Explanation of the used algorithms

  Robert Haase

  @haesleinhuepf

  80

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide80.png: 'Complex exercise

  • Submission

  • Submit a password-protected ZIP file to robert.haase@uni-leipzig.de (Why

  password protected: The virus scanner cannot reject python files in encrypted

  zip-files)

  • Allowed file formats: ipynb, py, docx, pdf, md, csv, yml, json, xml, txt

  • Deadline: June 24th 2024

  • Hint

  • Send this ZIP file to a friend and ask them to run the analysis. If they can follow

  your instructions successfully, without communicating with you, proceed to

  final submission.

  Robert Haase

  @haesleinhuepf

  81

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide81.png: 'Complex exercise

  • Checklist

  • The software environment is reproducible

  • The example data is available in the right directory (note: you cannot submit
  a

  500MB ZIP file via email) The image/data analysis code is executable

  • The code is well documented / commented

  • Segmentation results are visualized

  • Segmentation results are stored to disc as label images

  • The quality of the segmentation result is measured

  • Used algorithms are cited, and well explained

  • Extracted features / measurements are saved as CSV-file in a way that one can

  associate an entry in the CSV file with the corresponding segmented object

  • Resulting plots and visualizations have reasonable axis labels and are well explained

  • The copyright of re-used data and code are respected

  Robert Haase

  @haesleinhuepf

  82

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide82.png: 'Next week:

  • 15:15-16:30 Short lecture + short practicals (SG 312)

  • Afterwards:

  Robert Haase https://www.meetup.com/de-DE/big-data-and-ai-

  @haesleinhuepf

  83

  BIDS Lecture5/14 saxony/events/300284128/

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide83.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Exercises

  Robert Haase

  Robert Haase

  @haesleinhuepf

  84

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide84.png: 'Exercise: Surface meshes

  • Creating, storing, processing surface mesh data

  Robert Haase

  @haesleinhuepf

  85

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide85.png: 'Segmentation quality

  • Measure segmentation quality of a given algorithm applied to a folder of images.

  Robert Haase

  @haesleinhuepf

  86

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide86.png: 'Exercise: Parametric maps

  • Produce a parametric map representing ‘elongation’ in Napari.

  • Reproduce the same map using Python

  Robert Haase

  @haesleinhuepf

  87

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_05_Surface_Recon_QA_slide87.png: 'Exercise: Quantitative measurements

  • Use the given feature extraction notebook to apply some basic statistics to measurements

  Robert Haase

  @haesleinhuepf

  88

  BIDS Lecture5/14

  April 30th 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide1.png: 'CENTER FOR SCALABLE
  DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Supervised and Unsupervised

  Machine Learning for Bio-image Analysis

  Robert Haase

  Reusing materials from Johannes Soltwedel, Till Korten, Johannes Müller, Laura Žigutytė

  (TU Dresden), Ryan Savill (MPI-CBG), Matthias Täschner (ScaDS.AI/Uni Leipzig) and
  the

  Scikit-learn community.

  Robert Haase

  @haesleinhuepf These slides and the related training materials can be reused

  Slide 1

  BIDS Lecture8/14 under the terms of the CC-BY 4.0license.

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide2.png: 'Follow-up: cupy

  cupy was hard to make work. Consider using a GPU-runtime in Google Colab

  Install

  packages

  Select

  GPU

  runtime

  Robert Haase

  @haesleinhuepf

  https://colab.research.google.com/github/ScaDS/BIDS-lecture- Slide 2

  BIDS Lecture 8/14

  2024/blob/main/07a_gpu_acceleration/20_cupy_dropin_replacement.ipynb

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide3.png: 'Follow-up: cupy

  cupy was hard to make work. Consider using a GPU-kernel in Google Colab

  Modify URLs

  Cupy installed

  per default

  Robert Haase

  @haesleinhuepf

  Slide 3

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide4.png: 'Quiz: Recap

  What kind of label image

  is this?

  Sparse Sparse

  Instance Semantic instance semantic

  segmentation segmentation segmentation segmentation

  Robert Haase

  @haesleinhuepf

  Slide 4

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide5.png: 'Terminology

  Instance segmentation Semantic segmentation

  Regions:

  Instances:

  • Anatomical, geographical

  • Cells, nuclei, cats, dogs,

  • All pixels belonging to the same type

  cars, trees

  of object have the same value

  Robert Haase

  @haesleinhuepf Source: Allen Mouse Brain Atlas [dataset]. Available frommouse.brain-map.org.

  Slide 5

  BIDS Lecture 8/14 Allen Institute for Brain Science (2011).

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide6.png: 'Terminology

  Instance Semantic

  segmentation segmentation

  Annotations are typically drawn by humans (e.g. to train

  machine learning models)

  Sparse

  Sparse

  semantic

  instance

  annotation

  annotation

  Robert Haase

  @haesleinhuepf

  Slide 6

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide7.png: 'Image segmentation using
  thresholding

  Recap: Finding the right workflow towards a good segmentation takes time

  Robert Haase

  @haesleinhuepf

  Slide 7

  BIDS Lecture 8/14 Image data source: BBBC038v1, available from the Broad Bioimage

  May 21st 2024

  Benchmark Collection (Caicedoet al., Nature Methods, 2019].'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide8.png: 'Image segmentation using
  thresholding

  Recap: Combining images, e.g. using Difference of Gaussian (DoG)

  Robert Haase

  @haesleinhuepf

  Slide 8

  BIDS Lecture 8/14 Image data source: BBBC038v1, available from the Broad Bioimage

  May 21st 2024

  Benchmark Collection (Caicedoet al., Nature Methods, 2019].'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide9.png: 'Image segmentation using
  thresholding

  Might there be a technology for optimization which combination of images can be
  used to

  get the best segmentation result?

  ?

  Robert Haase

  @haesleinhuepf

  Slide 9

  BIDS Lecture 8/14 Image data source: BBBC038v1, available from the Broad Bioimage

  May 21st 2024

  Benchmark Collection (Caicedoet al., Nature Methods, 2019].'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide10.png: 'Machine learning

  Finds more and more applications, also in life sciences.

  Trainable Weka Segmentation

  https://imagej.net/plugins/tws/

  Artificial

  intelligence

  LabKit

  https://imagej.net/

  Machine learning

  plugins/labkit/

  Deep

  Python / scikit-learn /

  Learning

  napari / apoc

  Robert Haase

  @haesleinhuepf Image data source: BBBC038v1, available from the Broad Bioimage

  Slide 10

  BIDS Lecture 8/14 Benchmark Collection (Caicedoet al., Nature Methods, 2019].

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide11.png: 'Machine learning

  A research field in computer science

  Finds more and more applications, also in life sciences.

  Artificial

  intelligence

  Machine learning

  www.cellpose.org/

  Deep

  Learning

  https://github.com/stardist/stardist https://bioimage.io/

  Robert Haase

  @haesleinhuepf Logos and screenshots are taken from the github repositories /

  Slide 11

  BIDS Lecture 8/14 websites provided under BSD and MIT licenses.

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide12.png: 'Machine learning

  Automatic construction of predictive models from given data

  Pixels, Objects, Images,Audio, Text, Measurements, …

  Annotated

  raw data,

  usually

  Training

  Raw data Ground truth

  generated by

  Dense humans

  Segmentation Object Image

  P

  / Binarization classification classification r

  e

  d Model

  i

  c

  t

  i

  “Cat” o

  n

  Instance segmentation Cont. quantity Precision,

  Classification

  Quality Recall

  P = 0.5

  Cat / regression

  P = 0.4

  Microscope

  Height = 80

  cm

  Robert Haase

  @haesleinhuepf

  Slide 12

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide13.png: 'Goal

  Guess classification (color) from position of a sample in parameter space.

  Robert Haase

  @haesleinhuepf

  Adapted from https://scikit-learn.org/stable/auto_Selixdaem 13ples/classification/plot_classifier_comparison.html

  BIDS Lecture 8/14

  © 2007 -2019, scikit-learn developers (BSD License).

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide14.png: 'Approaches

  The right approach depends on data, computational resources and desired quality

  Adapted from https://scikit-

  Robert Haase

  @haesleinhuepf learn.org/stable/auto_examples/classification/plot_c

  Slide 14

  BIDS Lecture 8/14 lassifier_comparison.html

  May 21st 2024

  © 2007 -2019, scikit-learn developers (BSD License).'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide15.png: 'Machine learning for
  image segmentation

  Supervised machine learning: We give the computer some ground truth to learn from

  The computer derives a model or a classifier which can judge if a pixel should be

  foreground (white) or background (black)

  Example: Binary classifier

  Training

  ?

  Model /

  classifier

  Raw image Binary image

  Robert Haase

  @haesleinhuepf

  Slide 15

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide16.png: 'Random forest based
  image segmentation

  Decision trees are classifiers, they decide if a pixel should be white or black

  Random decision trees are randomly initialized, afterwards evaluated and selected

  Random forests consist of many random decision trees

  Example: Random forest of binary decision trees

  No Ye

  s

  No Ye No Ye

  s s

  No Ye No Ye No Ye

  s s s

  No Ye No Ye No Ye No Ye

  Robert Haase

  @haesleinhues pf s s s

  Slide 16

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide17.png: 'Deriving random decision
  trees

  For efficient processing, we randomly sample our data set

  • Individual pixels, their intensity and their classification

  Threshold

  2

  X

  X

  1

  Note: You cannot use a single threshold to make the decision

  correctly

  Robert Haase

  @haesleinhuepf

  Slide 17

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide18.png: 'Deriving random decision
  trees

  Decision trees combine several thresholds on several parameters

  2

  X

  X <

  2

  0.8

  No Yes

  X >

  1

  X 0.6

  No Yes

  1

  Robert Haase

  @haesleinhuepf

  Slide 18

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide19.png: 'Deriving random decision
  trees

  Depending on sampling, the decision

  trees are different

  X >

  1

  0.4

  No Yes

  2

  X

  X <

  2

  0.7

  No Yes

  X <

  2

  X 0.3

  No Yes

  1

  Robert Haase

  @haesleinhuepf

  Slide 19

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide20.png: '.]9

  1

  0

  2

  ,s

  Random Forest Pixel Classifiers d

  o

  h

  t

  e

  M

  e

  r

  u

  t

  a

  N

  By training many decision trees, errors are equilibrated

  ,.la

  t

  e

  o

  d

  e

  c

  ia

  C

  (

  n

  o

  it

  c

  e

  llo

  C

  k

  r

  a

  m

  h

  c

  n

  e

  B

  e

  g

  a

  m

  io

  iB

  d

  a

  o

  r

  B

  e

  h

  t

  m

  o

  r

  f

  e

  lb

  a

  lia

  v

  a

  1 ,

  v

  8

  3

  0

  C

  B

  B

  B

  :e

  c

  r

  u

  o

  s

  Robert Haase

  a

  @haesleinhuepf Sampling t a

  Slide 20 d

  BIDS Lecture 8/14 e

  g

  May 21st 2024 a

  m

  I'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide21.png: 'Random Forest Pixel
  Classifiers

  Combination of individual tree decisions by voting or max / mean

  Prediction

  Majority

  Robert Haase

  @haesleinhuepf

  Slide 21

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide22.png: 'Random Forest Pixel
  Classifiers

  Typical numbers for pixel classifiers in microscopy

  Available features:

  • Gaussian blur

  image

  • DoG image

  Depth: 4

  • LoG image

  • Hessian

  • ….

  Number of trees: > 100

  Robert Haase

  @haesleinhuepf

  Slide 22

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide23.png: '.]9

  1

  0

  2

  ,s

  Model validation d

  o

  h

  t

  e

  M

  e

  r

  u

  In order to assess model quality, we split the ground truth into two set t

  a

  N

  • Training set (50%-90% of the available data)

  ,.la

  t

  e

  o

  d

  • Test set (10%-50% of the available data) e

  c

  ia

  Typically done with hundreds C

  (

  n

  o

  or thousands of cells / images it

  c

  t e

  e / objects / ... llo

  s C

  k

  r

  g Classifier a

  m

  n

  h

  i n Training Ability to c n e

  i B

  a e

  r abstract g a

  T m

  io

  iB

  d

  Ground truth Prediction a

  o

  r

  B

  e

  h

  t

  m

  o

  r

  t

  e

  f

  e lb

  a

  s lia

  Prediction v

  t a

  s 1 ,

  e v

  8

  T 3

  0

  C

  B

  B

  B

  Raw data Prediction Ground truth :e

  c

  r

  u

  o

  s

  Robert Haase

  a

  t

  @haesleinhuepf a

  Slide 23 d

  BIDS Lecture 8/14 e

  g

  May 21st 2024 a

  m

  I'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide24.png: 'Object classification

  What if we exchange pixel features with object features?

  Pixel classification Object classification

  l

  e

  b e

  o g

  y

  S a t

  m i

  n r

  a

  i i

  l

  y d u

  t e c

  i

  s r r

  n e i C

  e t

  l

  t i f

  n

  I

  Intensity in raw image Aspect ratio

  • The algorithms work the same

  using with different features

  Robert Haase

  @haesleinhuepf

  Slide 24

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide25.png: 'CENTER FOR SCALABLE
  DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Using

  Python Funded by

  Supervised and Unsupervised

  Machine Learning for Bio-image Analysis

  Robert Haase

  Reusing materials from Johannes Soltwedel, Till Korten, Johannes Müller, Laura Žigutytė

  (TU Dresden), Ryan Savill (MPI-CBG), Matthias Täschner (ScaDS.AI/Uni Leipzig) and
  the

  Scikit-learn community.

  Robert Haase

  @haesleinhuepf These slides and the related training materials can be reused

  Slide 25

  BIDS Lecture 8/14 under the terms of the CC-BY 4.0license.

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide26.png: 'Tabular object classification

  Classify objects starting from feature vectors (table columns)

  Raw data “Ground truth” Classifier training

  annotation

  Classifier prediction

  Robert Haase

  @haesleinhuepf

  Slide 26

  BIDS Lecture 8/14

  May 21st 2024 https://github.com/BiAPoL/Bio-

  image_Analysis_with_Python/blob/main/09_machine_learning/01_supervised_machine_learning.ipynb'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide27.png: 'Interactive pixel classification

  Prepare an empty layer for annotations and keep a reference

  labels = viewer.add_labels(

  np.zeros(image.shape).astype(int))

  e

  g

  Read annotations a m

  io iB.]9

  1

  manual_annotations = labels.data

  2

  d a

  o rB

  e h

  t

  m0 2

  ,s d

  o

  h te

  M

  o e

  rf

  e

  lbru

  ta

  N

  from skimage.io import imshow 1

  1a

  lia

  v a

  ,o

  ,.la

  te

  imshow(manua vl m_ ia nn =n 0o ,t a vt mi ao xn =s 2,

  )

  :e

  c ru

  o s

  av ta8 3 0 C B B B( n

  o

  itc

  e llo

  C

  k

  rad e c ia C

  dm

  eh

  gc

  an

  me

  IB

  Robert Haase

  @haesleinhuepf

  Slide 27

  BIDS Lecture 8/14 27

  May 21st 2h0t2t4ps://github.com/BiAPoL/Bio-

  image_Analysis_with_Python/blob/main/09_machine_learning/02_scikit_learn_random_forest_pixel_classifier.ipynb'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide28.png: 'Napari – common workflows
  [1: Create empty labels layer]

  2: Select paint brush tool

  3: Decreaese brush size

  Pixel / object annotation drawing 4: Increase label

  2

  4

  3

  1

  Robert Haase

  @haesleinhuepf

  Slide 28

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide29.png: 'Interactive pixel classification

  Pixel classification using scikit-learn

  • Expects one-dimensional arrays for features

  and ground truth

  # for training, we need to generate features

  feature_stack = generate_feature_stack(image)

  X, y = format_data(feature_stack, manual_annotations)

  # train classifier

  from sklearn.ensemble import RandomForestClassifier

  Image data

  classifier = RandomForestClassifier(max_depth=2, random_state=0)

  classifier.fit(X, y)

  y_ = classifier.predict(X)

  Ground truth /

  Image data

  annotation

  prediction

  Robert Haase

  @haesleinhuepf

  Slide 29

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide30.png: '.]9

  1

  0

  2

  ,s

  Interactive pixel classification d

  o

  h

  t

  e

  M

  e

  r

  u

  t

  a

  Pixel classification using scikit-learn N

  ,.la

  t

  • Expects one-dimensional arrays for features e

  o

  d

  e

  c

  and ground truth ia

  C

  (

  n

  o

  it

  c

  e

  llo

  C

  k

  # for training, we need to generate features r a

  m

  h

  c

  n

  feature_stack = generate_feature_stack(image) e

  B

  e

  g

  a

  X, y = format_data(feature_stack, manual_annotations) m

  io

  iB

  d

  a

  o

  r

  B

  # train classifier e

  h

  t

  m

  o

  from sklearn.ensemble import RandomForestClassifier r

  f

  e

  lb

  a

  classifier = RandomForestClassifier(max_depth=2, random_state=0) lia

  v

  a

  1 ,

  classifier.fit(X, y) v

  8

  3

  0

  C

  B

  B

  B

  :e

  c

  r

  u

  o

  s

  Robert Haase

  a

  t

  @haesleinhuepf a

  Slide 30 d

  BIDS Lecture 8/14 30 e

  g

  May 21st 2024 a

  m

  I'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide31.png: '.]9

  1

  0

  2

  ,s

  Interactive pixel classification d

  o

  h

  t

  e

  M

  e

  r

  u

  t

  a

  Pixel classification using scikit-learn N

  ,.la

  t

  • Expects one-dimensional arrays for features e

  o

  d

  e

  c

  and ground truth ia

  C

  (

  n

  o

  it

  c

  e

  llo

  C

  k

  r

  a

  m

  h

  c

  n

  e

  B

  # process the whole image and show result e g

  a

  m

  io

  result_1d = classifier.predict(feature_stack.T) iB

  d

  a

  o

  r

  B

  result_2d = result_1d.reshape(image.shape)

  e

  h

  t

  m

  o

  r

  f

  e

  lb

  Convert 1D a

  viewer.add_labels(result_2d) lia

  v

  result back to 2D 1a

  ,

  v

  8

  3

  0

  C

  B

  B

  B

  :e

  c

  r

  u

  o

  s

  Robert Haase

  a

  t

  @haesleinhuepf a

  Slide 31 d

  BIDS Lecture 8/14 31 e

  g

  May 21st 2024 a

  m

  I'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide32.png: '.]9

  1

  0

  2

  ,s

  Interactive pixel classification d

  o

  h

  t

  e

  M

  e

  r

  u

  t

  a

  N

  Jupyter notebooks and napari side-by-side

  ,.la

  t

  e

  o

  d

  e

  c

  ia

  C

  (

  n

  o

  it

  c

  e

  llo

  C

  k

  r

  a

  m

  h

  c

  n

  e

  B

  e

  g

  a

  m

  io

  iB

  d

  a

  o

  r

  B

  e

  h

  t

  m

  o

  r

  f

  e

  lb

  a

  lia

  v

  a

  1 ,

  v

  8

  3

  0

  C

  B

  B

  B

  :e

  c

  r

  u

  o

  s

  Robert Haase

  a

  t

  @haesleinhuepf a

  Slide 32 d

  BIDS Lecture 8/14 e

  g

  May 21st 2024 a

  m

  I'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide33.png: '.]9

  1

  0

  2

  ,s

  Interactive pixel classification d

  o

  h

  t

  e

  M

  e

  r

  u

  t

  a

  N

  Jupyter notebooks and napari side-by-side

  ,.la

  t

  e

  o

  d

  e

  c

  ia

  C

  (

  n

  o

  it

  c

  e

  llo

  C

  k

  r

  a

  m

  h

  c

  n

  e

  B

  e

  g

  a

  m

  io

  iB

  d

  a

  o

  r

  B

  e

  h

  t

  m

  o

  r

  f

  e

  lb

  a

  lia

  v

  a

  1 ,

  v

  8

  3

  0

  C

  B

  B

  B

  :e

  c

  r

  u

  o

  s

  Robert Haase

  a

  t

  @haesleinhuepf a

  Slide 33 d

  BIDS Lecture 8/14 e

  g

  May 21st 2024 a

  m

  I'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide34.png: '.]9

  1

  0

  2

  ,s

  Interactive pixel classification d

  o

  h

  t

  e

  M

  e

  r

  u

  t

  a

  N

  Jupyter notebooks and napari side-by-side

  ,.la

  t

  e

  o

  d

  e

  c

  ia

  C

  (

  n

  o

  it

  c

  e

  llo

  C

  k

  r

  a

  m

  h

  c

  n

  e

  B

  e

  g

  a

  m

  io

  iB

  d

  a

  o

  r

  B

  e

  h

  t

  m

  o

  r

  f

  e

  lb

  a

  lia

  v

  a

  1 ,

  v

  8

  3

  0

  C

  B

  B

  B

  :e

  c

  r

  u

  o

  s

  Robert Haase

  a

  t

  @haesleinhuepf a

  Slide 34 d

  BIDS Lecture 8/14 e

  g

  May 21st 2024 a

  m

  I'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide35.png: 'GPU-

  accelerated

  CENTER FOR SCALABLE DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Using

  Python Funded by

  Supervised and Unsupervised

  Machine Learning for Bio-image Analysis

  Robert Haase

  Reusing materials from Johannes Soltwedel, Till Korten, Johannes Müller, Laura Žigutytė

  (TU Dresden), Ryan Savill (MPI-CBG), Matthias Täschner (ScaDS.AI/Uni Leipzig) and
  the

  Scikit-learn community.

  Robert Haase

  @haesleinhuepf These slides and the related training materials can be reused

  Slide 35

  BIDS Lecture 8/14 under the terms of the CC-BY 4.0license.

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide36.png: 'Accelerated pixel and
  object classification

  APOC is a python library that makes use of OpenCL-compatible Graphics Cards to

  accelerate pixel and object classification

  Raw image Object label Class label image

  image

  Pixel annotation Object annotation

  Robert Haase

  @haesleinhuepf

  Slide 36

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide37.png: 'Object segmentation

  Pixel classification + connected component labeling

  Raw image

  Object label image

  Object segmentation

  Pixel annotation

  Robert Haase

  @haesleinhuepf

  Slide 37

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide38.png: 'Training on folders
  of annotated images

  Robert Haase

  @haesleinhuepf

  Slide 38

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide39.png: 'Object classification

  Feature extraction + tabular classification

  Object label image

  Class label image

  Object classification

  Object annotation

  Robert Haase

  @haesleinhuepf

  Slide 39

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide40.png: 'Other classification
  / regression tasks

  Robert Haase

  https://github.com/haesleinhuepf/apoc/

  @haesleinhuepf

  Slide 40

  BIDS Lecture 8/14

  blob/main/demo/demo_apoc.ipynb

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide41.png: 'Quiz: Classification
  versus Regression

  Which of these

  three solves a

  regression task?

  Robert Haase

  @haesleinhuepf

  Slide 41

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide42.png: 'Under the hood: clesperanto
  / OpenCL

  classifier.cl files

  can be read

  Decision

  trees

  Robert Haase

  @haesleinhuepf

  Slide 42

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide43.png: 'Graphical user interface:
  1: Select image[s]

  2: Select ground truth annotation

  Object segmentation

  [3: Select features]

  4: Train / predict

  1

  2

  3

  4

  Robert Haase

  @haesleinhuepf

  Slide 43

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide44.png: 'Graphical user interface:
  Object classification

  Annotation / classification of segmented objects

  Robert Haase

  @haesleinhuepf

  Slide 44

  BIDS Lecture 8/14 https://github.com/haesleinhuepf/napari-accelerated-pixel-and-object-classification
  4

  May 21st 2024 Image data source: Daniela Vorkel, Myers lab, MPI-CBG/CSBD

  4'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide45.png: 'Graphical user interface:
  Object classification

  Inspect how the random

  forest classifier makes

  decisions

  Note: Beware of correlated

  parameters!

  Robert Haase

  @haesleinhuepf

  Slide 45

  BIDS Lecture 8/14 https://github.com/haesleinhuepf/napari-accelerated-pixel-and-object-classification
  4

  May 21st 2024 Image data source: Daniela Vorkel, Myers lab, MPI-CBG/CSBD

  5'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide46.png: 'Graphical user interface:
  Object classification

  Inspect how the random

  forest classifier makes

  decisions

  Note: Beware of correlated

  parameters!

  Robert Haase

  @haesleinhuepf

  Slide 46

  BIDS Lecture 8/14 https://github.com/haesleinhuepf/napari-accelerated-pixel-and-object-classification
  4

  May 21st 2024 Image data source: Daniela Vorkel, Myers lab, MPI-CBG/CSBD

  6'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide47.png: 'Graphical user interface:
  Object classification

  Inspect how the random

  Pixel count

  forest classifier makes

  decisions

  Note: Beware of correlated

  parameters!

  Average distance to 6 nearest

  Mean intensity

  neighbors

  Standard

  Mean/max distance-

  deviation of

  to-centroid ratio

  Robert Haase

  intensity

  @haesleinhuepf

  Slide 47

  BIDS Lecture 8/14 4

  May 21st 2024 Image data source: Daniela Vorkel, Myers lab, MPI-CBG/CSBD

  7'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide48.png: 'CENTER FOR SCALABLE
  DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Supervised and Unsupervised

  Machine Learning for Bio-image Analysis

  Robert Haase

  Reusing materials from Johannes Soltwedel, Till Korten, Johannes Müller, Laura Žigutytė

  (TU Dresden), Ryan Savill (MPI-CBG), Matthias Täschner (ScaDS.AI/Uni Leipzig) and
  the

  Scikit-learn community.

  Robert Haase

  @haesleinhuepf These slides and the related training materials can be reused

  Slide 48

  BIDS Lecture 8/14 under the terms of the CC-BY 4.0license.

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide49.png: 'Hypothesis-driven quantitative
  biology

  Hypothesis: Cell shape can be influenced by modifying X.

  Null-Hypothesis: Circularity of modified cells is similar to cells in the control
  group.

  Sample preparation

  Shall we use a

  different

  Should we use a Imaging

  microscope?

  different

  segmentation

  Cell segmentation

  algorithm?

  Is circularity the

  right parameter to

  Circularity measurement

  measure?

  Statistics

  Robert Haase

  @haesleinhuepf

  Slide 49

  BIDS Lecture 8/14 4

  May 21st 2024

  9'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide50.png: 'Hypothesis generating
  quantitative biology

  Hypothesis: Cell shape can be influenced by modifying X.

  Question: Which image-derived parameter is influenced when modifying X?

  Sample preparation Which segmentation

  algorithms allow

  measurements that show a

  Imaging

  relationship with X?

  Cell segmentation algorithm A, algorithm B, algorithm C

  Why?

  Measurement of circularity, solidity, elongation, extend, texture, intensity, topology
  …

  Which parameter shows

  Statistics any relationship with X?

  Robert Haase

  @haesleinhuepf

  Slide 50

  BIDS Lecture 8/14 5

  May 21st 2024

  0'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide51.png: 'Feature selection

  Which of these features reflect the phenotype we are perceiving?

  Robert Haase

  @haesleinhuepf

  Source: Mara Lampert, FocalPlane, Slide 51

  BIDS Lecture 8/14

  https://focalplane.biologists.com/2023/05/03/feature-extraction-in-napari/

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide52.png: 'Feature selection:
  challenges

  • Features are not independent

  • Area and diameter

  • Roundness, circularity, solidity, extent, aspect ratio, elongation, Feret’s diameter,
  …

  • Best classification most likely involves multiple features

  • Vast amount of features can hardly be visualized

  • Need for dimensionality reduction

  • Principal component analysis (PCA)

  • t-Distributed Stochastic Neighbour Embedding (t-SNE)

  • Uniform Manifold Approximation and Projection (UMAP)

  • Grouping objects (clustering)

  Robert Haase

  @haesleinhuepf

  Slide 52

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide53.png: 'PCA: Principal Component
  Analysis

  Decomposes data into linear combinations of features that explain the highest variance

  Example: Squares of different size

  2

  n

  d

  -

  h

  i

  g

  h

  e

  s

  t

  PCA v

  a

  r

  i

  a

  n

  c

  e Highest variance

  Explained variance Component : 0.98

  1

  Explained variance Component : 0.01

  2

  → PCA transforms width/height measurements into a coordinate system that explains
  existing variance better

  Robert Haase

  @haesleinhuepf

  Slide 53

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide54.png: 'PCA: Principal Component
  Analysis

  Decomposes data into linear combinations of features that explain the highest variance

  Example: Squares of different size

  2

  n

  d

  -

  h

  i

  g

  h

  e

  s

  t

  PCA v

  a

  r

  i

  a

  n

  c

  e Highest variance

  Explained variance Component : 0.98

  1

  Explained variance Component : 0.01

  2

  → PCA transforms width/height measurements into a coordinate system that explains
  existing variance better

  Robert Haase

  @haesleinhuepf

  Slide 54

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide55.png: 'PCA in Python: sklearn.decomposition.PCA

  • Import package

  from sklearn.decomposition import PCA

  • Apply PCA

  pca = PCA(n_components=2)

  pca.fit(standardized_data)

  • Transform data into new coordinate system

  transformed_data = pca.transform(data)

  Important!

  Always check the explained variance

  along the PCA component axes!

  Robert Haase

  @haesleinhuepf

  Slide 58

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide56.png: 'Non-Euclidian spaces

  Not all dimensions (features) might be distances

  Use travel time between P and Q as metric

  for distance

  A

  →Travelling from Stadt Wehlen to Strand

  P

  by bike is probably faster if you make a

  detour through Rathen

  P

  A

  Q

  Q

  Robert Haase

  @haesleinhuepf https://www.openstreetmap.org/#map=14/

  Slide 59

  BIDS Lecture 8/14 59

  50.9500/14.0666

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide57.png: 'Dimensionality reduction:
  UMAP

  Uniform Manifold Approximation Projection

  Preserve local distances at the expense of

  global

  global distortions

  distances

  distorted

  2

  P

  A

  Many dimensions M

  U

  Local

  distances

  preserved

  UMAP 1

  Robert Haase

  @haesleinhuepf

  Slide 60

  BIDS Lecture 8/14 60

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide58.png: 'Dimensionality reduction:
  UMAP

  Initial situation: Our data suggests an underlying structure (“topology”)

  Goal:

  Reconstruct underlying

  topology to identify a

  space that best explains

  differences in our data

  Robert Haase

  @haesleinhuepf

  Source: https://umap- Slide 61

  BIDS Lecture 8/14 61

  learn.readthedocs.io/en/latest/how_umap_works.html

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide59.png: 'Dimensionality reduction

  Naïve approach:

  Points within a

  defined radius are

  considered

  neighbors

  Robert Haase

  @haesleinhuepf

  Source: https://umap- Slide 62

  BIDS Lecture 8/14 62

  learn.readthedocs.io/en/latest/how_umap_works.html

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide60.png: 'Dimensionality reduction

  Naïve approach:

  Points within a

  defined radius are

  considered

  neighbors

  Result:

  Neighborhood

  graph with

  interruptions

  Robert Haase

  @haesleinhuepf

  Source: https://umap- Slide 63

  BIDS Lecture 8/14 63

  learn.readthedocs.io/en/latest/how_umap_works.html

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide61.png: 'Dimensionality reduction:
  UMAP

  Approach:

  Normalize distances

  d = 1

  by dividing by the

  average distance to

  n nearest neighbors

  (Example: n=1)

  d = 1

  Robert Haase

  @haesleinhuepf

  Source: https://umap- Slide 65

  BIDS Lecture 8/14 65

  learn.readthedocs.io/en/latest/how_umap_works.html

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide62.png: 'Reduce dimensionality
  preserving fuzzy topology

  Approach:

  Normalize distances

  by dividing by the

  average distance to

  Low weight

  n nearest neighbors

  Build a graph

  considering

  normalized

  distances

  High weight

  Project data into

  lower dimensional

  space

  Robert Haase

  @haesleinhuepf

  Source: https://umap- Slide 67

  BIDS Lecture 8/14 67

  learn.readthedocs.io/en/latest/how_umap_works.html

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide63.png: 'Dimensionality reduction

  Uniform manifold approximation and projection (UMAP)

  t-distributed stochastic neighbor embedding (t-SNE)

  Principal component analysis

  (PCA)

  Laura Žigutytė Ryan Savill Marcelo Zoccoler

  @zigutyte @RyanSavill4 @zoccolermarcelo

  Robert Haase

  https://github.com/BiAPoL

  @haesleinhuepf

  Slide 68

  BIDS Lecture 8/14 /napari-clusters-plotter 6

  May 21st 2024

  8'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide64.png: 'UMAP in Python

  Selecting columns from a pandas DataFrame

  Select reasonable features

  Robert Haase

  @haesleinhuepf

  Slide 69

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide65.png: 'UMAP in Python

  Data

  conversion

  Robert Haase

  @haesleinhuepf https://umap-

  Slide 70

  BIDS Lecture 8/14

  learn.readthedocs.io/en/latest/index.html

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide66.png: 'Annotating UMAPs in
  Napari Draw a lasso

  here to visualize

  which objects

  the data points

  correspond to

  Robert Haase

  https://github.com/BiAPoL

  @haesleinhuepf

  Slide 71

  BIDS Lecture 8/14 /napari-clusters-plotter

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide67.png: 'Interpreting annotations
  in Napari

  Switch plot axes to

  see relationships

  between annotation

  and features

  Robert Haase

  https://github.com/BiAPoL

  @haesleinhuepf

  Slide 72

  BIDS Lecture 8/14 /napari-clusters-plotter

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide68.png: 'Correlation statistics

  My annotation My annotation

  Robert Haase

  @haesleinhuepf seems related to seems not related

  Slide 73

  BIDS Lecture 8/14

  May 21st 2024 area to intensity'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide69.png: 'Clustering

  Unsupervised machine learning may include grouping objects without

  given ground truth

  1

  P

  A

  M

  U

  frequency UMAP 2

  y

  c

  n

  e

  u

  q

  e

  r

  f

  Robert Haase

  @haesleinhuepf

  Slide 74

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide70.png: 'Clustering

  Unsupervised machine learning may include grouping objects without

  given ground truth

  Round Elongated

  Names given by

  human observer

  after grouping /

  clustering

  1

  P

  A

  M

  U

  frequency UMAP 2

  y

  c

  n

  e

  u

  q

  e

  r

  f

  Robert Haase

  @haesleinhuepf

  Slide 75

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide71.png: 'K-Means Clustering

  Goal: group data points into 𝑘 groups so that variance within group is minimal.

  STEP 1: Seed 𝑘 initial cluster centroids randomly

  Randomly

  STEP 2: Assign all points to nearest centroid

  initialized

  centroids

  𝑛

  𝑑 𝑝,𝑞 = ෍ 𝑝 − 𝑞 2 = 𝑝 − 𝑞 2 + 𝑝 − 𝑞 2

  𝑖 𝑖 1 1 2 2

  𝑖=1

  𝑛 – dimensionality, in this example = 2

  Robert Haase

  @haesleinhuepf

  Slide 76

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide72.png: 'K-Means Clustering

  Goal: group data points into 𝑘 groups so that variance within group is minimal.

  STEP 1: Seed 𝑘 initial cluster centroids randomly

  STEP 2: Assign all points to nearest centroid

  𝑛

  𝑑 𝑝,𝑞 = ෍ 𝑝 − 𝑞 2 = 𝑝 − 𝑞 2 + 𝑝 − 𝑞 2

  𝑖 𝑖 1 1 2 2

  𝑖=1

  𝑛 – dimensionality, in this example = 2 𝑞

  2

  𝑝

  2

  𝑝 𝑞

  1 1

  Robert Haase

  @haesleinhuepf

  Slide 77

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide73.png: 'K-Means Clustering

  Goal: group data points into 𝑘 groups so that variance within group is minimal.

  STEP 3: Determine new centroid positions as mean

  position of all assigned points.

  1

  New centroid = ෍ 𝑥

  𝑖

  𝐶

  𝑖 𝑥∈𝐶

  𝑖

  𝐶 - the number of data points in cluster i

  𝑖

  Repeat steps 2-3: the assignment and update steps

  are repeated iteratively until:

  • Centroids not changing anymore,

  • Point assignments not chainging anymore or

  • Maximum number of iterations reached

  Robert Haase

  @haesleinhuepf

  Slide 78

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide74.png: 'K-Means Clustering

  Goal: group data points into 𝑘 groups so that variance within group is minimal.

  STEP 3: Determine new centroid positions as mean

  position of all assigned points.

  1

  New centroid = ෍ 𝑥

  𝑖

  𝐶

  𝑖 𝑥∈𝐶

  𝑖

  𝐶 - the number of data points in cluster i

  𝑖

  Repeat steps 2-3: the assignment and update steps

  are repeated iteratively until:

  • Centroids not changing anymore,

  • Point assignments not chainging anymore or

  • Maximum number of iterations reached

  Robert Haase

  @haesleinhuepf

  Slide 79

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide75.png: 'K-Means Clustering

  Goal: group data points into 𝑘 groups so that variance within group is minimal.

  In Python:

  Create

  Predict

  Robert Haase

  @haesleinhuepf

  Slide 80

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide76.png: 'Clustering

  K-means clustering

  Agglomerative clustering

  Hierarchical Density-

  Based Spatial Clustering

  of Applications with Noise

  (HDBSCAN)

  Laura Žigutytė Ryan Savill Marcelo Zoccoler

  @zigutyte @RyanSavill4 @zoccolermarcelo

  Robert Haase

  https://github.com/BiAPoL

  @haesleinhuepf

  Slide 81

  BIDS Lecture 8/14 /napari-clusters-plotter 8

  May 21st 2024

  1'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide77.png: 'Manual clustering

  To better

  understand

  relationships

  between data

  Laura Žigutytė Ryan Savill Marcelo Zoccoler

  @zigutyte @RyanSavill4 @zoccolermarcelo

  Robert Haase

  https://github.com/BiAPoL

  @haesleinhuepf

  Slide 82

  BIDS Lecture 8/14 /napari-clusters-plotter 8

  May 21st 2024

  2'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide78.png: 'CENTER FOR SCALABLE
  DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Exercises

  Robert Haase

  Robert Haase

  These slides and the related training materials can be reused

  @haesleinhuepf

  Slide 83

  under the terms of the CC-BY 4.0license.

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide79.png: 'Exercise: Feature exploration

  Use dimensionality reduction to elaborate features that might allow round and

  elongated objects

  Robert Haase https://github.com/ScaDS/BIDS-lecture-

  @haesleinhuepf

  2024/blob/main/08a_hypothesis_generation Slide 84

  BIDS Lecture 8/14

  May 21st 2024 /interactive_parameter_exploration.ipynb'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide80.png: 'Pixel classification
  / object segmentation

  Use Napari to segment objects

  Robert Haase https://github.com/ScaDS/BIDS-lecture-

  @haesleinhuepf

  2024/blob/main/08b_pixel_and_object_classification/ Slide 85

  BIDS Lecture 8/14

  interactive_pixel_classification/readme.md

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide81.png: 'Object classification

  Use Napari to classify round and elongated objects

  Robert Haase https://github.com/ScaDS/BIDS-lecture-

  @haesleinhuepf

  2024/blob/main/08b_pixel_and_object_classification/ Slide 86

  BIDS Lecture 8/14

  interactive_object_classification/readme.md

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide82.png: 'Supervised machine
  learning using Python

  Use scikit-learn and apoc in Jupyter Notebooks to train and apply Random Forest

  Classifiers

  Robert Haase

  @haesleinhuepf

  Slide 87

  BIDS Lecture 8/14

  May 21st 2024'
downloads/12623730_08_Sup_Unsup_Machine_Learning_slide83.png: 'Configuring Random
  Forest Classifiers

  Robert Haase https://github.com/ScaDS/BIDS-lecture-

  @haesleinhuepf

  2024/blob/main/08b_pixel_and_object_classification/ Slide 88

  BIDS Lecture 8/14

  May 21st 2024 05_configuring_rfc.ipynb'
downloads/12623730_14_Summary_slide1.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Bio-Image Data Science

  Robert Haase

  Robert Haase

  @haesleinhuepf

  1

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide2.png: 'Bioimage Analysis

  • Kota Miura & Sebastien Tosi 2015:

  Robert Haase

  Source: Bioimage Data Analysis, First Edition. Edited by Kota Miura. 2016 Wiley-VCH
  Verlag

  @haesleinhuepf

  GmbH & Co. KGaA. Published 2016 by Wiley-VCH Verlag GmbH & Co. KGaA 2

  BIDS Lecture14/14

  https://analyticalscience.wiley.com/do/10.1002/was.00050003/full/bioimagedataanalysis.pdf

  June 27th 2024'
downloads/12623730_14_Summary_slide3.png: 'Pixel size versus resolution

  • Pixel size is a property of a digital image.

  • You configure it during the imaging session at the microscope.

  Pixel size: 3.3 µm Pixel size: 0.8 µm Pixel size: 0.05 µm

  • We are not talking about resolution!

  Robert Haase

  @haesleinhuepf

  3

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide4.png: 'Pixel size versus resolution

  • Resolution is a property of your imaging system.

  • How small can objects be, to be still differentiable?

  Robert Haase

  @haesleinhuepf

  4

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide5.png: 'Quiz

  • Enabling others to do your experiment is about …

  Repeatability Replicability Reliability

  Reproducibility

  Robert Haase

  @haesleinhuepf

  5

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide6.png: 'Quiz

  • Reproducibility can be achieved by

  Providing Recording

  Writing

  Writing

  example Video

  documentation code

  data tutorials

  Robert Haase

  @haesleinhuepf

  6

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide7.png: 'Bio-image analysis is supposed to be

  • Quantitative

  • We derive numbers from images which describe physical properties of the observed
  sample.

  • Objective

  • The derived measurement does not depend on who did the measurement. The measurement
  is free of

  interpretation.

  • Reliable (trustworthy / validated)

  • We are confident that the measurement is describing what it is supposed to describe.

  • Reproducible

  • Enabling others to re-do the experiment. For this, documentation is crucial!

  • Replicability

  • Others do execute the same analysis, potentially on other data, and see consistent
  results.

  • Repeatable

  • We can do the same experiment twice under the same conditions and get the same
  measurements.

  Robert Haase

  @haesleinhuepf

  7

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide8.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Research Data Management

  Robert Haase

  Robert Haase

  @haesleinhuepf

  8

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide9.png: 'RDM Life Cycle

  Plan

  • Processes are

  ideally cyclic

  Reuse Acquire

  Process /

  Archive

  analyse

  Publish

  Robert Haase Adaptiert von:

  @haesleinhuepf

  https://forschungsdaten.info/themen/informieren-und- 9

  BIDS Lecture14/14

  June 27th 2024 planen/datenlebenszyklus/'
downloads/12623730_14_Summary_slide10.png: 'Data Management Plans (DMPs)

  • Describes the IS-state of a data environment

  • Which data is acquired / processed?

  (content, format, amount)

  • What meta-data is collected?

  • Which quality standards are targeted?

  • How is data saved, archived, backed-up, shared, published…?

  • Who is responsible for what?

  • Roles, job-profiles

  • What does this all cost?

  (IT infrastructure + human resources)

  Robert Haase

  @haesleinhuepf

  10

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide11.png: 'Survey

  Think about the FAIR principles for

  data sharing, which one is wrong?

  Findable Accessible

  Interoperable Reproducible

  Robert Haase

  @haesleinhuepf

  11

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide12.png: 'Standard for sharing: The FAIR-principles

  • Findable

  • Accessible

  • Interoperable

  • Reusable

  Robert Haase

  @haesleinhuepf

  12

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide13.png: '19

  Licensing: Creative Commons (CC)

  • Public domain (CC0)

  • Attribution International (CC-BY)

  • Attribution ShareAlike Int. (CC-BY-SA)

  • Attribution Non-Commercial Int. (CC-BY-NC)

  • Attribution NoDerivatives Int. (CC-BY-ND)

  + Combinations, e.g. CC-BY-NC-ND

  Content on this site is licensed under aCreative Commons Attribution 4.0 International
  license.Iconsby The Noun Project.

  Robert Haase

  @haesleinhuhettppsf://creativecommons.org/share-your-work/

  19

  https://creativecommons.org/about/cclicenses/

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide14.png: 'Quiz (recap)

  • If I combine two works licensed CC-BY and CC-

  BY-SA, what license do I have to use?

  CC-BY CC-BY-SA CC-BY-ND (not possible)

  Robert Haase

  @haesleinhuepf

  20

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide15.png: 'Licensing: Permissive versus

  restrictive

  • Restrictive

  • You can reuse our stuff, but only if you …

  • License your work with the same license we do

  • Make your stuff openly available

  I conclude,

  • Make no money with derivatives of our work

  these are

  • Examples: GPL, CC-BY-SA, CC-BY-NC, CC-BY-ND less open in

  a sense

  • Permissive licensing:

  • Do whatever you like with our stuff,

  just make sure to mention / cite us …

  • Examples: BSD, MIT, Apache, CC-BY

  Robert Haase

  @haesleinhuepf

  21

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide16.png: 'Survey

  Which open-source license might be

  the least popular in companies?

  GPL BSD

  MIT Apache

  Robert Haase

  @haesleinhuepf

  22

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide17.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Research Software Management

  Robert Haase

  Robert Haase

  @haesleinhuepf

  23

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide18.png: 'Documenting dependencies

  • Maintain a document with the dependencies (and versions) you need in your project!

  • The conda way • The pip way

  In case your

  environment is screwed

  up, you can rebuild it

  any time.

  conda env create -f environment.yml pip install -r requirements.txt

  Robert Haase

  https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-

  @haesleinhuepf

  environments.html#creating-an-environment-from-an-environment-yml-file 24

  BIDS Lecture14/14 2

  June 27th 2024 https://pip.pypa.io/en/stable/cli/pip_install/#examples

  4'
downloads/12623730_14_Summary_slide19.png: 'Quiz

  conda install package_a Depends on:

  numpy<1.22.0

  Dependency

  conflict

  Depends on:

  pip install package_b

  numpy>1.22.0

  fails works works but…

  Robert Haase

  @haesleinhuepf

  25

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide20.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Image Processing

  Robert Haase

  Reusing materials from Mauricio Rocha Martins

  (Norden lab, MPI CBG); Dominic Waithe (Oxford

  University); Alex Bird, Dan White (MPI CBG)

  Robert Haase

  @haesleinhuepf

  26

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide21.png: 'Lecture overview: Bio-image Analysis

  • Image Data Analysis workflows

  • Goal: Quantify observations, substantiate

  conclusions with numbers

  Plotting

  Image filtering Image segmentation Feature extraction Object classification

  Robert Haase

  @haesleinhuepf

  27

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide22.png: 'Image stacks and voxels

  • 3-dimensional images

  consisting of voxels

  • “Image stack”

  • Often anisotropic (not equally

  large in all directions)

  𝑙

  𝑧

  𝑙

  𝑦

  𝑙

  𝑥

  𝑙 = 𝑙 ≠R𝑙obert Haase

  𝑥 𝑦 𝑧

  @haesleinhuepf

  28

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide23.png: 'Image filtering

  • Attempt to invert / “undo” processes disturbing image

  quality

  Low-pass filter:

  Allows low

  frequencies pass

  Denoise

  ͌

  Denoise

  Remove

  Band-pass filter:

  background High-pass filter:

  Allows a specific range

  Allows high

  of frequencies pass

  frequencies pass

  Robert Haase

  @haesleinhuepf

  29

  BIDS Lecture14/14

  June 27th 2024

  https://github.com/BiAPoL/Bio-image_Analysis_with_Python/blob/49a787514a367829c3e0e1832f6cc533e96d549f/03_image_processing/simulated_dataset.ipynb'
downloads/12623730_14_Summary_slide24.png: 'Survey

  Which is a non-linear filter?

  Laplace Gaussian Top-hat Sobel

  Robert Haase

  @haesleinhuepf

  30

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide25.png: 'Survey

  Which is a noise-removal filter?

  Laplace Gaussian Top-hat Sobel

  Robert Haase

  @haesleinhuepf

  31

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide26.png: 'Survey

  Which is a edge-detection filter?

  Laplace Gaussian Top-hat Sobel

  Robert Haase

  @haesleinhuepf

  32

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide27.png: 'Survey

  Which is a background-removal filter?

  Laplace Gaussian Top-hat Sobel

  Robert Haase

  @haesleinhuepf

  33

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide28.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Image segmentation

  Robert Haase

  Using materials from Marcelo Leomil Zoccoler and Johannes

  Soltwedel, PoL, TU Dresden

  Robert Haase

  @haesleinhuepf

  34

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide29.png: 'Terminology

  • Annotations are typically drawn by humans (e.g. to train machine learning

  models)

  Instance Semantic

  segmentation segmentation

  Sparse semantic

  Sparse instance

  annotation

  annotation

  Robert Haase

  @haesleinhuepf

  35

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide30.png: 'Watershed

  Robert Haase

  @haesleinhuepf

  36

  BIDS Lecture14/14

  June 27th 2024 https://www.napari-hub.org/plugins/napari-segment-blobs-and-things-with-membranes#seeded-watershed'
downloads/12623730_14_Summary_slide31.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Surface reconstruction

  Robert Haase

  Robert Haase

  @haesleinhuepf

  37

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide32.png: 'Marching cubes algorithm

  • Starting point: 3D binary image

  • Cuts the image in small cubes and iterates over them

  Split into cubes Build triangles Combine triangles

  Robert Haase Lorensen, William E.; Cline, Harvey E. (1 August 1987). "Marching cubes:
  A high

  @haesleinhuepf

  resolution 3D surface construction algorithm".ACM SIGGRAPH Computer 38

  BIDS Lecture14/14

  Graphics.21(4): 163-169.CiteSeerX 10.1.1.545.613.doi:10.1145/37402.37422.

  June 27th 2024 April 2023'
downloads/12623730_14_Summary_slide33.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Segmentation quality

  estimation

  Robert Haase

  Reusing materials from Lena Maier-Hein, Annika Reinke (DKFZ) et al.

  and Martin Schätz (Charles Uni Prague)

  Robert Haase

  @haesleinhuepf

  39

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide34.png: 'Accuracy versus Jaccard Index (IoU)

  • Side-effects of image size and number of nuclei

  Nuclei Reference Segmentation result

  Accuracy: 0.97

  Jaccard Index: 0.73

  Accuracy decreases because

  there are less correct black

  pixels (TN)

  Accuracy: 0.95

  Jaccard Index: 0.73

  Robert Haase

  https://haesleinhuepf.github.io/BioImageAnalysisNotebooks/29_algorithm

  @haesleinhuepf

  _validation/jaccard_index_versus_accuracy.html 40

  BIDS Lecture14/14 4

  June 27th 2024

  0'
downloads/12623730_14_Summary_slide35.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Feature extraction

  Robert Haase

  Using materials from Johannes Soltwedel, PoL, TU Dresden

  Robert Haase

  @haesleinhuepf

  41

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide36.png: 'Feature extraction

  • A feature is a countable or measurable property of an image or object.

  • Goal of feature extraction is finding a minimal set of features to describe an
  object well enough to

  differentiate it from other objects.

  • Intensity based • Shape based /spatial • Spatio-temporal • Topological

  • Mean intensity • Area / Volume • Displacement, • Number of neighbors

  • Standard deviation • Roundness • Speed,

  • Total intensity • Solidity • Acceleration

  • Textures • Circularity / Sphericity

  • Others

  • Elongation

  • Overlap

  • Centroid

  • Colocalization

  • Bounding box

  • Mixed features

  • Center of mass

  • Local minima / maxima

  • Distance to neighbors

  • Average intensity in neighborhood

  Robert Haase

  @haesleinhuepf

  42

  BIDS Lecture14/14

  June 27th 2024 April 2023'
downloads/12623730_14_Summary_slide37.png: 'CENTER FOR SCALABLE DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Distributed & GPU-accelerated

  Image Processing

  Robert Haase

  Robert Haase These slides and the related training materials can be reused under
  the

  @haesleinhuepf terms of the CC-BY 4.0 license.

  43

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide38.png: 'GPUs allow real-time image processing

  • GPUs are specialised in processing, very fast thanks to many cores and fast

  memory access

  CPU GPU

  Core Core Core Core Core

  CPU GPU

  Core Core

  Core Core Core Core Core

  Memory Memory

  Core Core Core Core Core

  Core Core Core Core Core

  Core Core

  Core Core Core Core Core

  Hard drive

  Robert Haase

  @haesleinhuepf

  44

  BIDS Lecture14/14 4

  June 27th 2024

  4'
downloads/12623730_14_Summary_slide39.png: 'Tiling

  • The last perimeter against big data

  If the image is too large for the computer memory,

  image processing as a whole is not possible.

  Processing tile-by-tile poses new challenges

  Robert Haase

  @haesleinhuepf

  45

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide40.png: 'CENTER FOR SCALABLE DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Methods for comparing

  measurement methods

  Robert Haase

  Using materials Reusing materials from Daniela Vorkel,

  Douglas G. Altman and J. Martin Bland

  Robert Haase

  @haesleinhuepf

  46

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide41.png: 'The confidence interval

  • “The British Standards Institution (1979) define a coefficient of repeatability
  as

  ‘the value below which the difference between two single test results ... may be

  expected to lie with a specified probability; in the absence of other indications,

  the probability is 95 per cent’.”1

  The confidence interval CI of agreement

  t

  f n

  o

  e

  e m

  c

  n e

  e r

  u

  r

  𝐶𝐼 = (𝜇 − 2𝜎, 𝜇 + 2𝜎) e s

  f a

  f e

  i

  D m

  Mean Standard deviation of

  difference differences

  The mean difference between the Average measurement

  methods (“offset”)

  Robert Haase

  @haesleinhuepf

  1 Altman & Bland, The Statistician 32, 1983 47

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide42.png: 'CENTER FOR SCALABLE DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Supervised and Unsupervised

  Machine Learning for Bio-image Analysis

  Robert Haase

  Reusing materials from Johannes Soltwedel, Till Korten, Johannes Müller, Laura Žigutytė

  (TU Dresden), Ryan Savill (MPI-CBG), Matthias Täschner (ScaDS.AI/Uni Leipzig) and
  the

  Scikit-learn community.

  Robert Haase

  @haesleinhuepf These slides and the related training materials can be reused under
  the

  48

  BIDS Lecture14/14 terms of the CC-BY 4.0 license.

  June 27th 2024'
downloads/12623730_14_Summary_slide43.png: 'Machine learning

  • Automatic construction of predictive models from given data

  Pixels, Objects, Images, Audio, Text, Measurements, …

  Annotated raw

  data, usually

  Training

  Raw data Ground truth generated by

  humans

  Dense Segmentation

  Object Image

  / Binarization

  P

  classification classification

  r

  e

  d Model

  i

  c

  t

  i

  “Cat” o

  n

  Instance segmentation Cont. quantity Precision,

  Classification

  Quality Recall

  / regression

  P = 0.5

  Cat

  P = 0.4

  Microscope

  Height = 80 cm

  Robert Haase

  @haesleinhuepf

  49

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide44.png: 'Hypothesis-driven quantitative biology

  • Hypothesis: Cell shape can be influenced by modifying X.

  • Null-Hypothesis: Circularity of modified cells is similar to cells in the control
  group.

  • Sample preparation

  Shall we use a

  • Imaging different

  microscope?

  Should we use a different

  • Cell segmentation

  segmentation algorithm?

  Is circularity the right

  • Circularity measurement

  parameter to

  measure?

  • Statistics

  Robert Haase

  @haesleinhuepf

  50

  BIDS Lecture14/14 5

  June 27th 2024

  0'
downloads/12623730_14_Summary_slide45.png: 'Hypothesis generating quantitative biology

  • Hypothesis: Cell shape can be influenced by modifying X.

  • Question: Which image-derived parameter is influenced when modifying X?

  • Sample preparation

  Which segmentation algorithms

  allow measurements that show a

  • Imaging

  relationship with X?

  • Cell segmentation algorithm A, algorithm B, algorithm C

  Why?

  • Measurement of circularity, solidity, elongation, extend, texture, intensity,
  topology …

  • Statistics

  Which parameter shows any

  relationship with X?

  Robert Haase

  @haesleinhuepf

  51

  BIDS Lecture14/14 5

  June 27th 2024

  1'
downloads/12623730_14_Summary_slide46.png: 'Correlation statistics

  My annotation My annotation seems

  Robert Haase

  @haesleinhuepf seems related to not related to

  52

  BIDS Lecture14/14

  June 27th 2024 area intensity'
downloads/12623730_14_Summary_slide47.png: 'CENTER FOR SCALABLE DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Deep Learning for Bio-image Analysis

  Robert Haase

  Robert Haase

  @haesleinhuepf These slides and the related training materials can be reused under
  the

  53

  BIDS Lecture14/14 terms of the CC-BY 4.0 license.

  June 27th 2024'
downloads/12623730_14_Summary_slide48.png: 'Noise2void

  • Image denoising without image pairs

  Robert Haase

  Source: A.Krull et al.

  @haesleinhuepf

  54

  BIDS Lecture14/14

  https://arxiv.org/pdf/1811.10980

  June 27th 2024'
downloads/12623730_14_Summary_slide49.png: 'CellPose

  • Cell/Nuclei –

  segmentation based

  on flow-fields

  • Technically similar to

  Watershed, but with a

  deep-learning based

  altitude-image

  Robert Haase

  Image source: Modified from Stringer et al (2020) licensed CC-BY-NC 4.0

  @haesleinhuepf

  55

  BIDS Lecture14/14

  https://www.biorxiv.org/content/10.1101/2020.02.02.931238v2.full

  June 27th 2024'
downloads/12623730_14_Summary_slide50.png: 'CENTER FOR SCALABLE DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Prompt Engineering & ChatBots

  Robert Haase

  Robert Haase These slides and the related training materials can be reused under
  the

  @haesleinhuepf terms of the CC-BY 4.0 license.

  56

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide51.png: 'Context length

  Robert Haase

  @haesleinhuepf Visualization by Greg Kamradt, Licensed MIT (modified), Source:

  57

  BIDS Lecture14/14 https://github.com/gkamradt/LLMTest_NeedleInAHaystack

  June 27th 2024'
downloads/12623730_14_Summary_slide52.png: 'CENTER FOR SCALABLE DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Large Language Models for

  Function Calling

  Robert Haase

  Robert Haase

  @haesleinhuepf

  58

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide53.png: 'Generative Artificial Intelligence

  • Definition: “Generative artificial intelligence […] is a type of artificial intelligence
  (AI) system

  capable of generating text, images, or other media in response to prompts.”1

  • Commonly based on Neural Networks

  • Bridges fields:

  • Natural Language Processing (NLP)

  • Computer Vision (CV)

  • Use-cases

  • Translating text

  How many There are 4

  • Writing emails, text, grant proposals

  cells are cells. I just

  • Summarizing articles

  there? marked their

  • Writing code

  „Multi-modal

  nuclei.

  • General question answering

  model“

  • Image generation

  • Image interpretation / analysis

  Robert Haase

  @haesleinhuepf 1 source:

  59

  BIDS Lecture14/14 https://en.wikipedia.org/wiki/Generative_artificial_intelligence

  June 27th 2024'
downloads/12623730_14_Summary_slide54.png: 'Quiz: Recap

  • The V in attention

  mechanisms stand

  for…?

  The word we are The word we The relevance The variance of

  determining are determining between the attention between

  attention from attention to two words the two words

  Robert Haase

  @haesleinhuepf

  60

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide55.png: 'Function calling

  Some kind of

  • (choosing a tool)

  next-word

  prediction task

  Given a list of tools…

  • get_current_time

  book_room

  • order_food

  • book_room

  … and a task:

  Please book meeting room 3

  for Robert at 3pm.

  Which is the right tool to use?

  Robert Haase

  @haesleinhuepf

  61

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide56.png: 'Function calling

  • (parameterizing)

  Some kind of

  translation task

  Given a function signature…

  book_room(room, time, person)

  … and a task: book_room(“Meeting Room 3“,

  Please book meeting room 3 for “3pm“, “Robert“)

  Robert at 3pm.

  How could I use the tool?

  Robert Haase

  @haesleinhuepf

  62

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide57.png: 'CENTER FOR SCALABLE DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Prompt Engineering, Retrieval

  Augmented Generation and Fine-Tuning

  Robert Haase

  Robert Haase

  @haesleinhuepf

  63

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide58.png: 'Self-consistency prompting

  • Prompting multiple times and keep the least conflicting result

  Robert Haase

  Cropped from Zhang et al 2022, licensed CC-BY 4.0

  @haesleinhuepf

  64

  BIDS Lecture14/14 https://arxiv.org/abs/2203.11171

  June 27th 2024'
downloads/12623730_14_Summary_slide59.png: 'Retrieval Augmented Generation

  • Enriching a prompt with relevant context

  Query Document index Generator

  encoder

  Document A

  Document B

  MIPS

  Document C

  Query Prompt

  Document C

  x

  4

  q x

  3

  Maximum inner

  x

  2

  product search (MIPS)

  x

  1

  Robert Haase Read more: Lewis et al 2020

  @haesleinhuepf

  65

  BIDS Lecture14/14 https://arxiv.org/abs/2005.11401

  June 27th 2024'
downloads/12623730_14_Summary_slide60.png: 'Fine-tuning

  • Long prompts due to prompt-engineering)

  • Response time 

  • Costs 

  [Domain]-specific

  training data

  • Fine-tuning a custom,

  Domain-specific

  model may help

  Pretrained [Domain]-specific

  Fine-tuning

  LLM LLM

  Robert Haase

  @haesleinhuepf

  66

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide61.png: 'CENTER FOR SCALABLE DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Image Generation and

  Vision Language Models

  Robert Haase

  Robert Haase

  @haesleinhuepf

  67

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide62.png: 'Stable diffusion

  • Reminder:

  - Word embeddings

  The cat’s fur

  - Attention is black and

  white.

  Word Embedding

  Self-attention

  1 t

  t u

  “microscope” u p

  0 1 4 3 2 1 p t

  n u

  The cat’s fur is black and white. I O

  “cat”

  “black”

  “white” “fur”

  0

  0 1

  Robert Haase

  @haesleinhuepf

  68

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide63.png: 'Contrastive Language-Image Pre-Training

  • „CLIP“ Transformers

  Robert Haase Source: Radford et al 2021, License MT

  @haesleinhuepf

  https://arxiv.org/abs/2103.00020 69

  BIDS Lecture14/14

  June 27th 2024 https://github.com/OpenAI/CLIP'
downloads/12623730_14_Summary_slide64.png: 'CENTER FOR SCALABLE DATA ANALYTICS AND
  NATIONAL RESEARCH DATA MANAGEMENT INFRASTRUCTURE GLOBAL BIOIMAGE

  ARTIFICIAL INTELLIGENCE FOR MICROSCOPY AND BIOIMAGE ANALYSIS ANALYST’S SOCIETY

  Benchmarking LLMs

  Robert Haase

  Robert Haase

  These slides can be reused under the terms of the

  @haesleinhuepf

  70

  BIDS Lecture14/14 CC-BY 4.0 license unless mentioned otherwise.

  June 27th 2024'
downloads/12623730_14_Summary_slide65.png: 'Benchmarking vision models

  • Prompt: „Analyse the following image by counting the bright

  blobs. Respond with the number only. “ (n=25)

  Nov

  2023

  Apr

  2024 May

  2024

  Robert Haase

  https://haesleinhuepf.github.io/BioImageAnalysisNotebo

  @haesleinhuepf

  71

  BIDS Lecture14/14 oks/20c_vision_models/vision_models.html

  June 27th 2024'
downloads/12623730_14_Summary_slide66.png: 'CLIP scores

  • Example: Prompt optimization

  Always have

  a control

  experiment!

  Trying out different prompts

  Robert Haase

  @haesleinhuepf

  for generating pictures of cats 72

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_14_Summary_slide67.png: 'Testing functional correctness: HumanEval

  Publishing a new model

  + a new benchmark

  […]

  Robert Haase

  Source: Chen et al 2021

  @haesleinhuepf

  73

  BIDS Lecture14/14

  https://arxiv.org/abs/2107.03374

  June 27th 2024'
downloads/12623730_14_Summary_slide68.png: 'Modified from

  DS-1000

  stackoverflow

  „functional

  correctness“

  „surface-form

  constraints“

  Robert Haase

  @haesleinhuepf Source: cropped from Lai et al (2022), license CC-BY 4.0

  74

  BIDS Lecture14/14

  https://arxiv.org/abs/2211.11501

  June 27th 2024'
downloads/12623730_14_Summary_slide69.png: 'Exam

  • 45 min

  • 30 points

  • (< 30 questions)

  • Exam will cover the semester content accordingly

  • Bio-image Analysis / Microscopy

  • Machine/Deep Learning

  • Generative Artificial Intelligence

  • “closed book exam”

  Robert Haase https://dbs.uni-leipzig.de/files/2024-

  @haesleinhuepf

  02/Modulbeschreibung_BIDS_draft.pdf 75

  BIDS Lecture14/14

  June 27th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide1.png: 'CENTER FOR SCALABLE DATA
  ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Prompt Engineering, Retrieval

  Augmented Generation and Fine-Tuning

  Robert Haase

  Robert Haase

  @haesleinhuepf

  1

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide2.png: 'Quiz: Recap

  • The V in attention

  mechanisms stand

  for…?

  The word we are The word we The relevance The variance of

  determining are determining between the attention between

  attention from attention to two words the two words

  Robert Haase

  @haesleinhuepf

  2

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide3.png: 'Quiz: Recap

  • Function calling uses which format

  under the hood?

  English text Python JSON HTML

  Robert Haase

  @haesleinhuepf

  3

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide4.png: 'Prompt Engineering

  • Combining instruction and context

  Robert Haase

  Cropped from Sahoo et al 2024, licensed CC-BY 4.0

  @haesleinhuepf

  4

  BIDS Lecture11/14 https://arxiv.org/pdf/2402.07927

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide5.png: 'Prompt Engineering

  • Combining LLMs

  Prompt Prompt

  LLM LLM

  Engineering Engineering

  System prompt

  Output:

  User‘s input

  Response

  Robert Haase

  @haesleinhuepf

  5

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide6.png: 'Rephrase and respond prompting

  • Rephrasing prompts leads to increased accuracy.

  Robert Haase

  Source: Deng et al 2023

  @haesleinhuepf

  6

  BIDS Lecture11/14 https://arxiv.org/abs/2311.04205

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide7.png: 'Emotion prompting

  • Emotional prompts can lead to higher accuracy

  Robert Haase

  Cropped from Li et al 2023, licensed CC-BY 4.0

  @haesleinhuepf

  7

  BIDS Lecture11/14 https://arxiv.org/abs/2307.11760

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide8.png: 'Quiz:

  • Why might GPT4 and ChatGPT be different?

  Robert Haase

  @haesleinhuepf

  8

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide9.png: 'Emotion prompting

  • Side-note: Attention to prompts can be visualized

  Robert Haase

  Cropped from Li et al 2023, licensed CC-BY 4.0

  @haesleinhuepf

  9

  BIDS Lecture11/14 https://arxiv.org/abs/2307.11760

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide10.png: 'Chain-of-throught prompting

  „Let‘s think this

  • Demonstrating reasoning steps to the model

  step-by-step.“

  Robert Haase

  Cropped from Wei et al 2022, licensed CC-BY 4.0

  @haesleinhuepf

  10

  BIDS Lecture11/14 https://arxiv.org/abs/2201.11903

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide11.png: 'Chain-of-throught prompting

  Let‘s think this step-by-

  • Example: ChatGPT

  step seems part of the

  system-prompt

  Robert Haase

  @haesleinhuepf

  11

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide12.png: 'Chain-of-Knowledge

  • Introducing knowlege into the chain of thoughts.

  Robert Haase Cropped from Yu et al 2023, licensed CC-BY-

  @haesleinhuepf

  12

  BIDS Lecture11/14 SA 4.0 https://arxiv.org/abs/2306.06427

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide13.png: 'Self-consistency prompting

  • Prompting multiple times and keep the least conflicting result

  Robert Haase Cropped from Zhang et al 2022, licensed CC-BY 4.0

  @haesleinhuepf

  14

  BIDS Lecture11/14 https://arxiv.org/abs/2203.11171

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide14.png: 'Reflection

  • Iterating over tasks/solutions

  Robert Haase Cropped from Shinn et al 2023, licensed CC-

  @haesleinhuepf

  15

  BIDS Lecture11/14 BY 4.0 https://arxiv.org/abs/2303.11366

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide15.png: 'Reflection

  • Example task: Generate a Jupyter notebook

  Robert Haase

  @haesleinhuepf

  16

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide16.png: 'Reflection

  • Example task: Generate a Jupyter notebook

  Robert Haase

  @haesleinhuepf

  17

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide17.png: 'Retrieval Augmented Generation

  • Enriching a prompt with relevant context

  Query Document index Generator

  encoder

  Document A

  Document B

  MIPS

  Document C

  Query Prompt

  Document C

  x

  4

  q x

  3

  Maximum inner

  x

  2

  product search (MIPS)

  x

  1

  Robert Haase Read more: Lewis et al 2020

  @haesleinhuepf

  18

  https://arxiv.org/abs/2005.11401

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide18.png: 'Quiz: Retrieval Augmented
  Generation

  • Why inner product and not Euclidean distance?

  Maximum inner product search Nearest neighbor search

  Robert Haase Lewis et al 2020

  @haesleinhuepf

  19

  https://arxiv.org/abs/2005.11401

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide19.png: 'Retrieval Augmented Generation

  • Embeddings

  Robert Haase

  @haesleinhuepf

  20

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide20.png: 'Retrieval augmented generation

  0. Encode the knowledge base (code snippets)

  …

  Ideally permanently

  stored!

  Robert Haase

  @haesleinhuepf

  21

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide21.png: 'Retrieval augmented generation

  1. Encode the question

  Robert Haase

  @haesleinhuepf

  22

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide22.png: 'Retrieval augmented generation

  2. Identify related code-snippets

  Sorted by

  distance

  decending

  Robert Haase

  @haesleinhuepf

  23

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide23.png: 'Retrieval augmented generation

  3. Generate prompt

  Robert Haase

  @haesleinhuepf

  24

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide24.png: 'Retrieval augmented generation

  Without

  4. Retrieve answer RAG

  From our knowledge base

  Robert Haase

  @haesleinhuepf

  25

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide25.png: 'Fine-tuning

  • Long prompts due to prompt-engineering)

  • Response time 

  • Costs 

  [Domain]-specific

  • Fine-tuning a custom,

  training data

  Domain-specific

  model may help

  Pretrained [Domain]-specific

  Fine-tuning

  LLM LLM

  Robert Haase

  @haesleinhuepf

  26

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide26.png: 'Fine-tuning

  • Reinforcement learning from human feedback

  Robert Haase

  Cropped from Kaufmann et al CC-BY 4.0

  @haesleinhuepf

  27

  BIDS Lecture11/14 https://arxiv.org/abs/2312.14925

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide27.png: 'Fine-tuning

  • Reinforcement learning from human feedback

  Robert Haase

  @haesleinhuepf

  28

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide28.png: 'Fine-tuning

  • … may not be the right approach if:

  • All custom knowledge fits in one prompt

  • Knowledgebase is chaging frequently (-> RAG)

  • Function-calling does the job, additional knowledge can be acquired

  through function calls

  • … is a good idea to:

  • Configure general style / tone

  • Make the model produce specific desired output when using complex

  prompts

  • Introduce tasks that cannot be introduced using a prompt

  Robert Haase Read more:

  @haesleinhuepf

  29

  BIDS Lecture11/14 https://platform.openai.com/docs/guides/fine-tuning

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide29.png: 'Fine-tuning OpenAI‘s
  gpt-3.5-turbo

  • Upload training data

  Q&A pairs

  in JSON

  • Start fine-tuning job

  format

  • Test fine-tuned model

  Robert Haase

  @haesleinhuepf

  30

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide30.png: 'Fine-tuning OpenAI‘s
  gpt-3.5-turbo

  • Training data should include successful general/system prompts

  Complex general Expensive

  prompt

  Training

  fine-tuning

  sample 1

  Specific prompt

  through

  repetition

  Complex general

  • Inference with fine-tuned model

  Training prompt

  sample 2

  Specific prompt

  Specific prompt

  Complex general

  Cheaper inference as

  Specific prompt

  Training prompt

  the general prompt is

  sample 3

  Specific prompt

  Specific prompt

  „baked in“ the model

  Robert Haase Read more:

  @haesleinhuepf

  31

  BIDS Lecture11/14 https://platform.openai.com/docs/guides/fine-tuning

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide31.png: 'Fine-tuning OpenAI‘s
  gpt-3.5-turbo

  • Upload training data

  • Start fine-tuning job

  • Test fine-tuned model

  Robert Haase

  @haesleinhuepf

  32

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide32.png: 'Fine-tuning OpenAI‘s
  gpt-3.5-turbo

  • Upload training data

  • Start fine-tuning job

  • Test fine-tuned model

  Robert Haase

  @haesleinhuepf

  33

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide33.png: 'Fine-tuning OpenAI‘s
  gpt-3.5-turbo

  Robert Haase

  @haesleinhuepf

  34

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide34.png: 'Robert Haase

  @haesleinhuepf

  35

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide35.png: 'Fine-tuning OpenAI‘s
  gpt-3.5-turbo

  • Upload training data

  • Start fine-tuning job

  • Test fine-tuned model

  Robert Haase

  @haesleinhuepf

  36

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide36.png: 'Prompt

  engineering

  techniques

  Robert Haase

  Cropped from Sahoo et al 2024, licensed CC-BY 4.0

  @haesleinhuepf

  37

  BIDS Lecture11/14 https://arxiv.org/pdf/2402.07927

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide37.png: 'Quiz:

  • Assume I can enter my entire knowledge base into one

  very long prompt.

  • Why would it make sense to implement a RAG solution

  anyway?

  • Why would it make sense to fine-tune a custom model?

  • In what scenario would one prefer the RAG over fine-

  tuning a model?

  Robert Haase

  @haesleinhuepf

  38

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide38.png: 'CENTER FOR SCALABLE DATA
  ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Exercises

  Robert Haase

  Robert Haase

  @haesleinhuepf

  39

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide39.png: 'Exercise

  • Hint: you can enter the OpenAI API-key like this at the

  beginning of notebooks:

  Robert Haase

  @haesleinhuepf

  40

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide40.png: 'Exercise: Prompt engineering

  • Re-run image analysis code generation and elaborate on

  reproducibility.

  • Remove pieces from a knowledge base [or add new

  information] and see the impact on code generation

  Robert Haase

  @haesleinhuepf

  41

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide41.png: 'Exercise: Retrieval augmented
  generation

  • Compare generated code for complex tasks

  • Why does RAG work better / worse in this case?

  Robert Haase

  @haesleinhuepf

  42

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide42.png: 'Optional exercise: Fine-tuning

  • Only run the fine-tuning notebooks if you have a new

  knowledge base!

  • Fine-tuning is expensive

  and wastes resources if

  we all train a model

  based on the same data.

  Robert Haase

  @haesleinhuepf

  43

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_11_prompteng_rag_finetuning_slide43.png: 'Exercise: Comparing fine-tuned
  models

  • I fine-tuned two models for you based on different

  training datasets:

  • ft:gpt-3.5-turbo-0125:leipzig-university::9X7PFVgP

  (trained on question_answers_generated.txt)

  • ft:gpt-3.5-turbo-0125:leipzig-university::9X7CCzv4

  (trained on question_answers_hand_crafted.txt)

  Why do they perform differently?

  Robert Haase

  @haesleinhuepf

  44

  BIDS Lecture11/14

  June 11th 2024'
downloads/12623730_07_distributed_gpu_computing_slide1.png: 'CENTER FOR SCALABLE DATA
  ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Distributed & GPU-accelerated

  Image Processing

  Robert Haase

  Robert Haase These slides and the related training materials can be reused

  @haesleinhuepf under the terms of the CC-BY 4.0license.

  Slide 1

  BIDS Lecture7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide2.png: 'GPU accelerated image
  processing in life sciences

  … to study embryo development

  Tribolium castaneum Spot detection (3D) Theoretical membranes Neighbor mesh Average
  centroid distance

  nuclei-GFP, (pseudo Voronoi map) of neighbors

  Background subtracted

  0 µm 35

  RRoobbeerrtt HHaaaassee

  @@hhaaeesslleeiinnhhuueeppff

  https://clij.github.io/ SSlliiddee 33

  BBIIDDSS LLeeccttuurree 76//1144

  MMaayy 174thth 2 0220424'
downloads/12623730_07_distributed_gpu_computing_slide3.png: 'GPU accelerated image
  processing in life sciences

  Raytracing enables differentiating surface and sub-surface mesh nodes

  Surface neighbor Sub-surface

  Merge

  3D stack input Neighbor mesh mesh neighbor mesh

  RRoobbeerrtt HHaaaassee

  @@hhaaeesslleeiinnhhuueeppff

  https://clij.github.io/ SSlliiddee 44

  BBIIDDSS LLeeccttuurree 76//1144

  MMaayy 174thth 2 0220424'
downloads/12623730_07_distributed_gpu_computing_slide4.png: 'Image processing in life-sciences

  • State-of-the-art software for more than 20 years: ImageJ / Fiji

  D

  B

  S

  C

  /

  G

  B

  C

  -

  I

  P

  M

  ,

  b

  2x a

  l

  s

  r

  e

  y

  M

  ,

  le

  k

  r

  o

  V

  a

  le

  in

  a

  D

  :

  e

  c

  r

  u

  o

  s

  a

  t

  a

  d

  e

  g

  a

  m

  I

  Robert Haase

  @haesleinhuepf

  https://imagej.nih.gov/ij/ https://fiji.sc Slide 5

  BIDS Lecture 7/14 5

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide5.png: 'OpenCL-based GPU-acceleration

  GPU-acceleration? Learn the Open Computing Language (OpenCL)!

  Maximum

  intensity

  projection

  along Z

  Robert Haase

  OpenCL: https://www.khronos.org/opencl/

  @haesleinhuepf

  Slide 6

  BIDS Lecture 7/14 6

  May 14th 2024 Kernel collection: https://github.com/clEsperanto/clij-opencl-kernels'
downloads/12623730_07_distributed_gpu_computing_slide6.png: 'User-friendly GPU-acceleration

  D

  B

  S

  C

  /

  G

  B

  C

  -

  I

  P

  M

  ,

  b

  a

  2x

  l

  s

  r

  e

  y

  M

  ,

  le

  k

  r

  o

  V

  a

  le

  in

  a

  D

  :

  e

  c

  r

  u

  o

  s

  a

  t

  a

  d

  e

  g

  a

  m

  I

  Robert Haase

  @haesleinhuepf https://clij.github.io/ Slide 7

  BIDS Lecture 7/14 7

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide7.png: 'GPU-accelerated image
  processing

  Performance depends on operation, image size, parameters, hardware, ….

  vs.

  2x Intel Xeon Silver Nvidia Quadro

  4110 P6000

  Intel Core i7-8650U Intel UHD 620 GPU

  Robert Haase

  @haesleinhuepf Haase et al. Nat Methods (2020),

  Slide 8

  BIDS Lecture 7/14 https://www.nature.com/articles/s41592-019-0650-1 8

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide8.png: 'GPU-accelerated image
  processing

  Performance depends on operation, image size, parameters, hardware, ….

  Robert Haase

  @haesleinhuepf Haase et al. Nat Methods (2020),

  Slide 9

  BIDS Lecture 7/14 https://www.nature.com/articles/s41592-019-0650-1 9

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide9.png: 'GPU-accelerated image
  processing

  Speedup compared to Laptop CPU

  • 8 MB (2D)

  • 64 MB (3D)

  Laptop Workstatio

  GPU n GPU

  Robert Haase

  @haesleinhuepf Haase et al. Nat Methods (2020),

  Slide 10

  BIDS Lecture 7/14 https://www.nature.com/articles/s41592-019-0650-1 1

  May 14th 2024

  0'
downloads/12623730_07_distributed_gpu_computing_slide10.png: 'Checklist: When does
  GPU-accelerated image

  processing make sense?

  In order to accelerate your image analysis workflow

  • The pre-existing workflow should be slow; ideally:

  (processing time / loading time) > 10,

  • a single processing step

  (rule of thumb: image size in GB x4)

  should fit in your graphics card memory,

  If you really want to get the most out of it, you should

  own a graphics card with GDDR6 memory (memory

  bandwidth > 400 Gb/s).

  Comparison: common DDR4 memory has a

  bandwidth of about 40 GB/s

  Robert Haase

  Disclosure: I don’t receive any money or

  @haesleinhuepf

  Slide 11

  BIDS Lecture 7/14 anything from any GPU vendor. 1

  May 14th 2024

  1'
downloads/12623730_07_distributed_gpu_computing_slide11.png: 'GPUs allow real-time
  image processing

  GPUs are specialised in processing, very fast thanks to many cores and fast

  memory access

  CPU GPU

  Core Core Core Core Core

  CPU GPU

  Core Core

  Core Core Core Core Core

  Memory Memory

  Core Core Core Core Core

  Core Core Core Core Core

  Core Core

  Core Core Core Core Core

  Hard drive

  Robert Haase

  @haesleinhuepf

  Slide 12

  BIDS Lecture 7/14 1

  May 14th 2024

  2'
downloads/12623730_07_distributed_gpu_computing_slide12.png: 'Data transfer takes
  time

  Data transfer is the bottle neck

  Push Pull

  data data

  Robert Haase

  @haesleinhuepf

  BIDht Stp Ls e:/ c/ tc ulij r. egi t 7h /u 1b 4.io/clij-benchmarking/benchmarking_operations_jmh
  Slide 13 1

  May 14th 2024

  3'
downloads/12623730_07_distributed_gpu_computing_slide13.png: 'Build workflows consisting
  of many operations

  GPU acceleration may suffer from data transfer between CPU and GPU

  Central Processing Unit (CPU) Graphics Processing Unit (GPU)

  Gaussian bGluarussian blur

  T

  i

  m Gaussian blur filter

  Gaussian blur filter

  e

  Robert Haase

  @haesleinhuepf

  https://clij.github.io/clij-benchmarking/benchmarking_workflow_spot_count Slide
  14

  BIDS Lecture 7/14 1

  May 14th 2024

  4'
downloads/12623730_07_distributed_gpu_computing_slide14.png: 'Optimal performance
  through smart memory

  management

  Example workflow processing a Drosophila melanogaster embryo, histone-

  GFP

  Load data Preprocessing Transformation Segmentation Save data

  Robert Haase

  @haesleinhuepf https://clij.github.io/ Slide 15

  BIDS Lecture 7/14

  Haase et al Nat Methods (2020)

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide15.png: 'Build workflows consisting
  of many operations

  GPU acceleration may suffer from data transfer between CPU and GPU

  Central Processing Unit (CPU) Graphics Processing Unit (GPU)

  Gaussian bGluarussian blur

  T

  i Gaussian blur filter

  m

  Gaussian blur filter

  e

  Difference of

  Gaussian blur filter

  Gaussian filter

  Gaussian blur filter

  Subtract

  Reslice

  Subtract

  Maximum projection

  Reslice

  Spot detection

  Maximum projection

  Spot detection

  Robert Haase

  @haesleinhuepf

  https://clij.github.io/clij-benchmarking/benchmarking_workflow_spot_count Slide
  16

  BIDS Lecture 7/14 1

  May 14th 2024

  6'
downloads/12623730_07_distributed_gpu_computing_slide16.png: 'CENTER FOR SCALABLE
  DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  GPU-accelerated Image Processing in

  Python: OpenCL / clesperanto

  Robert Haase

  Robert Haase These slides and the related training materials can be reused

  @haesleinhuepf under the terms of the CC-BY 4.0license.

  Slide 17

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide17.png: 'Python Jupyter Notebooks

  • Image processing using pyclesperanto

  @haesleinhuepf https://github.com/clEsperanto/pyclesperanto_prototype

  1

  8'
downloads/12623730_07_distributed_gpu_computing_slide18.png: 'Python Jupyter Notebooks

  • When working on the

  cluster / Jupyter Hub,

  consider using

  stackview instead of

  napari for inspecting

  images in 3D.

  @haesleinhuepf https://github.com/haesleinhuepf/stackview

  1

  9'
downloads/12623730_07_distributed_gpu_computing_slide19.png: 'CENTER FOR SCALABLE
  DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  GPU-accelerated Image Processing

  in Python: CUDA / cupy

  Robert Haase

  Robert Haase These slides and the related training materials can be reused

  @haesleinhuepf under the terms of the CC-BY 4.0license.

  Slide 20

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide20.png: 'cupy

  CUDA-based GPU-accelerated [image] data processing in Python

  Robert Haase

  @haesleinhuepf

  Slide 21

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide21.png: 'drop-in replacement
  for numpy and scipy

  The API of some cupy packages is close to the scipy/numpy API.

  This allows easy switching from scipy to cupy.

  • However, image data still needs to be

  pushed to GPU memory.

  Robert Haase

  @haesleinhuepf

  Slide 22

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide22.png: 'Common patterns

  To make code independent from cupy availablity, while minimizing if-else

  blocks, some common design patterns emerged:

  If this fails

  The same pattern works with scipy.ndimage

  because cupy is

  not installed,

  This will execute

  and xp will be

  available.

  We can still use

  np anyway.

  Robert Haase

  @haesleinhuepf

  Slide 23

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide23.png: 'Common patterns

  You can then call magic code like this, which will do different things

  depending on cupy-availability.

  • If cupy is available: • If cupy is not available:

  Robert Haase

  @haesleinhuepf

  Slide 24

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide24.png: 'Common patterns

  Some if-else blocks are hard to avoid • Stackview aims to be cupy/numpy agnostic

  Robert Haase

  @haesleinhuepf

  https://github.com/haesleinSlhideu 2e5pf/stac

  BIDS Lecture 7/14

  May 14th 2024 kview'
downloads/12623730_07_distributed_gpu_computing_slide25.png: 'Custom kernels

  CUDA is also just C. You can write custom cupy kernels using simple

  syntax.

  T represents the image type

  Input,

  output

  Function call

  parameters

  using cupy-

  Math / CUDA arrays as

  code parameters

  Robert Haase

  Read more:

  @haesleinhuepf

  Slide 26

  BIDS Lecture 7/14 https://docs.cupy.dev/en/stable/user_guide/kernel.html

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide26.png: 'Image Processing CPU
  vs. GPU

  Requires

  Performance versus compatibility

  OpenCL

  GPU

  Requires

  e

  Nvidia cupy1 cle2

  c

  n GPU

  Required for

  a

  m

  3D processing

  r

  o

  f Simple

  r

  e

  p ITK

  g

  n

  i

  s

  s

  e

  c

  o

  r Scikit-

  P

  image

  Device compatibility

  Robert Haase

  Logos may be subject to

  @haesleinhuepf

  copyright of the respective Slide 27

  BIDS Lecture 7/14

  May 14th 2024 open source communities'
downloads/12623730_07_distributed_gpu_computing_slide27.png: 'CENTER FOR SCALABLE
  DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Tiled image processing

  Robert Haase

  Robert Haase

  These slides and the related training materials can be reused

  @haesleinhuepf

  Slide 28

  under the terms of the CC-BY 4.0license.

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide28.png: 'Optimal performance
  through smart memory management

  The classical way of dealing with large image stacks…

  Load data Preprocessing

  Load data

  Load data

  Load data

  Load data

  Load data

  Robert Haase

  @haesleinhuepf

  Slide 29

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide29.png: 'Optimal performance
  through smart memory

  management

  The classical way of dealing with large image stacks… is suboptimal

  Load data Preprocessing

  Load data Preprocessing

  Load data Preprocessing

  Load data Preprocessing

  This strategy does not

  Load data Preprocessing just take long; it also

  costs a lot of memory!

  Load data Preprocessing

  Robert Haase

  @haesleinhuepf

  Slide 30

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide30.png: 'Optimal performance
  through smart memory management

  Processing time-point by time-point is more efficient!

  Load data Preprocessing Transformation Segmentation Save data

  Load data Preprocessing Transformation Segmentation Save data

  Load data Preprocessing Transformation Segmentation Save data

  This strategy also

  works tile-by-tile on

  large 3D stacks!

  Robert Haase

  @haesleinhuepf

  Slide 31

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide31.png: 'Optimal performance
  through smart memory management

  Even better: Distribute tasks between parallelized computation systems

  Load data Preprocessing Transformation Segmentation Save data

  Load data Preprocessing Transformation Segmentation Save data

  Load data Preprocessing Transformation Segmentation Save data

  Load data Preprocessing Transformation Segmentation Save data

  Load data Preprocessing Transformation Segmentation Save data

  Load data Preprocessing Transformation Segmentation Save data

  Robert Haase

  @haesleinhuepf

  Slide 32

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide32.png: 'Optimal performance
  through smart memory

  management

  Even better: Distribute tasks between parallelized computation systems

  For this strategy, Save data

  advanced

  programming skills are

  Save data

  necessary.

  Save data

  … yet.

  Segmentation Save data

  pyopencl /

  Transformation Segmentation Save data

  clesperanto

  Preprocessing Transformation Segmentation Save data

  Robert Haase

  @haesleinhuepf https://www.python.org/

  https://www.dask.org/httpsS:/li/dcuep 3y3.dev

  BIDS Lecture 7/14

  https://clesperanto.net

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide33.png: 'Tiling

  The last perimeter against big data

  If the image is too large for the computer

  memory, image processing as a whole is not

  possible.

  Processing tile-by-tile poses new

  challenges

  Robert Haase

  @haesleinhuepf

  Slide 34

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide34.png: 'Tiling

  Optimal margin size

  Example: Gaussian blur (sigma = 20)

  depends on algorithm

  Solution: Process with overlapping tiles (size + margin) and its parameters

  Margin: 0 pixels Margin: 10 pixels Margin: 20 pixels

  Robert Haase

  @haesleinhuepf

  Slide 35

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide35.png: 'Tiling

  Computation time

  Example: Gaussian blur (sigma = 20 pixels) depends on tile size and

  margin width

  Solution: Process with overlapping tiles (size + margin)

  Margin: 20 pixels

  Size: 5x original

  Margin: 10 pixels

  Size: 2.7x original

  Tile

  32x32 pixels

  52x52 pixels

  72x72 pixels

  Robert Haase

  @haesleinhuepf

  Slide 36

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide36.png: 'Tiling

  Checking which labels

  Some algorithms are hard to solve by processing tiles

  touch and combine

  them is feasible.

  Example: Connected component analysis

  Robert Haase

  @haesleinhuepf

  Slide 37

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide37.png: 'Tiling

  There are algorithms for

  Some algorithms are hard to solve by processing tiles

  that, but hardly available

  tools.

  Example: Connected component analysis

  Robert Haase

  @haesleinhuepf

  Slide 38

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide38.png: 'Tiled image processing
  in Python

  Key: tiled file formats, for parallel, distributed, lazy loading

  After executing

  this, no pixel has

  been read yet.

  Robert Haase

  @haesleinhuepf

  Slide 39

  BIDS Lecture 7/14 3

  May 14th 2024

  9'
downloads/12623730_07_distributed_gpu_computing_slide39.png: 'Tiled image processing
  in Python

  Key: tiled file formats, for parallel, distributed, lazy loading

  Robert Haase Figure taken from Moore et al, licensed CC-BY 4..0

  @haesleinhuepf

  https://www.biorxiv.org/content/10.1101/2023.02.17.528 Slide 40

  BIDS Lecture 7/14

  May 14th 2024 834v4.full.pdf'
downloads/12623730_07_distributed_gpu_computing_slide40.png: 'Tiled image processing
  in Python

  Lazy processing

  After executing After that,

  this, no pixel has results are

  been read yet. avaialble

  Robert Haase

  @haesleinhuepf

  Slide 41

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide41.png: 'Tiling with/out overlap

  Processing of images in tiles: artifacts ad tile borders

  Robert Haase

  @haesleinhuepf

  Slide 42

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide42.png: 'Tiling with/out overlap

  Processing of images in tiles: artifacts ad tile borders

  Robert Haase

  @haesleinhuepf

  Slide 43

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide43.png: 'CENTER FOR SCALABLE
  DATA ANALYTICS

  AND ARTIFICIAL INTELLIGENCE

  Methods for comparing

  measurement methods

  Robert Haase

  Using materials Reusing materials from Daniela Vorkel,

  Douglas G. Altman and J. Martin Bland

  Robert Haase

  @haesleinhuepf

  Slide 44

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide44.png: 'Method comparison studies

  Scenario

  • You work in a lab and try to improve procedures Unpaired data

  • Analyze independent sample sets

  • Chemical protocols

  • Conclude about their similarity or relationship

  • Sample preparation

  • Analysis protocols Inferential statistics

  • Physical measurements

  • Image analysis

  Paired data

  • The same dataset analyzed twice with different methods

  • The same dataset analyzed twice with the same method

  Direct method comparison –descriptive statistics

  Robert Haase

  @haesleinhuepf

  Slide 45

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide45.png: 'Method comparison studies

  Martin Bland and Douglas Altman work on Method Comparison (excerpt)

  Copyright J. Martin Bland and Douglas G. Altman.

  Robert Haase

  @haesleinhuepf https://www-users.york.ac.uk/~mb55/meas/ab83.pdf (Open Access)

  Slide 46

  BIDS Lecture 7/14 https://doi.org/10.1016/S0140-6736(86)90837-8

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide46.png: 'Comparison of means

  Comparing mean measurements appears reasonable on the first view.

  Difference of Method A

  means

  Method B

  ΔV = 100 µm³

  y

  c

  n

  e

  u

  q

  e

  r

  F

  500 600 700

  µm³ µm³ µm³

  Cell volume V

  Robert Haase

  @haesleinhuepf

  Slide 47

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide47.png: 'Comparison of means

  Are two methods doing the same if their mean measurement is similar?

  What if mean values were

  “very” different?

  Method B cannot

  Similar means is a

  replace method A

  necessary condition,

  but is it sufficient?

  Robert Haase

  @haesleinhuepf

  Slide 48

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide48.png: 'Comparison of means

  Are two methods doing the same if their mean measurement is similar?

  • Draw histograms! How can two methods do the same if histograms from their

  measurements are different?

  t

  t n

  n

  u

  u

  o

  o

  C

  C

  Measurement A Measurement B

  Similar means is a

  The scientific method: Show that a method

  necessary condition,

  doesn’t work with just one example. And you

  but it is NOT sufficient!

  have proven that the method doesn’t work

  Robert Haase

  @haesleinhuepf in general. Slide 49

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide49.png: 'Correlation

  Are two methods doing the same if they correlate?

  • Correlation: Any kind of relationship.

  • Measurable; e.g. using Pearson''s Correlation Coefficient r enumerated linear
  correlation.

  Comparison of two methods of measuring

  systolic blood pressure (Data taken from 1) Expectation E Mean average µ

  𝐸(𝑋 − 𝜇 )(𝑌 − 𝜇 )

  𝑋 𝑦 Standard

  𝑟(𝑋, 𝑌) =

  𝜎 𝜎 deviation σ

  𝑋 𝑌

  y

  In practice E is the weighted sum:

  Number of

  𝑥 − 𝜇 𝑦 − 𝜇 measurements

  σ 𝑋 𝑌

  𝑥∈𝑋,𝑦∈𝑌 𝑛

  n

  𝑟(𝑋, 𝑌) =

  𝜎 𝜎

  𝑋 𝑌

  x

  Robert Haase

  @haesleinhuepf

  1 Altman & Bland, The Statistician 32, 1983 Slide 50

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide50.png: 'Correlation

  Are two methods doing the same if they correlate?

  • Correlation: Any kind of relationship.

  • Measurable; e.g. using Pearson''s Correlation Coefficient r enumerated linear
  correlation.

  Comparison of two methods of measuring

  systolic blood pressure (Data taken from 1)

  2

  t

  n

  e

  m

  e

  r

  u

  s

  a

  e

  M

  𝑥 − 𝜇 𝑦 − 𝜇

  σ 𝑋 𝑌

  𝑥∈𝑋,𝑦∈𝑌 𝑛

  𝑟(𝑋, 𝑌) = = 0.94

  𝜎 𝜎

  𝑋 𝑌

  Measurement 1

  Robert Haase

  @haesleinhuepf

  1 Altman & Bland, The Statistician 32, 1983 Slide 51

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide51.png: 'Correlation: Pearson’s
  r

  f

  f

  2-dimensional normal e

  o

  Pearson’s r lies between -1 and 1

  distribution c

  _

  n

  • 1: Positive linear correlation o

  i

  t

  • 0: No linear correlation a g

  l v

  e

  • -1: Negative linear correlation s

  r .

  r 2

  o

  s

  c e

  _ l

  n p

  o m

  s

  a

  r

  a x

  e e

  P _

  n

  /

  i o

  k

  i

  i t

  w

  a

  / l

  g e

  r r

  o r

  o

  .

  a C

  i :

  d e

  e l

  i

  p F

  i /

  k a

  i i

  w d

  . e

  n m

  e

  / /

  / #

  Robert Haase : s t

  n

  @haesleinhuepf p

  Slide 52 e

  BIDS Lecture 7/14 t

  t i

  May 14th 2024 h c

  i'
downloads/12623730_07_distributed_gpu_computing_slide52.png: 'Correlation

  Are two methods doing the same if they correlate?

  • Correlation: Any kind of relationship.

  • Measurable; e.g. using Pearson''s Correlation Coefficient r enumerated linear
  correlation.

  Comparison of two methods of measuring The scientific method: Show that a

  systolic blood pressure (Data taken from 1) method doesn’t work with just one

  example. And you have proven that

  the method doesn’t work in general.

  2

  t Measurement 1 is

  n

  e almost always larger

  m

  e than measurement 2

  r

  u

  s

  a “Positive linear correlation”

  e

  M

  𝑥 − 𝜇 𝑦 − 𝜇

  σ 𝑋 𝑌

  𝑥∈𝑋,𝑦∈𝑌 𝑛

  𝑟(𝑋, 𝑌) = = 0.94

  𝜎 𝜎

  𝑋 𝑌

  Measurement 1

  Robert Haase

  @haesleinhuepf

  1 Altman & Bland, The Statistician 32, 1983 Slide 53

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide53.png: 'Correlation

  In order to evaluate the difference between two methods, you should visualize them
  first.

  “The purpose of computing is insight, not numbers.”, Richard Hamming

  Scatter plot Bland-Altman plot

  2

  t

  n t

  f n

  e o

  e

  m

  e m

  e c

  r n e

  u e r

  u

  s r

  a e s

  e f a

  f e

  M i

  D m

  Measurement 1

  Average measurement

  Robert Haase

  @haesleinhuepf

  1 Altman & Bland, The Statistician 32, 1983 Slide 54

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide54.png: 'The confidence interval

  “The British Standards Institution (1979) define a coefficient of

  repeatability as ‘the value below which the difference between two single

  test results ... may be expected to lie with a specified probability; in the

  absence of other indications, the probability is 95 per cent’.”1

  The confidence interval CI of agreement t

  f n

  o

  e

  e m

  c

  n e

  e r

  u

  r

  𝐶𝐼 = (𝜇 − 2𝜎, 𝜇 + 2𝜎) e s

  f a

  f e

  i

  D m

  Mean Standard deviation

  difference of differences

  The mean difference between Average measurement

  the methods (“offset”)

  Robert Haase

  @haesleinhuepf

  1 Altman & Bland, The Statistician 32, 1983 Slide 55

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide55.png: 'Bland-Altman plots in
  practice

  Depending on the shape of the point-cloud, different systematic bias

  might be present.

  Agreement with a given

  Absolute error or “offset” Relative error

  random error

  Robert Haase

  @haesleinhuepf https://haesleinhuepf.github.io/BioImageAnalysisNotebooks/41_descriptive_stati

  Slide 56

  BIDS Lecture 7/14 5

  stics/bland_altman_simulated_data.html

  May 14th 2024

  6'
downloads/12623730_07_distributed_gpu_computing_slide56.png: 'Bland-Altman plots in
  practice

  Comparison: ImageJ versus GPU-accelerated script

  to measure intensity in the nuclear envelope of a

  nucleus

  Scatter plot Bland-Altman plot

  Dani Vorkel

  (Myers lab)

  @happifocus

  Robert Haase

  @haesleinhuepf Source: Vorkel and Haase (2022), licensed CC-BY 4.0

  Slide 57

  BIDS Lecture 7/14 https://link.springer.com/chapter/10.1007/978-3-030-76394-7_5
  5

  May 14th 2024

  7'
downloads/12623730_07_distributed_gpu_computing_slide57.png: 'CENTER FOR SCALABLE
  DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Exercises

  Robert Haase

  Robert Haase

  These slides and the related training materials can be reused

  @haesleinhuepf

  Slide 58

  under the terms of the CC-BY 4.0license.

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide58.png: 'Exercise: GPU-accelerated
  image processing

  Compare CPU processing speed with a GPU

  Robert Haase

  @haesleinhuepf

  Slide 59

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide59.png: 'Exercise: Tiled image
  processing

  Apply background-

  removal to an image

  in tiles. Determine

  the overlap width

  that‘s necessary to

  have artifact-free

  results.

  Robert Haase

  @haesleinhuepf

  Slide 60

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_07_distributed_gpu_computing_slide60.png: 'Exercise: Bland-Altman
  plots

  Compare two measurement libraries: scikit-image versus SimpleITK

  Robert Haase

  @haesleinhuepf

  Slide 61

  BIDS Lecture 7/14

  May 14th 2024'
downloads/12623730_06_Chatbots_slide1.png: 'CENTER FOR SCALABLE DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Prompt Engineering & ChatBots

  Robert Haase

  Robert Haase These slides and the related training materials can be reused

  @haesleinhuepf under the terms of the CC-BY 4.0license.

  Slide 1

  BIDS Lecture6/14

  May7th 2024'
downloads/12623730_06_Chatbots_slide2.png: 'Quiz: Recap

  How is this operation called?

  ?

  Simplifaction Smoothing Blurring Tresholding

  Robert Haase

  @haesleinhuepf

  Slide 2

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide3.png: 'Quiz: Recap

  What does this

  parametric image

  show?

  Feret’s

  Area Aspect Ratio diameter Temperature

  Robert Haase

  @haesleinhuepf

  Slide 3

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide4.png: 'Quiz: Code generators

  Who writes your code?

  Github Other

  ChatGPT Copilot LLMs I myself

  Robert Haase

  @haesleinhuepf

  Slide 4

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide5.png: 'Artificial intelligence in daily programmer’s
  life

  How it started

  How it’s going

  (GitHub copilot)

  Robert Haase

  @haesleinhuepf 5

  Slide 5

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide6.png: 'What are large language models good in?

  Translation tasks

  Robert Haase

  @haesleinhuepf https://scads.github.io/prompt-engineering-

  Slide 6

  BIDS Lecture 6/14

  tutorial-2023/01_prompts/02_use_cases.html

  May 7th 2024'
downloads/12623730_06_Chatbots_slide7.png: 'What are large language models good in?

  Restructuring data

  Robert Haase

  @haesleinhuepf https://scads.github.io/prompt-engineering-

  Slide 7

  BIDS Lecture 6/14

  tutorial-2023/01_prompts/02_use_cases.html

  May 7th 2024'
downloads/12623730_06_Chatbots_slide8.png: 'What are large language models not so

  good in?

  Querying knowledge (e.g. for recent information)

  Robert Haase

  @haesleinhuepf https://scads.github.io/prompt-engineering-

  Slide 8

  BIDS Lecture 6/14

  tutorial-2023/01_prompts/02_use_cases.html

  May 7th 2024'
downloads/12623730_06_Chatbots_slide9.png: 'What are large language models not so
  good in?

  Math (e.g. counting)

  Robert Haase

  @haesleinhuepf https://scads.github.io/prompt-engineering-

  Slide 9

  BIDS Lecture 6/14

  tutorial-2023/01_prompts/02_use_cases.html

  May 7th 2024'
downloads/12623730_06_Chatbots_slide10.png: 'What are large language models not so
  good in?

  Math (e.g. counting)

  No matter if anyone

  manages to fix that, we

  will have a hard time to

  convince the community

  that this is the way to go.

  Robert Haase

  @haesleinhuepf

  Slide 10

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide11.png: 'Prompt Engineering

  • Set context / assign role

  • Define output style

  • Give hints / conditions

  • List tasks

  • Provide data

  Robert Haase

  @haesleinhuepf https://scads.github.io/prompt-engineering-tutorial-

  Slide 11

  BIDS Lecture 6/14 2023/01_prompts/03_prompt_engineering.html

  May 7th 2024'
downloads/12623730_06_Chatbots_slide12.png: 'Prompt Engineering

  • Set context / assign role

  • Define output style

  • Give hints / conditions

  • List tasks

  • Provide data

  Robert Haase

  @haesleinhuepf https://scads.github.io/prompt-engineering-tutorial-

  Slide 12

  BIDS Lecture 6/14 2023/01_prompts/03_prompt_engineering.html

  May 7th 2024'
downloads/12623730_06_Chatbots_slide13.png: 'Prompt Engineering

  • Set context / assign role

  • Define output style

  • Give hints / conditions

  • List tasks

  • Provide data

  Robert Haase

  @haesleinhuepf https://scads.github.io/prompt-engineering-tutorial-

  Slide 13

  BIDS Lecture 6/14 2023/01_prompts/03_prompt_engineering.html

  May 7th 2024'
downloads/12623730_06_Chatbots_slide14.png: 'Prompt Engineering

  • Set context / assign role

  • Define output style

  • Give hints / conditions

  • List tasks

  • Provide data

  Robert Haase

  @haesleinhuepf https://scads.github.io/prompt-engineering-tutorial-

  Slide 14

  BIDS Lecture 6/14 2023/01_prompts/03_prompt_engineering.html

  May 7th 2024'
downloads/12623730_06_Chatbots_slide15.png: 'Prompt Engineering

  • Set context / assign role

  • Define output style

  • Give hints / conditions

  • List tasks

  • Provide data

  Robert Haase

  @haesleinhuepf https://scads.github.io/prompt-engineering-tutorial-

  Slide 15

  BIDS Lecture 6/14 2023/01_prompts/03_prompt_engineering.html

  May 7th 2024'
downloads/12623730_06_Chatbots_slide16.png: 'Context length

  Robert Haase

  @haesleinhuepf Visualization by Greg Kamradt, Licensed MIT (modified), Source:

  Slide 16

  BIDS Lecture 6/14 https://github.com/gkamradt/LLMTest_NeedleInAHaystack

  May 7th 2024'
downloads/12623730_06_Chatbots_slide17.png: 'Context length

  Robert Haase

  @haesleinhuepf Visualization by Greg Kamradt, Licensed MIT (modified), Source:

  Slide 17

  BIDS Lecture 6/14 https://github.com/gkamradt/LLMTest_NeedleInAHaystack

  May 7th 2024'
downloads/12623730_06_Chatbots_slide18.png: 'Generating images

  Prompts can be used to write code, but also to generate images, e.g. with DALL-E.

  One can generate quite realistic images given a detailed prompt.

  One cat

  is real.

  Robert Haase

  @haesleinhuepf https://scads.github.io/prompt-engineering-tutorial-

  Slide 18

  BIDS Lecture 6/14 2023/01_prompts/04_generating_images.html

  May 7th 2024'
downloads/12623730_06_Chatbots_slide19.png: 'Prompt engineering

  The more detailed the prompt, the more similar are generated images.

  One cat

  is real.

  Robert Haase

  @haesleinhuepf https://scads.github.io/prompt-engineering-tutorial-

  Slide 19

  BIDS Lecture 6/14 2023/01_prompts/04_generating_images.html

  May 7th 2024'
downloads/12623730_06_Chatbots_slide20.png: 'The OpenAI Application Programming Interface

  De-facto standard for communicating with LLMs

  Robert Haase

  @haesleinhuepf

  Slide 20

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide21.png: 'The OpenAI Application Programming Interface

  Request Response

  Robert Haase

  @haesleinhuepf

  Slide 21

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide22.png: 'Open Source models providers to try

  Blablador (free for German academics!) Ollama (runs on your computer!)

  https://helmholtz-blablador.fz-juelich.de/ https://ollama.com/

  Robert Haase

  @haesleinhuepf

  Slide 22

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide23.png: 'Important note

  Whatever you enter in ChatGPT, any other LLMS or the

  OpenAI API connected with remote servers will be sent

  over the internet to people you don‘t know.

  DO NOT enter private / personal information.

  Robert Haase

  @haesleinhuepf

  Slide 23

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide24.png: 'Today

  15:15-16:30 Short lecture + short practicals (SG 312)

  Afterwards:

  Robert Haase https://www.meetup.com/de-DE/big-data-

  @haesleinhuepf

  Slide 24

  BIDS Lecture 6/14 and-ai-saxony/events/300284128/

  May 7th 2024'
downloads/12623730_06_Chatbots_slide25.png: 'CENTER FOR SCALABLE DATA ANALYTICS AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Exercises

  Robert Haase

  Robert Haase

  These slides and the related training materials can be reused

  @haesleinhuepf

  Slide 25

  under the terms of the CC-BY 4.0license.

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide26.png: 'Option: Use Ollama

  Download and install Ollama

  Download a model, e.g. using

  ollama run gemma:2b

  Start the server using

  ollama serve

  Robert Haase

  @haesleinhuepf

  Slide 26

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide27.png: 'Option: Get a Blablador API Key

  Yes, this is free for German academics.

  Robert Haase https://sdlaml.pages.jsc.fz-

  @haesleinhuepf

  juelich.de/ai/guides/blablador_api_access/ Slide 27

  BIDS Lecture 6/14

  May 7th 2024 https://codebase.helmholtz.cloud/users/sign_in'
downloads/12623730_06_Chatbots_slide28.png: 'Option: Get a Blablador API Key

  Yes, this is free for German academics.

  Robert Haase https://sdlaml.pages.jsc.fz-

  @haesleinhuepf

  juelich.de/ai/guides/blablador_api_access/ Slide 28

  BIDS Lecture 6/14

  May 7th 2024 https://codebase.helmholtz.cloud/users/sign_in'
downloads/12623730_06_Chatbots_slide29.png: 'Option: Get an OpenAI API key from OpenAI

  Yes, this costs money.

  Robert Haase

  @haesleinhuepf

  https://openai.com/blog/openai-api Slide 29

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide30.png: 'Optional: Store the API key in your environment

  Add the API Key to your environment variables

  4

  2

  3

  1

  Robert Haase

  @haesleinhuepf

  Slide 30

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide31.png: 'Alternative: Jupyter Lab @ SC / URZ /
  Uni Leipzig

  Go to the Jupyter hub and setup your session

  Robert Haase

  @haesleinhuepf

  Slide 31

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide32.png: 'Exercise: Make your chosen LLM work

  ChatGPT / Blablador / Ollama

  Robert Haase

  @haesleinhuepf

  Slide 32

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide33.png: 'Exercise: Text generation

  Reproduce the prompts stored in the Jupyter Notebooks

  Robert Haase

  @haesleinhuepf

  Slide 33

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_06_Chatbots_slide34.png: 'Exercise: ChatBots

  Make this ChatBot more friendly.

  Turn it into a Python expert.

  Robert Haase

  @haesleinhuepf

  Slide 34

  BIDS Lecture 6/14

  May 7th 2024'
downloads/12623730_09_Deep_Learning_slide1.png: 'CENTER FOR SCALABLE DATA ANALYTICS
  AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Deep Learning for Bio-image Analysis

  Robert Haase

  Robert Haase

  @haesleinhuepf These slides and the related training materials can be reused

  Slide 1

  BIDS Lecture9/14 under the terms of the CC-BY 4.0license.

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide2.png: '9.]

  1

  0

  2

  ,s

  Machine learning for image analysis d

  o

  h

  t

  e

  M

  e

  r

  In classical machine learning, we typically select features for training our classifier
  u t

  a

  N

  ,.la

  t

  e

  o

  d

  e

  c

  ia

  C

  (

  n

  o

  it

  c

  e

  llo

  C

  k

  r

  a

  m

  h

  c

  n

  e

  B

  e

  g

  a

  m

  io

  iB

  ?

  d

  a

  o

  r

  B

  e

  h

  t

  m

  o

  r

  f

  e

  lb

  a

  lia

  v

  a

  1 ,

  v

  8

  3

  0

  C

  B

  B

  B

  :e

  Convolutions c

  r

  u

  o

  s

  Robert Haase

  a

  t

  @haesleinhuepf a

  Slide 2 d

  BIDS Lecture 9/14 e

  g

  May 28st 2024 a

  m

  I'
downloads/12623730_09_Deep_Learning_slide3.png: '.]9

  1

  0

  2

  ,s

  Outlook: Deep learning for image analysis d

  o

  h

  t

  e

  M

  e

  r

  u

  t

  a

  N

  In deep learning, this selection ,.la

  t

  e

  o

  becomes part of the black box d

  e

  c

  ia

  C

  (

  n

  o

  it

  c

  e

  llo

  C

  k

  r

  a

  m

  h

  c

  n

  e

  B

  e

  g

  a

  m

  io

  iB

  _ ?

  d

  a

  o

  r

  B

  e

  h

  t

  m

  o

  r

  f

  e

  lb

  a

  lia

  v

  a

  1 ,

  v

  8

  3

  Convolutional neural 0

  C

  B

  B

  networks B

  :e

  c

  r

  u

  o

  s

  Robert Haase

  a

  t

  @haesleinhuepf a

  Slide 3 d

  BIDS Lecture 9/14 e

  g

  May 28st 2024 a

  m

  I'
downloads/12623730_09_Deep_Learning_slide4.png: 'Neural networks

  • How biologists see neurons • How computer scientists see neurons

  “perceptron”

  Bias

  b

  Activation

  x w function

  1 1

  s t

  t x w u

  u 2 2 𝛴 f y p

  p

  t

  n u

  I O

  x w

  3 3

  Weights

  𝑦

  = 𝑓 𝑤 1𝑥 + 𝑤 𝑥 + 𝑤 𝑥 + 𝑏

  1 2 2 3 3

  Robert Haase Neuron image source:

  @haesleinhuepf https://commons.wikimedia.org/wiki/File:Blausen_0657_MultipolarNeuron.png

  Slide 4

  BIDS Lecture 9/14 Licensed CC-BY 3.0 by BruceBlaus

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide5.png: 'Neural Networks

  • Early form: “Multilayer Perceptron” If there are many hidden

  • fully connected class of feedforward artificial neural network layers, we speak
  of a

  deep neural network

  Input layer Hidden layer(s) Output layer

  Robert Haase

  @haesleinhuepf https://en.wikipedia.org/wiki/Multilayer_perceptron

  Slide 5

  BIDS Lecture 9/14

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide6.png: 'Convolutional neural networks

  • Layer types

  Fully connected layer

  Robert Haase

  @haesleinhuepf

  Slide 6

  BIDS Lecture 9/14

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide7.png: 'Convolutional neural networks

  • Layer types

  Fully connected layer Convolutional layer

  Field

  of

  view

  Robert Haase

  @haesleinhuepf

  Slide 7

  BIDS Lecture 9/14

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide8.png: 'Deep Learning for Microscopy

  Robert Haase Source: Ricardo Henriques lab,

  @haesleinhuepf

  https://github.com/HenriquesLab/ZeroCostDL4Mic/blob/mast Slide 16

  BIDS Lecture 9/14

  er/Wiki_files/FigureS2.png license: MIT

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide9.png: 'Trade-offs in live-cell imaging

  Light exposure

  Light Exposure

  Speed

  Speed

  Spatial Resolution

  Spatial resolution

  Robert Haase

  Slide adapted from / courtesy of

  @haesleinhuepf

  Slide 17

  BIDS Lecture 9/14

  Martin Weigert, EPFL Lausanne

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide10.png: 'The U-net

  Encoder Decoder

  Skip

  connections

  „bottleneck“, „embedding“,

  „manifold“

  Robert Haase Ronneberger (2015)

  Source: Ronneberger (2015)

  @haesleinhuepf

  Slide 18

  BIDS Lecture 9/14

  https://arxiv.org/pdf/1505.04597.pdf

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide11.png: 'Image denoising: CARE

  • Content aware image restoration (CARE)

  Pair of

  • Image acquisition of pairs of images: A high-quality and a low-quality image.

  images

  • Problem: shot noise, biology moves!

  required!

  Source:

  Robert Haase

  @haesleinhuepf https://github.com/CSBDeep/CSBDeep/blob/main/examples

  Slide 19

  BIDS Lecture 9/14

  /denoising2D/2_training.ipynb, License: BSD3

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide12.png: 'Image denoising: CARE

  • Important to use on the same conditions/structures/staining that the networks

  were trained on!

  Trained on:

  Applied to:

  t

  u

  p

  n

  I

  n

  o

  i

  t

  c

  i

  d

  e

  r

  P

  d

  n h

  u t

  u

  o

  r

  r t

  G

  Robert Haase

  @haesleinhuepf

  Slide 20

  BIDS Lecture 9/14

  Slide adapted from: Martin Weigert, EPFL Lausanne

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide13.png: 'Noise2noise

  Source: Noise2Noise: Learning Image Restoration without Clean Data

  Robert Haase

  Jaakko Lehtinen, Jacob Munkberg, Jon Hasselgren, SamuliLaine, Tero

  @haesleinhuepf

  Karras, MiikaAittala, Timo Aila Slide 21

  BIDS Lecture 9/14

  https://arxiv.org/abs/1803.04189

  May 28st 2024

  https://github.com/NVlabs/noise2noiseLicense: CC-BY-NC 4.0'
downloads/12623730_09_Deep_Learning_slide14.png: 'Noise2noise

  • by Nvidia (Lehtinen

  2018)

  https://arxiv.org/pdf

  /1803.04189.pdf

  Robert Haase

  Slide adapted from Alexander Krull (MPI CBG,

  @haesleinhuepf

  Slide 22

  BIDS Lecture 9/14 now at U. Birmingham)

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide15.png: 'Noise2void

  Image denoising without image pairs

  Robert Haase

  Source: A.Krull et al.

  @haesleinhuepf

  Slide 23

  BIDS Lecture 9/14

  https://arxiv.org/pdf/1811.10980

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide16.png: 'Noise2void

  • Noise2void: Krull et al

  (2019)

  https://arxiv.org/abs/18

  11.10980

  • Noise2self: Batson and

  Royer (2019)

  https://arxiv.org/abs/19

  01.11365

  Robert Haase

  Slide adapted from Alexander Krull (MPI CBG,

  @haesleinhuepf

  Slide 24

  BIDS Lecture 9/14

  now at U. Birmingham)

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide17.png: 'Noise2void

  „Blind-spot-network“

  Robert Haase

  Source: A.Krull et al.

  @haesleinhuepf

  Slide 25

  BIDS Lecture 9/14

  https://arxiv.org/pdf/1811.10980

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide18.png: 'Noise2void

  Napari-plugin

  Robert Haase

  Source: https://github.com/juglab/napari-n2v

  @haesleinhuepf

  Slide 26

  BIDS Lecture 9/14 License: BSD-3

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide19.png: 'Image denoising

  • Noise2Void

  Robert Haase

  Data by Stephanie Heinrich

  @haesleinhuepf

  Slide 27

  BIDS Lecture 9/14

  Slide adapted from: Alexander Krull, MPI CBG

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide20.png: 'StarDist: Nuclei segmentation

  Advanced algorithms are necessary when nuclei

  become too dense.

  Robert Haase Source: Ricardo Henriques lab,

  @haesleinhuepf

  https://github.com/HenriquesLab/ZeroCostDL4Mic/blob/mast Slide 28

  BIDS Lecture 9/14

  er/Wiki_files/Stardist_nuclei_masks.png license: MIT

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide21.png: 'Class. Image proc.

  StarDist

  • Prediction of probable object centers + polygon outlines Deep learning

  • Non-maximum-suppression of less likely polygons

  Object probabilities

  Input Ground truth

  Directional distance maps (32x)

  Robert Haase

  Slide adapted from: Martin Weigert, EPFL Lausanne and

  @haesleinhuepf

  Slide 29

  BIDS Lecture 9/14from https://github.com/stardist/stardist (license: BSD3)

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide22.png: 'StarDist

  • Prediction of probable object centers + polygon outlines

  • Non-maximum-suppression of less likely polygons

  Final segmentation

  Object probabilities Polygon candidates

  Directional distance maps

  Robert Haase

  Slide adapted from: Martin Weigert, EPFL Lausanne and

  @haesleinhuepf

  Slide 30

  BIDS Lecture 9/14from https://github.com/stardist/stardist (license: BSD3)

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide23.png: 'F3o1oter

  StarDist: Limitations

  Star-convex shapes!

  Good for nuclei, bad for cells.

  Robert Haase

  @haesleinhuepf

  Slide 31

  BIDS Lecture 9/14

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide24.png: 'StarDist: Python

  Initialize model / download pretrained model Apply model

  Normalize intensity to range [0, 1]

  Robert Haase

  @haesleinhuepf

  Slide 32

  BIDS Lecture 9/14

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide25.png: 'StarDist: Business model

  Serving clinical sicentists using software based on open-source code

  Robert Haase

  @haesleinhuepf https://katana-labs.com/paikon-diagnostics/

  Slide 33

  BIDS Lecture 9/14

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide26.png: 'CellPose

  • Processing more diverse

  datasets and object shapes

  Robert Haase

  Source: Cropped from Stringer et al (2020) licensed CC-BY-NC 4.0

  @haesleinhuepf

  Slide 34

  BIDS Lecture 9/14 https://www.biorxiv.org/content/10.1101/2020.02.02.931238v2.full

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide27.png: 'CellPose

  Compute „flow fields“ from images

  • using classical image processing during training

  • using neural networks during prediction

  Robert Haase

  Source: Cropped from Stringer et al (2020) licensed CC-BY-NC 4.0

  @haesleinhuepf

  Slide 35

  BIDS Lecture 9/14 https://www.biorxiv.org/content/10.1101/2020.02.02.931238v2.full

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide28.png: 'CellPose

  • Cell/Nuclei –

  segmentation based

  on flow-fields

  • Technically similar to

  Watershed, but with a

  deep-learning based

  altitude-image

  Robert Haase

  Image source: Modified from Stringer et al (2020) licensed CC-BY-NC 4.0

  @haesleinhuepf

  Slide 36

  BIDS Lecture 9/14

  https://www.biorxiv.org/content/10.1101/2020.02.02.931238v2.full

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide29.png: 'F3o7oter

  CellPose

  • Image style is a

  parameter

  determined

  before prediction

  to guide

  segmentation.

  Robert Haase

  @haesleinhuepf Source: Modified from Stringer et al (2020) licensed CC-BY-NC 4.0

  Slide 37

  BIDS Lecture 9/14 https://www.biorxiv.org/content/10.1101/2020.02.02.931238v2.full

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide30.png: 'Cellpose 3D

  Robert Haase

  @haesleinhuepf Source: Modified from Stringer et al (2020) licensed CC-BY-NC 4.0

  Slide 38

  BIDS Lecture 9/14 https://www.biorxiv.org/content/10.1101/2020.02.02.931238v2.full

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide31.png: 'Cellpose in Napari

  mamba install cellpose-napari

  https://github.com/

  MouseLand/cellpose

  -napari/issues/50

  Robert Haase

  @haesleinhuepf

  https://github.com/MouseLand/cellpose-napari Slide 39

  BIDS Lecture 9/14

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide32.png: 'Cellpose in Python

  Initialize a pretrained model

  List available models

  Robert Haase

  @haesleinhuepf

  Slide 40

  BIDS Lecture 9/14

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide33.png: 'Cellpose in Python

  Robert Haase

  @haesleinhuepf

  Slide 41

  BIDS Lecture 9/14

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide34.png: 'Cellpose 2

  Train your own model

  Robert Haase

  @haesleinhuepf

  https://www.nature.com/articles/s41592-022-01663-4 Slide 42

  BIDS Lecture 9/14

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide35.png: 'Cellpose 3

  Cellpose 3 includes

  denoising and

  deblurring, to

  improve image

  segmenation quality

  Robert Haase Source: Modified from Stringer & Pachitariu(2024) licensed CC-BY-

  @haesleinhuepf NC 4.0

  Slide 43

  BIDS Lecture 9/14 https://www.biorxiv.org/content/10.1101/2024.02.10.579780v2.artic

  May 28st 2024

  le-info'
downloads/12623730_09_Deep_Learning_slide36.png: 'Cellpose

  State-of-the-art despite the rise of transformers

  Robert Haase

  Stringer & Pachitariu, bioRxiv, 2024 licensed CC-BY-NC 4.0

  @haesleinhuepf

  Slide 44

  BIDS Lecture 9/14 https://www.biorxiv.org/content/10.1101/2024.04.06.587952v1

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide37.png: 'Segment Anything Model

  New approach to DL-based image segmentation involving prompts

  Robert Haase

  Source: https://github.com/facebookresearch/segment-anything

  @haesleinhuepf

  Slide 45

  BIDS Lecture 9/14

  License: Apache 2

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide38.png: 'Segment Anything Model

  New approach to DL-based image segmentation involving prompts

  Robert Haase

  Source: https://github.com/facebookresearch/segment-anything

  @haesleinhuepf

  Slide 46

  BIDS Lecture 9/14

  License: Apache 2

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide39.png: 'Segment Anything Model

  New approach to DL-based image segmentation involving prompts

  Robert Haase

  @haesleinhuepf Source: https://arxiv.org/pdf/2304.02643

  Slide 47

  BIDS Lecture 9/14

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide40.png: 'Segment Anything Model

  Trained on mostly natural images

  Robert Haase

  Source: https://arxiv.org/pdf/2304.02643

  @haesleinhuepf

  Slide 48

  BIDS Lecture 9/14 https://bbbc.broadinstitute.org/BBBC038

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide41.png: 'Segment Anything for Microscopy

  Popping up napari plugins, some within 24h after SAM was published

  https://github.com/hiroalchem/napari-SAM4IS

  Robert Haase

  @haesleinhuepf https://github.com/royerlab/napari-segment-anything

  Slide 49

  BIDS Lecture 9/14 https://github.com/MIC-DKFZ/napari-sam

  May 28st 2024

  https://github.com/computational-cell-analytics/micro-sam'
downloads/12623730_09_Deep_Learning_slide42.png: 'Segment Anything for Microscopy

  Downsides:

  • Original code did not contain the

  procedure for iterative training

  • Instance segmentation not ideal

  (watershed-implementation

  added in micro-sam)

  • Fine-tuning for microscopy data

  necessary

  Source: Architet al (2023) licensed CC-BY 4.0

  Robert Haase

  @haesleinhuepf https://www.biorxiv.org/content/10.1101/2023.08.21.554208v1.articl

  Slide 50

  BIDS Lecture 9/14 e-info

  May 28st 2024

  https://github.com/computational-cell-analytics/micro-sam'
downloads/12623730_09_Deep_Learning_slide43.png: 'Segment Anything for Microscopy

  Real-world scenarios: human-in-the-loop

  „PPerresotrnaainliezedd “

  Retraining /

  MMiiccrroossccooppyy SSAAMM

  fine-tuning

  Yes

  New microscopy No

  Automatic Result Interactive Big

  data

  Segmentation good? correction data?

  Yes No

  Done!

  Robert Haase Figures modified from slides by C. Pape,

  @haesleinhuepf

  licensed CC-BY 4.0 Slide 51

  BIDS Lecture 9/14

  May 28st 2024 https://zenodo.org/records/11265038'
downloads/12623730_09_Deep_Learning_slide44.png: 'Segment Anything for Microscopy

  Robert Haase Source: Archit et al (2023) licensed CC-BY 4.0

  @haesleinhuepf

  https://www.biorxiv.org/content/10.1101/2023. Slide 52

  BIDS Lecture 9/14

  May 28st 2024 08.21.554208v1.article-info'
downloads/12623730_09_Deep_Learning_slide45.png: 'Summary: Deep Learning for Bio-image
  Analysis

  • [Convolutional] Neural Networks is a decade old technology that enabled breakthroughs

  recently.

  • Image Denoising

  • Image Segmentation

  • Common scheme: Smart algorithms for processing input/output of neural networks
  +

  standard NN architectures

  • Image in, instance segmentation out

  • Training these models is

  • computationally expensive,

  • needs large amounts of training data (single images),

  • requires a certain level of [python] expertise

  • If Voronoi-Otsu-Labeling does the job, don’t dive into deep learning!

  Robert Haase

  @haesleinhuepf

  Slide 53

  BIDS Lecture 9/14

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide46.png: 'CENTER FOR SCALABLE DATA ANALYTICS
  AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Exercises

  Robert Haase

  Robert Haase

  These slides and the related training materials can be reused

  @haesleinhuepf

  Slide 54

  under the terms of the CC-BY 4.0license.

  BIDS Lecture 9/14

  May 28st 2024'
downloads/12623730_09_Deep_Learning_slide47.png: 'Exercises

  Make noise2void, stardist, cellpose [and micro-sam] work.

  Hint: This may screw up

  your conda environment.

  In case of weird errors:

  1. Don‘t panic

  2. Recreate you environment

  3. Install the thing you want to use,

  preferably using mamba/conda.

  Creating conda environments is

  not a big deal, just like grabbing

  a spoon before eating soup.

  Robert Haase

  @haesleinhuepf

  Slide 55

  BIDS Lecture 9/14

  May 28st 2024'
downloads/12623730_10_function_calling_slide1.png: 'CENTER FOR SCALABLE DATA ANALYTICS
  AND

  ARTIFICIAL INTELLIGENCE

  Large Language Models for

  Function Calling

  Robert Haase

  Robert Haase

  @haesleinhuepf

  1

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide2.png: 'Quiz: Recap

  • In order to train a random forest pixel classifier you

  need…

  Instance Semantic Sparse instance Sparse semantic

  annotation annotation annotation annotation

  Robert Haase

  @haesleinhuepf

  2

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide3.png: 'Quiz: Recap

  • Noise2void requires as input

  One high-

  quality and a

  Image + low-quality Two low-quality A single noisy

  annotation image images image

  Robert Haase

  @haesleinhuepf

  3

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide4.png: 'Quiz: Recap

  • The flow fields in the

  CellPose algorithm are

  used to…

  Measure velocity of Determine Detect object Characterize

  objects over time object borders centroids texture of objects

  Robert Haase

  @haesleinhuepf Image source: Modified from Stringer et al (2020) licensed CC-BY-NC
  4.0

  4

  BIDS Lecture10/14 https://www.biorxiv.org/content/10.1101/2020.02.02.931238v2.full

  June 4th 2024'
downloads/12623730_10_function_calling_slide5.png: 'Generative Artificial Intelligence

  • Definition: “Generative artificial intelligence […] is a type of artificial intelligence
  (AI)

  system capable of generating text, images, or other media in response to prompts.”1

  • Commonly based on Neural Networks

  • Bridges fields:

  • Natural Language Processing (NLP)

  • Computer Vision (CV)

  • Use-cases

  • Translating text A picture of Ein Bild mit

  • Writing emails, text, grant proposals

  a cat and a einer Katze

  • Summarizing articles

  microscope „Large Language und einem

  • Writing code

  Mikroskop

  Model“,

  • General question answering

  • Image generation

  „Transformer“

  • Image interpretation / analysis

  Robert Haase

  @haesleinhuepf 1 source:

  5

  BIDS Lecture10/14 https://en.wikipedia.org/wiki/Generative_artificial_intelligence

  June 4th 2024'
downloads/12623730_10_function_calling_slide6.png: 'Generative Artificial Intelligence

  • Definition: “Generative artificial intelligence […] is a type of artificial intelligence
  (AI)

  system capable of generating text, images, or other media in response to prompts.”1

  • Commonly based on Neural Networks

  • Bridges fields:

  • Natural Language Processing (NLP)

  • Computer Vision (CV)

  • Use-cases

  • Translating text A picture of

  • Writing emails, text, grant proposals

  a cat and a

  • Summarizing articles

  microscope

  • Writing code „Text-to-image

  • General question answering

  model“

  • Image generation

  • Image interpretation / analysis

  Robert Haase

  @haesleinhuepf 1 source:

  6

  BIDS Lecture10/14 https://en.wikipedia.org/wiki/Generative_artificial_intelligence

  June 4th 2024'
downloads/12623730_10_function_calling_slide7.png: 'Generative Artificial Intelligence

  • Definition: “Generative artificial intelligence […] is a type of artificial intelligence
  (AI)

  system capable of generating text, images, or other media in response to prompts.”1

  • Commonly based on Neural Networks

  • Bridges fields:

  • Natural Language Processing (NLP)

  • Computer Vision (CV)

  • Use-cases

  • Translating text A picture of

  • Writing emails, text, grant proposals

  a cat and a

  • Summarizing articles

  microscope

  • Writing code „Vision Language Model“,

  • General question answering

  „image-to-text model“

  • Image generation

  • Image interpretation / analysis

  Robert Haase

  @haesleinhuepf 1 source:

  7

  BIDS Lecture10/14 https://en.wikipedia.org/wiki/Generative_artificial_intelligence

  June 4th 2024'
downloads/12623730_10_function_calling_slide8.png: 'Generative Artificial Intelligence

  • Definition: “Generative artificial intelligence […] is a type of artificial intelligence
  (AI)

  system capable of generating text, images, or other media in response to prompts.”1

  • Commonly based on Neural Networks

  • Bridges fields:

  • Natural Language Processing (NLP)

  • Computer Vision (CV)

  • Use-cases

  • Translating text How many There are 4

  • Writing emails, text, grant proposals

  cells are cells. I just

  • Summarizing articles

  there? marked their

  • Writing code „Multi-modal

  nuclei.

  • General question answering

  model“

  • Image generation

  • Image interpretation / analysis

  Robert Haase

  @haesleinhuepf 1 source:

  8

  BIDS Lecture10/14 https://en.wikipedia.org/wiki/Generative_artificial_intelligence

  June 4th 2024'
downloads/12623730_10_function_calling_slide9.png: 'Variational Auto-Encoder

  • Turning pixels into

  Encoder Decoder

  „meaning“ and back

  to pixels.

  µ

  r

  e t

  t u l u

  p p

  p

  m t

  n σ u

  I a O

  S

  1

  “Bottleneck”, 2

  “Embedding”

  Robert Haase

  Cat picture source: Ramesh et al., licensed CC-BY 4.0

  @haesleinhuepf

  9

  BIDS Lecture10/14

  https://arxiv.org/pdf/2102.12092.pdf

  June 4th 2024'
downloads/12623730_10_function_calling_slide10.png: 'Generative Pretrained

  Transformer (GPT)

  Encoder Decoder

  • To enforce specific

  Output

  outputs, one needs

  2

  another entrance for

  data into the

  To avoid

  training.

  cheating

  Masking while

  training

  1

  3

  Input Output

  Robert Haase

  @haesleinhuepf

  10

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide11.png: 'Generative Pretrained

  Transformer (GPT)

  • Stacks of encoders

  and decoders

  arranged like this:

  Robert Haase

  Cropped from Alammar (2018), licensed CC-BY-SA 4.0.

  @haesleinhuepf

  11

  BIDS Lecture10/14 https://jalammar.github.io/illustrated-transformer/

  June 4th 2024'
downloads/12623730_10_function_calling_slide12.png: 'Generative Pretrained

  Transformer (GPT)

  Decoder

  Encoder

  Vectors and

  matrices

  Robert Haase

  Source: Vaswani et al (2017)

  @haesleinhuepf

  12

  BIDS Lecture10/14

  https://arxiv.org/abs/1706.03762

  June 4th 2024'
downloads/12623730_10_function_calling_slide13.png: 'Last word probabilities

  Generative Pretrained

  (according to context):

  Heating: 0.9

  Food: 0.8

  Transformer (GPT)

  Dog: 0.2

  MMiiccrroossccooppee:: 00..201

  • Task: Translation

  Masked out

  Example input: Example output:

  Die Katze sitzt neben dem MMikikrroosskkoopp The cat sits next to the microscope

  Robert Haase

  Source: Vaswani et al (2017)

  @haesleinhuepf

  13

  BIDS Lecture10/14

  https://arxiv.org/abs/1706.03762

  June 4th 2024'
downloads/12623730_10_function_calling_slide14.png: 'Generative Pretrained

  Transformer (GPT)

  • Words need to be converted

  into vectors to enable NNs to

  process them.

  1

  “microscope”

  “cat”

  “black”

  “white” “fur”

  0

  0 1

  Word Embedding

  Robert Haase

  Source: Vaswani et al (2017)

  @haesleinhuepf

  14

  BIDS Lecture10/14

  https://arxiv.org/abs/1706.03762

  June 4th 2024'
downloads/12623730_10_function_calling_slide15.png: 'Attention is all you need

  • The position of the word in the

  sentence / context may have

  influence on its meaning.

  The cat sits next to a microscope.

  Next to the microscope there is a cat.

  Robert Haase

  Figure source: Vaswani et al (2017)

  @haesleinhuepf

  15

  BIDS Lecture10/14 https://arxiv.org/abs/1706.03762

  June 4th 2024'
downloads/12623730_10_function_calling_slide16.png: 'Attention is all you need

  Robert Haase

  Source: Vaswani et al (2017)

  @haesleinhuepf

  16

  BIDS Lecture10/14 https://arxiv.org/abs/1706.03762

  June 4th 2024'
downloads/12623730_10_function_calling_slide17.png: 'Scaled dot-product attention

  • Attention score: How much related are two words?

  • Query: For which word are we calculating attention?

  • Key: To which word are we calculating attention

  • Value: Relevance of the query-key relationship

  The cat is black and white.

  Relevance value: 0.1

  attention score

  The cat is meowing.

  Relevance value: 0.9

  attention score

  Robert Haase Source: Vaswani et al (2017)

  @haesleinhuepf

  https://arxiv.org/abs/1706.03762 17

  BIDS Lecture10/14

  June 4th 2024 See also: https://www.youtube.com/watch?v=sznZ78HquPc'
downloads/12623730_10_function_calling_slide18.png: 'Attention is all you need

  Robert Haase

  Source: Vaswani et al (2017)

  @haesleinhuepf

  18

  BIDS Lecture10/14 https://arxiv.org/abs/1706.03762

  June 4th 2024'
downloads/12623730_10_function_calling_slide19.png: 'Multi-head attentions

  • Multiple aspects represented by multiple attention heads

  Source Figure left/right: Alammar(2018), licensed CC-BY-SA 4.0.

  Robert Haase

  @haesleinhuepf https://jalammar.github.io/illustrated-transformer/

  19

  BIDS Lecture10/14 Source Figure center: Vaswani et al (2017)

  June 4th 2024

  https://arxiv.org/abs/1706.03762'
downloads/12623730_10_function_calling_slide20.png: 'Attention is all you need

  Robert Haase

  Source: Vaswani et al (2017)

  @haesleinhuepf

  20

  BIDS Lecture10/14 https://arxiv.org/abs/1706.03762

  June 4th 2024'
downloads/12623730_10_function_calling_slide21.png: 'Attention is all you need

  • Summary

  Decoder

  Encoder

  Source Figure right: Alammar(2018), licensed CC-BY-SA 4.0.

  Robert Haase

  @haesleinhuepf https://jalammar.github.io/illustrated-transformer/

  21

  BIDS Lecture10/14 Source Figure left: Vaswani et al (2017)

  June 4th 2024

  https://arxiv.org/abs/1706.03762'
downloads/12623730_10_function_calling_slide22.png: 'Example applications

  • Translation (e.g. English -> Python)

  Write „Hello World“

  print(“Hello world“)

  on the screen.

  • Next word prediction (a.k.a. auto-completion)

  Print(“Hello… World“)

  Robert Haase

  @haesleinhuepf

  22

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide23.png: 'Example applications

  Some kind of

  • Function calling (choosing a tool)

  next-word

  prediction task

  Given a list of tools…

  • get_current_time

  book_room

  • order_food

  • book_room

  … and a task:

  Please book meeting room 3

  for Robert at 3pm.

  Which is the right tool to use?

  Robert Haase

  @haesleinhuepf

  23

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide24.png: 'Example applications

  • Function calling (parameterizing)

  Some kind of

  translation task

  Given a function signature…

  book_room(room, time, person)

  … and a task: book_room(“Meeting Room 3“,

  Please book meeting room 3 for “3pm“, “Robert“)

  Robert at 3pm.

  How could I use the tool?

  Robert Haase

  @haesleinhuepf

  24

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide25.png: 'Example applications

  • Function calling (parameterizing)

  Given a function signature…

  book_room(room, time, person)

  … and a task:

  Please book meeting room 3 for

  Robert at 3pm.

  How could I use the tool?

  Robert Haase

  @haesleinhuepf

  25

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide26.png: 'Function calling

  • Compatible models are rare

  Robert Haase

  @haesleinhuepf https://ollama.com/library/mistral

  26

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide27.png: 'Function calling

  • Under the hood: JSON

  Robert Haase

  @haesleinhuepf

  27

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide28.png: 'Function calling

  • In Python / ollama

  Robert Haase

  @haesleinhuepf

  28

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide29.png: 'Function calling

  • API-compatibility yet challenging (in python)

  Directly

  accessing the

  REST API

  Robert Haase

  @haesleinhuepf function_calling.py

  29

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide30.png: 'Function Calling using LangChain

  • LangChain is used to combine tools.

  • It uses various LLMs under the hood.

  Robert Haase https://github.com/langchain-ai/langchain

  @haesleinhuepf

  https://scads.github.io/prompt-engineering-tutorial- 30

  BIDS Lecture10/14

  June 4th 2024 2023/01_prompts/07_langchain.html'
downloads/12623730_10_function_calling_slide31.png: 'Function Calling using LangChain

  • After combining tools, large langue model and memory in an agent, you can interact
  with it.

  Robert Haase https://github.com/langchain-ai/langchain

  @haesleinhuepf

  https://scads.github.io/prompt-engineering-tutorial- 31

  BIDS Lecture10/14

  June 4th 2024 2023/01_prompts/07_langchain.html'
downloads/12623730_10_function_calling_slide32.png: 'Function

  Obviously,

  calling

  that’s not

  • Hallucinations true.

  Robert Haase

  @haesleinhuepf

  32

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide33.png: 'Function

  calling

  • Mapping multi-

  parameter / type

  functions is

  challenging when

  using LangChain

  • Necessary

  because of lazy

  (delayed)

  evaluation

  Robert Haase https://github.com/haesleinhuepf/blablado/blob/

  @haesleinhuepf

  4bc55c70f5219a9bcab571e96f09b1cd664baead/sr 33

  BIDS Lecture10/14

  June 4th 2024 c/blablado/_assistant.py#L42'
downloads/12623730_10_function_calling_slide34.png: 'Simplification: bla-bla-do

  • A simple API to manage callable functions and calling them.

  • Check memory

  • Define tools

  • Invoke tools

  Robert Haase

  @haesleinhuepf

  34

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide35.png: 'Simplification: bla-bla-do

  • Use classes for more complex tasks

  • Define + register tools • Invoke tools

  IItt iinnffeerrss tthhee

  ppuurrppoossee ooff tthhee

  ffuunnccttiioonn ffrroomm

  tthhee ddooccssttrriinngg

  Robert Haase

  @haesleinhuepf

  35

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide36.png: 'Voice Assistance

  • Combining voice recognition with large language models

  Robert Haase https://github.com/haesleinhuepf/blablado

  @haesleinhuepf

  https://github.com/haesleinhuepf/blablado/blob/main/d 36

  BIDS Lecture10/14

  June 4th 2024 emo/microscope_stage_demo.ipynb'
downloads/12623730_10_function_calling_slide37.png: 'napari-chatGPT

  • Napari-chatGPT can automate programming plugins / “widgets”.

  Robert Haase

  @haesleinhSuoeupfrce: https://github.com/royerlab/napari-chatgpt (BSD3 license)

  37

  37

  BIDS Lecture10/14

  https://twitter.com/loicaroyer/status/1653600252807757824

  June 4th 2024'
downloads/12623730_10_function_calling_slide38.png: 'A little warning

  • napari-chatGPT executes code and installs software on your machine.

  • Use it with care! E.g. in a virtual machine / sandbox / conda environment

  Robert Haase

  @haesleinhuepf 38

  38

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide39.png: 'Deconstruction of napari-chatGPT

  • Napari-chatGPT defines a list of “tools”

  Robert Haase

  @h ha tte pss :l /e /gi in thh uu b.e cop mf /royerlab/napari-chatgpt/blob/aa00b48d0523da588ece5dc8cdb006c895c4b473/src/napari_chatgpt/omega/tools/google_search_tool.py
  39 39

  BIDhSttp Ls:e//cgtituhrueb.c1o0m//1ro4yerlab/napari-chatgpt/blob/aa00b48d0523da588ece5dc8cdb006c895c4b473/src/napari_chatgpt/utils/google.py#L58

  JunCeo d4et ohri g2in0: 2ht4tps://github.com/Nv7-GitHub/googlesearch'
downloads/12623730_10_function_calling_slide40.png: 'napari-chatGPT

  • Napari-chatGPT defines a list of “tools”

  Robert Haase

  @h ha tte pss :l /e /gi in thh uu b.e cop mf /royerlab/napari-chatgpt/blob/aa00b48d0523da588ece5dc8cdb006c895c4b473/src/napari_chatgpt/omega/tools/google_search_tool.py
  40 40

  BIDhSttp Ls:e//cgtituhrueb.c1o0m//1ro4yerlab/napari-chatgpt/blob/aa00b48d0523da588ece5dc8cdb006c895c4b473/src/napari_chatgpt/utils/google.py#L58

  JunCeo d4et ohri g2in0: 2ht4tps://github.com/Nv7-GitHub/googlesearch'
downloads/12623730_10_function_calling_slide41.png: 'CENTER FOR SCALABLE DATA ANALYTICS
  AND

  ARTIFICIAL INTELLIGENCE

  Exercises

  Robert Haase

  Robert Haase

  @haesleinhuepf

  41

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide42.png: 'Optional exercise

  Question:

  Can you provide Python code to segment nuclei in a

  microscopy image?

  • Preparation for next week (!)

  Answer:

  The following code is performing these steps:

  • Select some of your most favorite 1. It imports the necessary functions and

  libraries.

  code snippets from this course and 2. It applies a top-hat filter to the input

  `raw_image` to subtract the background.

  submit them as pull-request to this

  3. It applies voronoi-otsu labeling to the

  background-subtracted image to segment nuclei.

  file

  4. It displays an the segmented nuclei with labels.

  • https://github.com/ScaDS/BIDS-lecture-

  ```python

  from skimage.io import imread

  2024/blob/main/11b_fine_tuning/questi

  import pyclesperanto_prototype as cle

  on_answers_hand_crafted.txt from stackview import imshow

  import matplotlib.pyplot as plt

  background_subtracted = cle.top_hat_box(raw_image,

  radius_x=5, radius_y=5, radius_z=5)

  nuclei =

  I will use this to fine-tune

  cle.voronoi_otsu_labeling(background_subtracted)

  a chatgpt model for you. imshow(nuclei, labels=True)

  ```

  Robert Haase

  @haesleinhuepf

  42

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide43.png: 'Exercises: LangChain

  • Figure out when code is actually executed.

  Robert Haase

  https://haesleinhuepf.github.io/BioImageAnalysisNotebooks/

  @haesleinhuepf 43

  43

  BIDS Lecture10/14

  07_prompt_engineering/20_langchain.html

  June 4th 2024'
downloads/12623730_10_function_calling_slide44.png: 'Exercises: Prompting image analysis
  tasks

  • Extend the LangChain notebook to enable the agent to

  measure objects in images.

  Robert Haase

  @haesleinhuepf

  44

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide45.png: 'Exercises: Prompting image analysis
  tasks

  • Implement multiple segmentation tools and guide the agent to use the right

  one, e.g. for segmenting and image showing bright membranes

  • Also ask the agent how it made its choice.

  Robert Haase

  @haesleinhuepf

  45

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide46.png: 'Exercise: bla-bla-do

  • Add zoom-capabilities to the AI-controlled microscope

  Robert Haase

  @haesleinhuepf

  46

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_10_function_calling_slide47.png: 'Exercise: Jupyter magics

  • Build a Jupyter-based chatbot that can process images.

  Robert Haase

  @haesleinhuepf

  47

  BIDS Lecture10/14

  June 4th 2024'
downloads/12623730_13_quality_assurance_slide1.png: 'CENTER FOR SCALABLE DATA ANALYTICS
  AND NATIONAL RESEARCH DATA MANAGEMENT INFRASTRUCTURE GLOBAL BIOIMAGE

  ARTIFICIAL INTELLIGENCE FOR MICROSCOPY AND BIOIMAGE ANALYSIS ANALYST’S SOCIETY

  Benchmarking LLMs

  Robert Haase

  Robert Haase

  These slides can be reused under the terms of the

  @haesleinhuepf

  1

  BIDS Lecture13/14 CC-BY 4.0 license unless mentioned otherwise.

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide2.png: 'Quiz: Recap

  • Stable Diffusion can be used for…

  Image Image Image gap Image

  generation manipulation filling classification

  Robert Haase

  @haesleinhuepf

  2

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide3.png: 'Quiz: Recap

  • The LLava can be used for…

  Image Image Image Image

  generation manipulation describing classification

  Robert Haase

  @haesleinhuepf

  3

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide4.png: 'Complex exercise

  • Deadline: June 26th (23:59 CEST)

  Robert Haase

  @haesleinhuepf

  4

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide5.png: 'Benchmarking

  LLMs

  Source: Guo et al 2023

  Robert Haase

  @haesleinhuepf https://arxiv.org/abs/2310.19736,

  5

  BIDS Lecture13/14

  https://github.com/tjunlp-lab/Awesome-LLMs-Evaluation-Papers

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide6.png: 'Benchmarking LLMs

  • Code

  generation

  Robert Haase https://huggingface.co/spaces/bigcode/bigcode-

  @haesleinhuepf

  6

  BIDS Lecture13/14 models-leaderboard

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide7.png: 'Benchmarking LLMs

  • Chat

  performance

  Robert Haase

  https://huggingface.co/spaces/open-llm-

  @haesleinhuepf

  7

  BIDS Lecture13/14 leaderboard/open_llm_leaderboard

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide8.png: 'Benchmarking LLMs - Quiz

  • Assume:

  • An LLM wins in benchmarks. It outperforms

  ChatGPT.

  • In practice it seems perform less well than ChatGPT.

  What could be the reason for this mismatch?

  Robert Haase

  @haesleinhuepf

  8

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide9.png: 'Truthfulness

  • LLMs [can] mimic

  human falsehoods

  … because of the

  training data

  Robert Haase Source: Lin et al 2022

  @haesleinhuepf

  9

  BIDS Lecture13/14 https://arxiv.org/abs/2109.07958

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide10.png: 'Truthfulness

  • … introducing an LLM to test for truthfullness of

  responses from other LLMs

  Side note: Larger

  models may

  Manual evaluation

  respond less

  truthfull because

  they can reflect the

  training data more

  GPT-judge

  precisely

  Robert Haase Source: Lin et al 2022

  @haesleinhuepf

  10

  BIDS Lecture13/14 https://arxiv.org/abs/2109.07958

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide11.png: 'Truthfulness

  • When asking humans to evaluate results, make sure

  they are the right target audience

  Robert Haase

  Credit: "Mandarin orange, axial view, MRI."is licensed(CC-BY 4.0)by Alexandr Khrapichev,
  University of Oxford

  @haesleinhuepf https://haesleinhuepf.github.io/BioImageAnalysisNotebooks/07_prompt_engineering/02_generating_mri_images.htm1l
  1 11

  BIDS Lecture13/14

  https://twitter.com/haesleinhuepf/status/1659138282641342466

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide12.png: 'Benchmarking vision models

  • Single attempts… are a trap

  n=1

  Robert Haase

  @haesleinhuepf

  12

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide13.png: 'Benchmarking vision models

  • Prompt: „Analyse the following image by counting the bright

  blobs. Respond with the number only. “ (n=25)

  Nov

  2023

  Apr

  2024 May

  2024

  Robert Haase

  https://haesleinhuepf.github.io/BioImageAnalysisNotebo

  @haesleinhuepf

  13

  BIDS Lecture13/14 oks/20c_vision_models/vision_models.html

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide14.png: 'Benchmarking image generation

  • Recap: Prompt engineering to optimize images

  One cat

  is real.

  Robert Haase

  @haesleinhuepf https://haesleinhuepf.github.io/BioImageAnalysisNotebooks/ 14

  14

  BIDS Lecture13/14 07_prompt_engineering/02_generating_images.html

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide15.png: 'Benchmarking image generation

  • Recap: Prompt engineering to optimize images

  One cat

  is real.

  Robert Haase

  @haesleinhuepf https://haesleinhuepf.github.io/BioImageAnalysisNotebooks/ 15

  15

  BIDS Lecture13/14 07_prompt_engineering/02_generating_images.html

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide16.png: 'CLIP scores

  • Recap: Contrastive Language-Image Pre-Training (CLIP)

  • For image describing

  • Here: Similarity between image and prompt

  Robert Haase

  @haesleinhuepf

  16

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide17.png: 'CLIP scores

  • Example: Prompt optimization

  Always have

  a control

  experiment!

  Trying out different prompts

  Robert Haase

  @haesleinhuepf

  for generating pictures of cats 17

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide18.png: 'Benchmarking code generation

  • Measures of quality

  • Executability

  • Functional correctness

  • Code quality (comments, variable names, …)

  • Code efficiency (compute time, memory consumption, …)

  Robert Haase

  @haesleinhuepf

  18

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide19.png: 'Testing executability

  • LLMs can solve simple image analysis tasks

  Prompt Response Result

  Robert Haase

  https://haesleinhuepf.github.io/BioImageAnalysisNotebooks/07_pro

  @haesleinhuepf 19

  19

  BIDS Lecture13/14 mpt_engineering/04_generating_code_for_processing_images.html

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide20.png: 'Testing executability

  • With more advanced tasks, additional hints are required

  Robert Haase

  https://haesleinhuepf.github.io/BioImageAnalysisNotebooks/07_pro

  @haesleinhuepf 20

  20

  BIDS Lecture13/14 mpt_engineering/04_generating_code_for_processing_images.html

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide21.png: 'Testing executability

  • When running the code, we can test if it’s executable

  The more sophisticated

  prompt produced

  useful results in 5 out

  of 10 runs (judged by

  human).

  The more sophisticated

  prompt had errors in 4

  out of 10 runs.

  Robert Haase

  @haesleinhuepf https://haesleinhuepf.github.io/BioImageAnalysisNotebooks/07_prompt
  21

  21

  BIDS Lecture13/14

  _engineering/05_generating_advanced_image_processing_code.html

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide22.png: 'Testing functional correctness:
  HumanEval

  Publishing a new model

  + a new benchmark

  […]

  Robert Haase

  Source: Chen et al 2021

  @haesleinhuepf

  22

  BIDS Lecture13/14

  https://arxiv.org/abs/2107.03374

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide23.png: 'HumanEval

  • Human-written code examples (functions)

  Completion

  Reference

  prompt

  solution + unit tests

  Robert Haase

  Source: Chen et al 2021

  @haesleinhuepf

  23

  BIDS Lecture13/14

  https://arxiv.org/abs/2107.03374

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide24.png: 'Human Eval

  • Sampling code samples from LLM (n=200)

  • Estimate likelihood that the LLM produces functionally correct code

  Prompt

  Code

  LLM

  All

  Reference samples

  tests

  solution

  pass?

  Unit tests

  Yes

  Human written „Functional correct“

  Robert Haase

  @haesleinhuepf

  24

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide25.png: 'pass@k

  • pass@k: Likelihood that asking for k code samples,

  at least one of them is functionally correct

  Robert Haase

  Source: Chen et al 2021

  @haesleinhuepf

  25

  BIDS Lecture13/14

  https://arxiv.org/abs/2107.03374

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide26.png: 'pass@k

  • Special case pass@1:

  Likelihood that a single

  requested code sample

  is functionally correct.

  • Because asking for 200

  samples is not very

  practical, in particular if

  there are no unit-tests to

  determine correctness.

  Robert Haase

  Source: Chen et al 2021

  @haesleinhuepf

  26

  BIDS Lecture13/14

  https://arxiv.org/abs/2107.03374

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide27.png: 'HumanEval

  • Used for determining optimal temperature

  • Temperature  0: Model responds always the same

  • Temperature > 0: Model responds more variable / diverse

  Robert Haase

  Source: Chen et al 2021

  @haesleinhuepf

  27

  BIDS Lecture13/14

  https://arxiv.org/abs/2107.03374

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide28.png: 'HumanEval

  • Under the hood: jsonl-formatted code:

  example_problem.jsonl

  {"task_id": "test/0", "prompt": "def return1():\n", "canonical_solution": " return
  1", "test": "def

  check(candidate):\n assert candidate() == 1", "entry_point": "return1"}

  example_samples.jsonl

  {"task_id": "test/0", "completion": " import subprocess\n subprocess.check_output(''rm
  -rf tmp'')"}

  {"task_id": "test/0", "completion": " import time\n time.sleep(10)\n return 1"}

  {"task_id": "test/0", "completion": " return input(''enter a number'')"}

  {"task_id": "test/0", "completion": " return 1"}

  {"task_id": "test/0", "completion": " return 1"}

  {"task_id": "test/0", "completion": "\treturn 1"}

  Robert Haase

  Source: https://github.com/openai/human-eval

  @haesleinhuepf

  28

  BIDS Lecture13/14 License: MIT

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide29.png: 'Benchmarking LLMs for Bio-image
  Analysis

  • Example test-case inspired by HumaEval (Chen et al 2021, )

  https://arxiv.org/abs/2107.03374

  Prompt

  Reference

  solution

  We formulated 57

  of such test-cases

  Unit test

  (excerpt)

  (yet)

  Robert Haase

  @haesleinhuepf https://www.biorxiv.org/content/10.1101/2024.04.19.590278v1

  29

  BIDS Lecture13/14 https://github.com/haesleinhuepf/human-eval-bia

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide30.png: 'Quiz

  • Why is it important to turn off Github Copilot

  while writing the test-cases manually?

  Robert Haase

  @haesleinhuepf

  30

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide31.png: 'Benchmarking LLMs for Bio-image
  Analysis

  • Use case: segment the image and measure the average area of objects.

  858.04

  …

  Unit-test pass-rate (n=10):

  Robert Haase

  @haesleinhuepf https://www.biorxiv.org/content/10.1101/2024.04.19.590278v1

  31

  BIDS Lecture13/14 https://github.com/haesleinhuepf/human-eval-bia

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide32.png: 'Benchmarking LLMs for Bio-image
  Analysis

  • Use case: Count segmented objects in a folder of segmentation results.

  300

  398

  368

  378

  363

  Unit-test pass-rate (n=10):

  https://www.biorxiv.org/content/10.1101/2024.04.19.590278v1

  Robert Haase

  @haesleinhuepf https://github.com/haesleinhuepf/human-eval-bia

  32

  BIDS Lecture13/14 Data Source: https://www.ebi.ac.uk/bioimage-archive/galleries/S-

  June 25th 2024

  BIAD634-ai.html'
downloads/12623730_13_quality_assurance_slide33.png: 'Benchmarking LLMs for Bio-image
  Analysis

  • Use-case: correlation matrix

  Unit-test pass-rate (n=10):

  Robert Haase

  @haesleinhuepf https://www.biorxiv.org/content/10.1101/2024.04.19.590278v1

  33

  BIDS Lecture13/14 https://github.com/haesleinhuepf/human-eval-bia

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide34.png: 'Benchmarking LLMs for Bio-image
  Analysis

  Unit-test pass-rate (n=10)

  Statistics / tabular data wrangling

  Measurements / feature extraction

  Advanced workflows / big data

  Robert Haase

  @haesleinhuepf

  34

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide35.png: 'Benchmarking LLMs for Bio-image
  Analysis

  • Summary: 57 use-cases (yet), 18 LLMs (yet), n=10

  Robert Haase

  @haesleinhuepf

  35

  BIDS Lecture13/14

  June 25th 2024 https://github.com/haesleinhuepf/human-eval-bia/pull/69'
downloads/12623730_13_quality_assurance_slide36.png: 'Benchmarking LLMs for Bio-image
  Analysis

  • Common error

  messages (n=570)

  Halucinating API?

  Forgot import

  statements?

  Robert Haase

  @haesleinhuepf https://www.biorxiv.org/content/10.1101/2024.04.19.590278v1

  36

  BIDS Lecture13/14 https://github.com/haesleinhuepf/human-eval-bia

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide37.png: 'SWE-BENCH

  • Can LLMs solve github issues?

  Hint: This can only be

  used if your project

  has unit-tests

  Robert Haase

  Source: Cropped from Jimenez 2024, licensed CC-BY 4.0

  @haesleinhuepf

  37

  BIDS Lecture13/14

  https://arxiv.org/abs/2310.06770

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide38.png: 'SWE-BENCH

  • “Across the board, models struggle

  significantly to resolve issues. The

  best performing model, Claude 2, is

  only able to resolve 1.96% of the

  issues.” (Jimeney 2024))

  Robert Haase Source: Jimenez 2024, licensed CC-BY 4.0

  @haesleinhuepf

  https://arxiv.org/abs/2310.06770 38

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide39.png: 'DS-1000

  • A benchmark for code generation based on Data Science questions on

  stackoverflow.com

  Robert Haase

  @haesleinhuepf Source: Lai et al (2022), license CC-BY 4.0

  39

  BIDS Lecture13/14

  https://arxiv.org/abs/2211.11501

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide40.png: 'Modified from

  DS-1000

  stackoverflow

  „functional

  correctness“

  „surface-form

  constraints“

  Robert Haase

  @haesleinhuepf Source: cropped from Lai et al (2022), license CC-BY 4.0

  40

  BIDS Lecture13/14

  https://arxiv.org/abs/2211.11501

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide41.png: 'DS-1000

  • Published code samples! ☺

  Source: Screenshot from

  Robert Haase

  @haesleinhuepf https://github.com/xlang-ai/DS-1000/tree/main/data, 43

  BIDS Lecture13/14

  June 25th 2024 licensed CC-BY-SA 4.0 by Lai et al.'
downloads/12623730_13_quality_assurance_slide42.png: 'HumanEval for Bio-image Analysis

  • Published code samples! ☺

  Robert Haase https://github.com/haesleinhuepf/human-eval-

  @haesleinhuepf

  bia/blob/main/data/samples_claude-3-opus- 44

  BIDS Lecture13/14

  June 25th 2024 20240229.jsonl_results.jsonl'
downloads/12623730_13_quality_assurance_slide43.png: 'CENTER FOR SCALABLE DATA ANALYTICS
  AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Exercises

  Robert Haase

  Robert Haase

  These slides and the related training materials can be reused under the

  @haesleinhuepf

  45

  terms of the CC-BY 4.0 license.

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide44.png: 'Exercise: CLIP scores

  • Modify prompts and measure impact on results

  Robert Haase

  @haesleinhuepf

  46

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide45.png: 'Exercise: Errors in generated
  code

  • Compare Claude, Gemini and GPT4

  Robert Haase

  @haesleinhuepf

  47

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_13_quality_assurance_slide46.png: 'Complex exercise

  • Deadline: June 26th (23:59 CEST)

  Robert Haase

  @haesleinhuepf

  48

  BIDS Lecture13/14

  June 25th 2024'
downloads/12623730_12_Vision_models_slide1.png: 'CENTER FOR SCALABLE DATA ANALYTICS
  AND

  ARTIFICIAL INTELLIGENCE

  Image Generation and

  Vision Language Models

  Robert Haase

  Robert Haase

  @haesleinhuepf

  Slide 1

  BIDS Lecture12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide2.png: 'Image Generation

  „text-to-image“

  A picture of

  a cat and a

  microscope

  Robert Haase

  @haesleinhuepf

  Slide 2

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide3.png: 'Variational Auto-Encoder

  „image-to-image“ Encoder Decoder

  µ r

  e t

  t u

  u l

  p p

  p

  m t

  n σ u

  I a O

  S

  “Bottleneck”,

  “Embedding”

  Robert Haase Cat picture source: Ramesh et al. 2021, licensed

  @haesleinhuepf

  Slide 3

  BIDS Lecture 12/14CC-BY 4.0 https://arxiv.org/pdf/2102.12092.pdf

  June 18th 2024'
downloads/12623730_12_Vision_models_slide4.png: 'Image Generation

  Decoder

  Large

  t

  u

  Language p

  „Image of a cat“

  t

  u

  O

  Model

  “Bottleneck”,

  “Embedding”

  Robert Haase Cat picture source: Ramesh et al. 2021, licensed

  @haesleinhuepf

  Slide 4

  BIDS Lecture 12/14CC-BY 4.0 https://arxiv.org/pdf/2102.12092.pdf

  June 18th 2024'
downloads/12623730_12_Vision_models_slide5.png: 'Stable Diffusion

  Diffusion: reverse denoising

  Latent space

  Robert Haase

  Simplified from: Rombach et al. 2021

  @haesleinhuepf

  Slide 5

  BIDS Lecture 12/14

  https://arxiv.org/abs/2112.10752

  June 18th 2024'
downloads/12623730_12_Vision_models_slide6.png: 'Stable Diffusion

  Diffusion: reverse denoising

  Robert Haase

  Source: Rombach et al. 2021

  @haesleinhuepf

  Slide 6

  BIDS Lecture 12/14

  https://arxiv.org/abs/2112.10752

  June 18th 2024'
downloads/12623730_12_Vision_models_slide7.png: 'How does it work?

  Train a U-Net on

  data: image +

  The cat’s fur

  noisy image +

  is black and

  description +

  white.

  noise-level

  t

  t u

  u

  p

  p

  t

  n u

  I O

  Noise-level: 1

  Robert Haase

  @haesleinhuepf

  Slide 7

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide8.png: 'How does it work?

  Train a U-Net on

  data: image +

  The cat’s fur

  noisy image +

  is black and

  description +

  white.

  noise-level

  t

  t u

  u

  p

  p

  t

  n u

  I O

  Noise-level: 2

  Robert Haase

  @haesleinhuepf

  Slide 8

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide9.png: 'How does it work?

  Train a U-Net on

  data: image +

  The cat’s fur

  noisy image +

  is black and

  description +

  white.

  noise-level

  t

  t u

  u

  p

  p

  t

  n u

  I O

  Noise-level: 3

  Robert Haase

  @haesleinhuepf

  Slide 9

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide10.png: 'How does it work?

  Prediction is

  iterative denoising

  The cat’s fur

  of:

  is black and

  Pure noise +

  white.

  text prompt

  t

  t u

  u

  p

  p

  t

  n u

  I O

  Noise-level: 1,2,3

  Robert Haase

  @haesleinhuepf

  Slide 10

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide11.png: 'How does it work?

  Reminder:

  - Word embeddings The cat’s fur

  is black and

  - Attention

  white.

  Word Embedding

  Self-attention

  t

  1 t u

  “microscope” u p

  0 1 4 3 2 1 p t

  n u

  The cat’s fur is black and white. I O

  “cat”

  “black”

  “white” “fur”

  0

  0 1

  Robert Haase

  @haesleinhuepf

  Slide 11

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide12.png: 'Image generation in Python: Huggingface

  Most Huggingface image-generation models require a GPU.

  Downloads

  4.8 GB

  Needs

  Nvidia GPU

  Robert Haase

  @haesleinhuepf

  Slide 12

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide13.png: 'Image generation in Python: Huggingface

  Works well if the prompt overlaps with training data, potentially

  huge variation between attempts

  Robert Haase

  @haesleinhuepf

  Slide 13

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide14.png: 'Dall-E

  OpenAI‘s model for image geneation based on diffusion models + CLIP

  transformer

  Training

  Inference

  Robert Haase

  Source: Cropped from Ramesh et al. 2022, licensed CC-

  @haesleinhuepf

  Slide 14

  BIDS Lecture 12/14 BY 4.0 https://arxiv.org/abs/2204.06125

  June 18th 2024'
downloads/12623730_12_Vision_models_slide15.png: 'Image generation in Python: Dall-E

  No need for a GPU, but costs

  Works with

  Dall-E 2 and 3

  May soon also

  work with gpt-4o

  Robert Haase

  @haesleinhuepf

  Slide 15

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide16.png: 'Image generation in Python: Dall-E

  Is Dall-E 2 more capable of creating realistic microscopy images than Dall-E 3?

  Dall-E 3 Dall-E 2

  Robert Haase

  @haesleinhuepf

  Slide 16

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide17.png: 'Inpainting

  Replacing regions in images

  (also „Gap-filling“, „Replacing“)

  Manipulated

  Raw image Mask image

  image

  A black white

  cat fur

  Robert Haase

  @haesleinhuepf

  Slide 18

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide18.png: 'Inpainting in Python: Huggingface

  Downloads

  4.8 GB

  Needs

  Nvidia GPU

  Read more:

  Robert Haase

  @haesleinhuepf https://huggingface.co/docs/diffusers/api/

  Slide 19

  BIDS Lecture 12/14

  June 18th 2024 pipelines/stable_diffusion/inpaint'
downloads/12623730_12_Vision_models_slide19.png: 'Inpainting in Python: Huggingface

  Check out the model cards online in the Huggingface hub.

  Robert Haase https://huggingface.co/stabilityai/

  @haesleinhuepf

  Slide 20

  BIDS Lecture 12/14 stable-diffusion-2-inpainting

  June 18th 2024'
downloads/12623730_12_Vision_models_slide20.png: 'Inpainting in Python: Huggingface

  You find the downloaded models cached in your home directory

  They are big! Clean up here from time to time.

  Robert Haase

  @haesleinhuepf

  Slide 21

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide21.png: 'Inpainting in Python: Dall-E

  No need for a GPU, but costs

  2D RGB images

  only

  SSiizzee mmuusstt mmaattcchh

  Supported: 256,

  512, 1024 pixels

  Result: List of URL(s)

  Robert Haase

  @haesleinhuepf

  Slide 22

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide22.png: 'New technologies bring new risks…

  If you can generate images,

  Interesting

  you can also generate parts of images….

  challenges for our

  community ahead

  Robert Haase

  @haesleinhuepf https://github.com/haesleinhuepf/darth-

  Slide 23

  BIDS Lecture 12/14 d/blob/main/demo/demo_replacing.ipynb

  June 18th 2024'
downloads/12623730_12_Vision_models_slide23.png: 'Image manipulation detection

  The noise pattern differs between raw and processed images…

  „Untouched region“

  Original raw

  image Manipulated region

  Robert Haase

  @haesleinhuepf

  Slide 24

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide24.png: 'Image manipulation detection

  e.g. by studying noise-patterns

  Local standard

  deviation filter

  „Untouched region“

  Manipulated region

  Robert Haase

  @haesleinhuepf

  Slide 25

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide25.png: 'Image manipulation detection

  e.g. by studying noise-patterns

  Sobel filter

  „Untouched region“

  Manipulated region

  Robert Haase

  @haesleinhuepf

  Slide 26

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide26.png: 'Vision Language Models

  • Classifying images

  • Describing images

  A picture of

  a cat and a

  microscope

  Robert Haase

  @haesleinhuepf

  Slide 27

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide27.png: 'Vision Language Models (VLMs)

  Goal: Describe images

  Robert Haase Source: Gosh et al 2024, licensed CC-BY 4.0

  @haesleinhuepf

  Slide 28

  BIDS Lecture 12/14 https://arxiv.org/abs/2404.07214v1

  June 18th 2024'
downloads/12623730_12_Vision_models_slide28.png: 'Variational Auto-Encoder

  Encoder Decoder

  µ r

  e t

  t u

  u l

  p p

  p

  m t

  n σ u

  I a O

  S

  “Bottleneck”,

  “Embedding”

  Robert Haase Cat picture source: Ramesh et al. 2021, licensed

  @haesleinhuepf

  Slide 29

  BIDS Lecture 12/14CC-BY 4.0 https://arxiv.org/pdf/2102.12092.pdf

  June 18th 2024'
downloads/12623730_12_Vision_models_slide29.png: 'Image classification

  Encoder

  Large

  „Image of a dog“

  t

  u

  Language „Image of a cat“

  p

  n

  I

  Model

  “Bottleneck”,

  “Embedding”

  Robert Haase Cat picture source: Ramesh et al. 2021, licensed

  @haesleinhuepf

  Slide 30

  BIDS Lecture 12/14CC-BY 4.0 https://arxiv.org/pdf/2102.12092.pdf

  June 18th 2024'
downloads/12623730_12_Vision_models_slide30.png: 'Image classification -> image describing

  Encoder

  Large

  „Image of a dog“

  t

  u

  Language „Image of a cat“

  p

  n

  I Model „Image of a

  microscope“

  “Bottleneck”,

  “Embedding”

  Robert Haase Cat picture source: Ramesh et al. 2021, licensed

  @haesleinhuepf

  Slide 31

  BIDS Lecture 12/14CC-BY 4.0 https://arxiv.org/pdf/2102.12092.pdf

  June 18th 2024'
downloads/12623730_12_Vision_models_slide31.png: 'Contrastive Language-Image Pre-Training

  „CLIP“ Transformers

  Robert Haase Source: Radford et al 2021, License MT

  @haesleinhuepf

  https://arxiv.org/abs/2103.00020 Slide 32

  BIDS Lecture 12/14

  June 18th 2024 https://github.com/OpenAI/CLIP'
downloads/12623730_12_Vision_models_slide32.png: 'CLIP transformers in Python

  Using huggingface

  Downloads

  500 MB

  …

  Robert Haase

  @haesleinhuepf Code example adapted from:

  Slide 33

  BIDS Lecture 12/14https://huggingface.co/docs/transformers/en/model_doc/clip

  June 18th 2024'
downloads/12623730_12_Vision_models_slide33.png: 'LLAVA

  Large Language and Vision Assistant

  Robert Haase

  Source: Hui et al 2023, licensed CC-BY 4.0

  @haesleinhuepf

  Slide 37

  BIDS Lecture 12/14 https://arxiv.org/abs/2304.08485

  June 18th 2024'
downloads/12623730_12_Vision_models_slide34.png: 'LLAVA 1.5

  Combining LLAVA with CLIP

  Robert Haase

  Source: Hui et al 2024, licensed CC-BY 4.0

  @haesleinhuepf

  Slide 38

  BIDS Lecture 12/14 https://arxiv.org/abs/2310.03744

  June 18th 2024'
downloads/12623730_12_Vision_models_slide35.png: 'LLAVA 1.5 HD

  Giving the model multiple perspectives on the same scene

  Robert Haase

  Source: Hui et al 2024, licensed CC-BY 4.0

  @haesleinhuepf

  Slide 39

  BIDS Lecture 12/14 https://arxiv.org/abs/2310.03744

  June 18th 2024'
downloads/12623730_12_Vision_models_slide36.png: 'Accessing VLMs using Python

  API not standardized (yet)

  Robert Haase

  @haesleinhuepf

  Slide 41

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide37.png: 'CENTER FOR SCALABLE DATA ANALYTICS
  AND

  ARTIFICIAL INTELLIGENCE

  Funded by

  Exercises

  Robert Haase

  Robert Haase

  These slides and the related training materials can be reused

  @haesleinhuepf

  Slide 42

  under the terms of the CC-BY 4.0license.

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide38.png: 'Exercise: Image generation

  Try to identify and create realistically looking MRI images

  Robert Haase

  @haesleinhuepf

  Slide 43

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide39.png: 'Exercise: Image manipulation

  Inspect the image carefully, try to find the border of the manipulated region

  Hint:

  Robert Haase

  @haesleinhuepf

  Slide 44

  BIDS Lecture 12/14

  June 18th 2024'
downloads/12623730_12_Vision_models_slide40.png: 'Exercise: Vision

  Ask llava and gpt-4omni to describe an image and to produce

  Python code for analysing it.

  Robert Haase

  @haesleinhuepf

  Slide 45

  BIDS Lecture 12/14

  June 18th 2024'
